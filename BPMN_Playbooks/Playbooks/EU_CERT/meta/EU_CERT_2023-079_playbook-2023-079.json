{
    "extracted_playbook": [
        {
            "step_number": 1,
            "type": "ACTION",
            "title": "Identify Affected Junos OS Versions",
            "description": "Determine if the Junos OS or Junos OS Evolved system is running one of the affected versions: 20.4, 21.1, 21.2, 21.3, 21.4, 22.1, 22.2, 22.3, 22.4, 23.1, 23.2, or 23.3.",
            "commands": null,
            "next_step": 2
        },
        {
            "step_number": 2,
            "type": "CONDITION",
            "condition": "Is the system running an affected version?",
            "next_step": 3,
            "else_step": null
        },
        {
            "step_number": 3,
            "type": "CONDITION",
            "condition": "Is updating to the latest version possible?",
            "next_step": 4,
            "else_step": 5
        },
        {
            "step_number": 4,
            "type": "ACTION",
            "title": "Update to Latest Junos OS Version",
            "description": "Update the system to the latest version of Junos OS or Junos OS Evolved to mitigate the vulnerability.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 5,
            "type": "ACTION",
            "title": "Limit AS PATH Length as a Workaround",
            "description": "Apply configuration to limit the AS PATH length to mitigate CVE-2023-44186.",
            "commands": [
                "set groups BASE-POLICY policy-options policy-statement MaxAS-Limit-30 term more-than-30 from protocol bgp",
                "set groups BASE-POLICY policy-options policy-statement MaxAS-Limit-30 term more-than-30 from as-path 31as",
                "set groups BASE-POLICY policy-options policy-statement MaxAS-Limit-30 term more-than-30 then reject",
                "set groups BASE-POLICY policy-options policy-statement MaxAS-Limit-30 then accept",
                "set groups BASE-POLICY policy-options policy-statement Customer-IN term MaxAS-Limit from policy MaxAS-Limit-30",
                "set groups BASE-BGP protocols bgp group <*-CUSTOMER> import Customer-IN",
                "set groups BASE-PREFIX-LISTS policy-options as-path 31as \".{31,}\""
            ],
            "next_step": null
        }
    ],
    "start_step_number": 1,
    "cve_id": "CVE-2023-44186",
    "affected_products": [
        "Junos OS versions 20.4, 21.1, 21.2, 21.3, 21.4, 22.1, 22.2, 22.3, 22.4, 23.1, 23.2, 23.3",
        "Junos OS Evolved versions 20.4, 21.1, 21.2, 21.3, 21.4, 22.1, 22.2, 22.3, 22.4, 23.1, 23.2, 23.3"
    ]
}