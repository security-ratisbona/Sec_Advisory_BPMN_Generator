URL,Content
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-356a,"Mitigations VENDORS CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK encourage vendors to: Immediately identify, mitigate, and update affected productsthat use Log4j to the latest patched version.For environments using Java 8 or later, upgrade to Log4j version 2.17.0 (released December 17, 2021) or newer.For environments using Java 7, upgrade to Log4j version 2.12.3 (released December 21, 2021).Note:Java 7 is currently end of life and organizations should upgrade to Java 8.Inform your end users of products that contain these vulnerabilitiesand strongly urge them to prioritize software updates. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK strongly recommend vendors take steps to ensure messaging on software updates reaches the widest possible audience (for example, avoid placing relevant information behind paywalls).Note:CISA is actively maintaining aGitHub page and repositorywith patch information for products known to be affected by Log4Shell. CISA has also notified ICS vendors that may be affected and has asked them to confirm any assets affected by Log4Shell and to apply available mitigations. For environments using Java 8 or later, upgrade to Log4j version 2.17.0 (released December 17, 2021) or newer.For environments using Java 7, upgrade to Log4j version 2.12.3 (released December 21, 2021).Note:Java 7 is currently end of life and organizations should upgrade to Java 8. AFFECTED ORGANIZATIONS WITH IT AND CLOUD ASSETS CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK recommend that affected organizations take the following steps to patch these vulnerabilities in their IT and cloud assets and initiate threat hunting to detect possible compromise. Organizations with OT/ICS environments should review the Organizations with OT/ICS Assets section for additional guidance.Note:this guidance includes resources that may or may not be possible for all organizations. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK recommend that organizations apply the mitigations listed in this advisory to the extent allowed by their environments. 1. Identify vulnerable assets in your environment. Knowing where Log4j and other affected products exist in your environment is key for protecting your networks. Inventory all assets that make use of the Log4j Java library.According to public reporting, adversaries are patching and mitigating assets they compromise to retain control of assets. To avoid missing such defense evasion, organizations should carefully track assets under investigation.Assume all versions of Java and Log4j are vulnerable and include them in the inventory.Ensure the inventory includes all assets, including cloud assets, regardless of function, operating system, or make. Ensure the inventory includes the following information about each assetSoftware versionsTimestamps of when last updated and by whomUser accounts on the asset with their privilege levelLocation of asset in your enterprise topologyIdentify the inventoried assets that are likely vulnerable.Use CISA'sGitHub repositoryandCERT/CC's CVE-2021-44228_scannerto identify assets vulnerable to Log4Shell. Assume all versions of Java and Log4j are vulnerable and include them in the inventory.Ensure the inventory includes all assets, including cloud assets, regardless of function, operating system, or make. Ensure the inventory includes the following information about each assetSoftware versionsTimestamps of when last updated and by whomUser accounts on the asset with their privilege levelLocation of asset in your enterprise topology Software versionsTimestamps of when last updated and by whomUser accounts on the asset with their privilege levelLocation of asset in your enterprise topology Use CISA'sGitHub repositoryandCERT/CC's CVE-2021-44228_scannerto identify assets vulnerable to Log4Shell. Additional resources for detecting vulnerable instances of Log4j are identified below. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK will update the sources for detection rules as we obtain them.Note:due to the urgency to share this information, CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK have not yet validated this content. To identify server applications that may be affected by Log4Shell and CVE-2021-45046, see TrendMicro:Log4J Vulnerability Tester.For a list of hashes to help determine if a Java application is running a vulnerable version of Log4j, see:Rob Fuller's GitHub page:CVE-2021-44228-Log4Shell-Hashes, andThe NCC Group’s GitHub page:Cyber-Defence/Intelligence/CVE-2021-44228/.For PowerShell to detect vulnerable instances, see:Nathan Kula’s GitHub page:PowerShellSnippets/Invoke-Log4ShellScan.ps1, andWill Dormann’s GitHub page:checkjndi.ps1.For guidance on using Canary Token to test for callback, see Thinkst Canary’sTwitter thread on using Canary Tokens.For guidance on using Burpsuite Pro to scan, see:Silent Signal’s GitHub page:burp-log4shell, andPortSwigger’s GitHub page:active-scan-plus-plus.For guidance on using NetMap’s Nmap Scripting Engine (NSE), see Divertor’s GitHub page:nse-log4shell.See Florian Roth's GitHub page,Fenrir 0.9.0 - Log4Shell Release, for guidance on using Roth’s Fenrir tool to detect vulnerable instances. Rob Fuller's GitHub page:CVE-2021-44228-Log4Shell-Hashes, andThe NCC Group’s GitHub page:Cyber-Defence/Intelligence/CVE-2021-44228/. Nathan Kula’s GitHub page:PowerShellSnippets/Invoke-Log4ShellScan.ps1, andWill Dormann’s GitHub page:checkjndi.ps1. Silent Signal’s GitHub page:burp-log4shell, andPortSwigger’s GitHub page:active-scan-plus-plus. 2. Mitigate known and suspected vulnerable assets in your environment. A.Treat known and suspected vulnerable assetsas compromised. These assets should be isolated until they are mitigated and verified (step 2.D). The method of isolation that you should use depends on the criticality of the asset. Possible isolation methods include: Physically removing the asset from the network (e.g., unplug the network cable);Moving the asset to a “jail VLAN” with heightened monitoring and security;Blocking at the network layer (a switch or some other device);Implementing a firewall (including web application firewall) with strict port control and logging; orRestricting the asset’s communication, especially to the internet and the rest of the enterprise network. B.Patch Log4j and other affected products to the latest version. See theApache Log4j Security Vulnerabilities webpage(as of December 22, 2021, the latest Log4j version is 2.17.0 for Java 8 and 2.12.3 for Java 7).Note:patching or updating Java is not enough, you must upgrade the Log4j library itself.For other affected products, see CISA’sGitHub page. Note:if your organization is unable to immediately identify and patch vulnerable instances of Log4j, apply appropriate workarounds. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK recommend using vendor-provided mitigations when available. Due to the rapidly evolving situation, these workarounds should not be considered permanent fixes and organizations should apply the appropriate patch as soon as it is made available. Additional mitigations are identified below; however, organizations should use these mitigations at their own risk as they may be incomplete, temporary, or cause harmful effects, such as application instability, a DoS condition, or log evasion. Remove theJndilookup.classfrom the class path. [1]Delete or renameJndilookup.class.Note:removal of theJndiManagerwill cause theJndiContextSelectorandJMSAppenderto no longer function). [2]Apply a hot patch.NCC Group:log4j-jndi-be-gone: A simple mitigation for CVE-2021-44228Amazon AWS:GitHub page:hotpatch-for-apache-log4j2Blog:Hotpatch for Apache Log4j NCC Group:log4j-jndi-be-gone: A simple mitigation for CVE-2021-44228Amazon AWS:GitHub page:hotpatch-for-apache-log4j2Blog:Hotpatch for Apache Log4j GitHub page:hotpatch-for-apache-log4j2Blog:Hotpatch for Apache Log4j C.Keep an inventory of known and suspected vulnerable assets and what is done with them  throughout  this process.It is important to track patching because malicious cyber actors may compromise an asset and then patch it to protect their operations. Organizations should keep a meticulous record of vulnerable assets they have patched to identify whether a threat actor may have patched an asset. D.Verify the mitigation has worked,if possible. Scan the patched/mitigated asset with the tools and methods listed in step 1.B. Use more than one method to verify the mitigation was successfully applied.Monitor the asset closely.Remain alert to changes from vendors for the software on the asset. Additionally, see CISA'sGitHub pagefor known affected products and patch information. CISA will continually update the repository as vendors release patches. 3. Initiate hunt and incident response procedures.Given the widespread exploitation of this vulnerability, CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK encourage all organizations to assume their assets that use Log4j may have been compromised and initiate hunt procedures. A.Hunt for signs of exploitation and compromise. Treat assets that use Log4j as suspect and conduct vigorous forensic investigation of those assets.Inspect and monitor accounts across your enterprise that exist on or connect to assets that use Log4j.Inspect changes to configurations made since December 1, 2021, and verify they were intended, especially on assets that use Log4j.Use CISA’sGitHub pageto detect possible exploitation or compromise. Additional resources to detect possible exploitation or compromise are identified below.Note:due to the urgency to share this information, CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK have not yet validated this content. Cisco Talos blog:Threat Advisory: Critical Apache Log4j vulnerability being exploited in the wildCurated Intelligence GitHub page:Log4Shell-IOCs(Note:Curated Intelligence notes that the “IOCs shared by these feeds are low-to-medium confidence we [Curated Intelligence] strongly recommend not adding them to a blocklist.”)EmergingThreat.net: signatures to assist with detection of CVE-2021-44228 activityFlorian Roth’s GitHub pages:Log4j RCE Exploitation Detectionsignature-base/yara/expl_log4j_cve_2021_44228.yarlog4shell-detectorHuntress blog:Critical RCE Vulnerability: log4j - CVE-2021-44228Mandiant blog:Now You Serial, Now You Don’t – Systematically Hunting for Deserialization ExploitsMicrosoft Security Response Center:Microsoft’s Response to CVE-2021-44228 Apache Log4j 2NCC Group:Log4Shell: Reconnaissance and post exploitation network detectionSigma GitHub pages:sigma/rules/web/web_cve_2021_44228_log4j.ymlsigma/rules/web/web_cve_2021_44228_log4j_fields.yml Log4j RCE Exploitation Detectionsignature-base/yara/expl_log4j_cve_2021_44228.yarlog4shell-detector sigma/rules/web/web_cve_2021_44228_log4j.ymlsigma/rules/web/web_cve_2021_44228_log4j_fields.yml B.If compromise is detected, organizations should: Initiate incident response procedures. See the joint advisory from ACSC, CCCS, NZ NCSC, CERT NZ, NCSC-UK, and CISA onTechnical Approaches to Uncovering and Remediating Malicious Activityfor guidance on hunting or investigating a network, and for common mistakes in incident handling. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK encourage organizations to see CISA’sFederal Government Cybersecurity Incident and Vulnerability Response Playbooks. Although tailored to U.S. FCEB agencies, these playbooks provide operational procedures for planning and conducting cybersecurity incident and vulnerability response activities and detail each step for both incident and vulnerability response.Consider reporting compromises immediately to applicable cybersecurity authorities. Organizations are encouraged to be as thorough as possible by including information such as IP addresses/domains used to exploit your infrastructure, exploited applications/servers, administrators contact information, and the start and end dates of the attack. U.S. organizations should report compromises toCISAand theFBI.Australian organizations can visitcyber.gov.auor call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents.Canadian organizations can report incidents by emailing CCCS atcontact@cyber.gc.ca.New Zealand organizations can visitNCSC.govt.nzto report incidents.UK organizations can report a significant cyber security incident atncsc.gov.uk/report-an-incident(monitored 24 hrs) or, for urgent assistance, call 03000 200 973. 4. Evaluate and apply other mitigations. A.Remain alert to changes from vendors for the software on the asset, and immediately apply updates to assetswhen notified by a vendor that their product has a patch for this vulnerability. Additionally, see CISA'sGitHub repositoryfor known affected products and patch information. CISA will continually update the repository as vendors release patches. B.Continue to monitor Log4J assets closely.Continually use signatures and indicators of compromise that may indicate exploitation. See the exploitation and detection resources listed in step 3.A.(4).Be aware that there are many ways to obfuscate the exploit string. Do not depend on one detection method to work all the time. C.Continue to monitor theApache Log4j Security Vulnerabilitieswebpage for new updates. Note:as this is an evolving situation and new vulnerabilities in Log4J are being discovered, organizations should ensure their Apache Log4j is up to date. Identify the software your enterprise uses and stay on top of updates as these may be superseded by other updates and fixes. D.Block specific outbound Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) network traffic. Outbound LDAP:for most networks, LDAP is used internally, but it is rare for LDAP requests to be routed outside a network. Organizations should block outbound LDAP or use an allowlist for outbound LDAP to known good destinations.Note:this may be difficult to detect on certain ports without a firewall that does application layer filtering.Remote Method Invocation (RMI):for most networks, RMI is either unused or used for internal sources. Organizations should block outbound RMI or use an allowlist for outbound RMI to known good destinations.Outbound DNS:organizations using enterprise DNS resolution can block outbound DNS from sources other than identified DNS resolvers. At a minimum, blocking direct outbound DNS from web application servers configured to use enterprise DNS resolution will mitigate the risks to those systems. Note:blocking attacker internet IP addresses during this event is difficult due to the high volume of scanning from non-malicious researchers and vendors. The false positives on IP addresses are high. Organizations should focus on looking for signs of successful exploitation and not scans. Affected Organizations with OT/ICS Assets Due to the pervasiveness of the Apache Log4j software library—and the integration of the library in operational products—CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK strongly recommend that OT asset owners and operators review their operational architecture and enumerate the vulnerability status against current product alerts and advisories. If a product does not have a security advisory specifically addressing the status of the vulnerability, treat it with additional protections. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK urge patching or deployment of mitigations to reduce the risk of the threat of these vulnerabilities. Note:CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK recommend prioritizing patching IT devices, especially those with internet connectivity. Affected internet-facing devices as well as laptops, desktops, and tablets are especially susceptible to exploitation of these vulnerabilities. OT/ICS devices—if segmented appropriately from the IT environment—do not face the internet and, as such, have a smaller attack surface to this vulnerability. Exploitation of IT devices may affect OT/ICS devices if there is insufficient network segmentation that prevents lateral movement. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK recommend that OT/ICS asset owner/operators take the following guidance into consideration: Review operational architecture and enumerate the vulnerability against current product alerts and advisories.If products do not have a security advisory specifically addressing their status of the vulnerability, it is recommended to treat these devices with additional protections.Implement the steps listed in the previous section to identify and isolate vulnerable assetsin the OT/ICS environment. Understand what type of products in the OT environment would be affected. Many OT/ICS-specific products incorporate vulnerable versions of the Log4j library.Use a risk-informed decision-making process to apply the latest version of hotfixes or patchesto affected devices as soon as is operationally feasible. If patches cannot be applied, mitigations provided by the product’s manufacturer or reseller should be deployed.Note:CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK recommend, as quality assurance, that users test the update in a test development environment that reflects their production environment prior to installation.Minimize network exposure for all control system devices and/or systems, and ensure they arenot accessible from the internet.Locate control system networks and remote devices behind firewalls and isolate themfrom the business network. When remote access is required, use secure methods such as virtual private networks (VPNs), recognizing VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that a VPN is only as secure as its connected devices. CISA, the FBI, NSA, ACSC, CCCS, CERT NZ, NZ NCSC, and NCSC-UK also remind organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures. CISA also provides a section forcontrol systems security recommended practicesonthe ICS webpage on cisa.gov. Several recommended practices are available for reading and download, includingImproving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies. Additional mitigation guidance and recommended practices are publicly available on theICS webpage on cisa.govin the Technical Information Paper,ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies. Organizations observing any suspected malicious activity should follow their established internal procedures and consider reporting compromises immediately. U.S. organizations should report compromises toCISAand theFBI.Australian organizations can visitcyber.gov.auor call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents.Canadian organizations can report incidents by emailing CCCS atcontact@cyber.gc.ca.New Zealand organizations can visitNCSC.govt.nzto report incidents.UK organizations can report a significant cyber security incident atncsc.gov.uk/report-an-incident(monitored 24 hrs) or, for urgent assistance, call 03000 200 973."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-321a,"Mitigations The FBI, CISA, ACSC, and NCSC urge network defenders to apply the following mitigations to reduce the risk of compromise by this threat. PATCH AND UPDATE SYSTEMS Install updates/patch operating systems, software, and firmware as soon as updates/patches are released.Immediately patch software affected by vulnerabilities identified in this advisory: CVE-2021-34473, CVE-2018-13379, CVE-2020-12812, and CVE-2019-5591. EVALUATE AND UPDATE BLOCKLISTS AND ALLOWLISTS Regularly evaluate and update blocklists and allowlists.If FortiOS is not used by your organization, add the key artifact files used by FortiOS to your organization’s execution blocklist. Any attempts to install or run this program and its associated files should be prevented. IMPLEMENT AND ENFORCE BACKUP AND RESTORATION POLICIES AND PROCEDURES Regularly back up data, air gap, and password protect backup copies offline.Ensure copies of critical data are not accessible for modification or deletion from the system where the data resides.Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, secure location (e.g., hard drive, storage device, the cloud). IMPLEMENT NETWORK SEGMENTATION Implement network segmentation to restrict adversary’s lateral movement. SECURE USER ACCOUNTS Audit user accounts with administrative privileges and configure access controls under the principles of least privilege and separation of duties.Require administrator credentials to install software. IMPLEMENT MULTI-FACTOR AUTHENTICATION Use multifactor authentication where possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems. USE STRONG PASSWORDS Require all accounts with password logins to have strong, unique passwords. SECURE AND MONITOR RDP AND OTHER POTENTIALLY RISKY SERVICES If you use RDP, restrict it to limit access to resources over internal networks.Disable unused remote access/RDP ports.Monitor remote access/RDP logs. USE ANTIVIRUS PROGRAMS Install and regularly update antivirus and anti-malware software on all hosts. SECURE REMOTE ACCESS Only use secure networks and avoid using public Wi-Fi networks.Consider installing and using a VPN for remote access. REDUCE RISK OF PHISHING Consider adding an email banner to emails received from outside your organization.Disable hyperlinks in received emails For more information on Iranian government-sponsored malicious cyber activity, seeus-cert.cisa.gov/Iran.For information and resources on protecting against and responding to ransomware, refer toStopRansomware.gov, a centralized, whole-of-government webpage providing ransomware resources and alerts.The joint advisory from the cybersecurity authorities of Australia, Canada, New Zealand, the United Kingdom, and the United States:Technical Approaches to Uncovering and Remediating Malicious Activityprovides additional guidance when hunting or investigating a network and common mistakes to avoid in incident handling.CISA offers a range of no-costcyber hygiene servicesto help critical infrastructure organizations assess, identify, and reduce their exposure to threats, including ransomware. By requesting these services, organizations of any size could find ways to reduce their risk and mitigate attack vectors.The U.S. Department of State’s Rewards for Justice (RFJ) program offers a reward of up to $10 million for reports of foreign government malicious activity against U.S. critical infrastructure. See theRFJwebsite for more information and how to report information securely.ACSC can provide tailored cyber security advice and assistance, reporting, and incident response support atcyber.gov.auand via 1300 292 371 (1300 CYBER1)."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-291a,"Mitigations CISA, the FBI, and NSA urge network defenders, especially for critical infrastructure organizations, to apply the following mitigations to reduce the risk of compromise by BlackMatter ransomware: IMPLEMENT DETECTION SIGNATURES Implement the detection signatures identified above.These signatures will identify and block placement of the ransom note on the first share that is encrypted, subsequently blocking additional SMB traffic from the encryptor system for 24 hours. USE STRONG PASSWORDS Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts.) to havestrong, unique passwords.Passwords should not be reused across multiple accounts or stored on the system where an adversary may have access.Note:devices with local administrative accounts should implement a password policy that requires strong, unique passwords for each individual administrative account. IMPLEMENT MULTI-FACTOR AUTHENTICATION Require multi-factor authenticationfor all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems. PATCH AND UPDATE SYSTEMS Keep all operating systems and software up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. LIMIT ACCESS TO RESOURCES OVER THE NETWORK Remove unnecessary access to administrative shares, especiallyADMIN$andC$. IfADMIN$andC$are deemed operationally necessary, restrict privileges to only the necessary service or user accounts and perform continuous monitoring for anomalous activity.Use a host-based firewallto only allow connections to administrative shares via SMB from a limited set of administrator machines. IMPLEMENT NETWORK SEGMENTATION AND TRAVERSAL MONITORING Adversaries use system and network discovery techniques for network and system visibility and mapping. To limit an adversary from learning the organization’s enterprise environment, limit common system and network discovery techniques by taking the following actions. Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement.Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host. USE ADMIN DISABLING TOOLS TO SUPPORT IDENTITY AND PRIVILEGED ACCESS MANAGEMENT If BlackMatter uses compromised credentials during non-business hours, the compromise may not be detected. Given that there has been anobserved increase in ransomware attacks during non-business hours, especially holidays and weekends, CISA, the FBI, and NSA recommend organizations: Implement time-based access for accounts set at the admin-level and higher.For example, theJust-in-Time (JIT)access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the AD level when the account is not in direct need. When the account is needed, individual users submit their requests through an automated process that enables access to a system, but only for a set timeframe to support task completion.Disable command-line and scripting activities and permissions.Privilege escalation and lateral movement often depend on software utilities that run from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally. IMPLEMENT AND ENFORCE BACKUP AND RESTORATION POLICIES AND PROCEDURES Maintain offline backups of data,and regularly maintain backup and restoration. This practice will ensure the organization will not be severely interrupted, have irretrievable data, or be held up by a ransom demand.Ensure all backup data isencrypted, immutable(i.e., cannot be altered or deleted) and covers the entire organization’s data infrastructure. CISA, the FBI, and NSA urge critical infrastructure organizations to apply the following additional mitigations to reduce the risk of credential compromise. Disable the storage of clear text passwords in LSASS memory.Consider disabling or limiting New Technology Local Area Network Manager (NTLM)and WDigest Authentication.Implement Credential Guardfor Windows 10 and Server 2016 (Refer toMicrosoft: Manage Windows Defender Credential Guardfor more information). For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA).Minimize the AD attack surfaceto reduce malicious ticket-granting activity. Malicious activity such as “Kerberoasting” takes advantage of Kerberos’ Ticket Granting service and can be used to obtain hashed credentials that attackers attempt to crack.Set astrongpassword policy for service accounts.Audit Domain Controllers to log successful Kerberos Ticket-Granting Service requests and ensure the events are monitored for anomalous activity. Set astrongpassword policy for service accounts.Audit Domain Controllers to log successful Kerberos Ticket-Granting Service requests and ensure the events are monitored for anomalous activity. Refer to theCISA-Multi-State information and Sharing Center (MS-ISAC) Joint Ransomware Guidefor general mitigations to prepare for and reduce the risk of compromise by ransomware attacks. Note:critical infrastructure organizations with industrial control systems/operational technology networks should review joint CISA-FBI Cybersecurity AdvisoryAA21-131A: DarkSide Ransomware: Best Practices for Preventing Business Disruption from Ransomware Attacksfor more mitigations, including mitigations to reduce the risk of severe business or functional degradation should their entity fall victim to a ransomware attack."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-287a,"Mitigations The FBI, CISA, EPA, and NSA recommend WWS facilities—including DoD water treatment facilities in the United States and abroad—use a risk-informed analysis to determine the applicability of a range of technical and non-technical mitigations to prevent, detect, and respond to cyber threats. WWS MONITORING Personnel responsible for monitoring WWS should check for the following suspicious activities and indicators, which may be indicative of threat actor activity: Inability of WWS facility personnel to access SCADA system controls at any time, either entirely or in part;Unfamiliar data windows or system alerts appearing on SCADA system controls and facility data screens that could indicate a ransomware attack;Detection by SCADA system controls, or by water treatment personnel, of abnormal operating parameters—such as unusually high chemical addition rates—used in the safe and proper treatment of drinking water;Access of SCADA systems by unauthorized individuals or groups, e.g., former employees and current employees not authorized/assigned to operate SCADA systems and controls.Access of SCADA systems at unusual times, which may indicate that a legitimate user’s credentials have been compromisedUnexplained SCADA system restarts.Unchanging parameter values that normally fluctuate. REMOTE ACCESS MITIGATIONS Note: The increased use of remote operations due to the COVID-19 pandemic increases the necessity for asset owner-operators to assess the risk associated with enhanced remote access to ensure it falls within acceptable levels. Require multi-factor authentication for all remote access to the OT network, including from the IT network and external networks.Utilizeblocklisting and allowlistingto limit remote access to users with a verified business and/or operational need.Ensure that all remote access technologies have logging enabled and regularly audit these logs to identify instances of unauthorized access.Utilize manual start and stop features in place of always activated unattended access to reduce the time remote access services are running.Audit networks for systems using remote access services.Close unneeded network ports associated with remote access services (e.g., RDP – Transmission Control Protocol [TCP] Port 3389).When configuringaccess control for a host, utilize custom settings to limit the access a remote party can attempt to acquire. Close unneeded network ports associated with remote access services (e.g., RDP – Transmission Control Protocol [TCP] Port 3389). NETWORK MITIGATIONS Implement and ensure robust network segmentation between IT and OT networks to limit the ability of malicious cyber actors to pivot to the OT network after compromising the IT network.Implement demilitarized zones (DMZs), firewalls, jump servers, and one-way communication diodes to prevent unregulated communication between the IT and OT networks.Develop/update network maps to ensure a full accounting of all equipment that is connected to the network.Remove any equipment from networks that is not required to conduct operations to reduce the attack surface malicious actors can exploit. Implement demilitarized zones (DMZs), firewalls, jump servers, and one-way communication diodes to prevent unregulated communication between the IT and OT networks. Remove any equipment from networks that is not required to conduct operations to reduce the attack surface malicious actors can exploit. PLANNING AND OPERATIONAL MITIGATIONS Ensure the organization’s emergency response plan considers the full range of potential impacts that cyberattacks pose to operations, including loss or manipulation of view, loss or manipulation of control, and threats to safety.The plan should also consider third parties with legitimate need for OT network access, including engineers and vendors.Review, test, and update the emergency response plan on an annual basis to ensure accuracy.Exercise the ability to fail over to alternate control systems, including manual operation while assuming degraded electronic communications.Allow employees to gain decision-making experience viatabletop exercisesthat incorporate loss of visibility and control scenarios. Utilize resources such as the Environment Protection Agency’s (EPA)Cybersecurity Incident Action Checklistas well as the Ransomware Response Checklist on p. 11 of theCISA-Multi-State Information Sharing and Analysis Center (MS-ISAC) Joint Ransomware Guide. The plan should also consider third parties with legitimate need for OT network access, including engineers and vendors.Review, test, and update the emergency response plan on an annual basis to ensure accuracy. SAFETY SYSTEM MITIGATIONS Install independent cyber-physical safety systems. These are systems that physically prevent dangerous conditions from occurring if the control system is compromised by a threat actor.Examples of cyber-physical safety system controls include:Size of the chemical feed pumpGearing on valvesPressure switches, etc.These types of controls benefit WWS Sector facilities—especially smaller facilities with limited cybersecurity capability—because they enable facility staff to assess systems from a worst-case scenario and determine protective solutions. Enabling cyber-physical safety systems allows operators to take physical steps to limit the damage, for example, by preventing cyber actors, who have gained control of a sodium hydroxide pump, from raising the pH to dangerous levels. Examples of cyber-physical safety system controls include:Size of the chemical feed pumpGearing on valvesPressure switches, etc.These types of controls benefit WWS Sector facilities—especially smaller facilities with limited cybersecurity capability—because they enable facility staff to assess systems from a worst-case scenario and determine protective solutions. Enabling cyber-physical safety systems allows operators to take physical steps to limit the damage, for example, by preventing cyber actors, who have gained control of a sodium hydroxide pump, from raising the pH to dangerous levels. Size of the chemical feed pumpGearing on valvesPressure switches, etc."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-259a,"Mitigations Organizations that identify any activity related to ManageEngine ADSelfService Plus indicators of compromise within their networks should take action immediately. Zoho ManageEngine ADSelfService Plus build 6114, which Zoho released on September 6, 2021, fixes CVE-2021-40539. FBI, CISA, and CGCYBER strongly urge users and administrators to update to ADSelfService Plus build 6114. Additionally, FBI, CISA, and CGCYBER strongly urge organizations ensure ADSelfService Plus is not directly accessible from the internet. Additionally, FBI, CISA, and CGCYBER strongly recommend domain-wide password resets and double Kerberos Ticket Granting Ticket (TGT) password resets if any indication is found that theNTDS.ditfile was compromised. ACTIONS FOR AFFECTED ORGANIZATIONS Immediately report as an incident toCISAor theFBI(refer to Contact Information section below) the existence of any of the following: Identification of indicators of compromise as outlined above.Presence of webshell code on compromised ManageEngine ADSelfService Plus servers.Unauthorized access to or use of accounts.Evidence of lateral movement by malicious actors with access to compromised systems.Other indicators of unauthorized access or compromise."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-243a,"Recommended Mitigations The FBI and CISA highly recommend organizations continuously and actively monitor for ransomware threats over holidays and weekends.FBI and CISA highly recommend IT security personnel subscribe to CISA cybersecurity publications (https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?qsp=CODE_RED)—and regularly visit the FBI Internet Crime Complaint Center (https://www.ic3.gov/)—for the latest alerts.  Additionally, the FBI and CISA recommend identifying IT security employees to be available and ""on call"" during these times, in the event of a ransomware attack. The FBI and CISA also suggest applying the following network best practices to reduce the risk and impact of compromise. MAKE AN OFFLINE BACKUP OF YOUR DATA. Make and maintain offline, encrypted backups of data and regularly test your backups. Backup procedures should be conducted on a regular basis. It is important that backups be maintained offline as many ransomware variants attempt to find and delete or encrypt accessible backups.Review your organization's backup schedule to take into account the risk of a possible disruption to backup processes during weekends or holidays. DO NOT CLICK ON SUSPICIOUS LINKS. Implement a user training program and phishing exercises to raise awareness among users about the risks involved in visiting malicious websites or opening malicious attachments and to reinforce the appropriate user response to phishing and spearphishing emails. IF YOU USE RDP—OR OTHER POTENTIALLY RISKY SERVICES—SECURE AND MONITOR. Limit access to resources over internal networks, especially by restricting RDP and using virtual desktop infrastructure. After assessing risks, if RDP is deemed operationally necessary, restrict the originating sources and require MFA. If RDP must be available externally, it should be authenticated via VPN.Monitor remote access/RDP logs, enforce account lockouts after a specified number of attempts, log RDP login attempts, and disable unused remote access/RDP ports.Ensure devices are properly configured and that security features are enabled. Disable ports and protocols that are not being used for a business purpose (e.g., RDP Transmission Control Protocol Port 3389).Disable or block Server Message Block (SMB) protocol outbound and remove or disable outdated versions of SMB. Threat actors use SMB to propagate malware across organizations.Review the security posture of third-party vendors and those interconnected with your organization. Ensure all connections between third-party vendors and outside software or hardware are monitored and reviewed for suspicious activity.Implement listing policies for applications and remote access that only allow systems to execute known and permitted programs under an established security policy.Open document readers in protected viewing modes to help prevent active content from running. UPDATE YOUR OS AND SOFTWARE; SCAN FOR VULNERABILITIES. Upgrade software and operating systems that are no longer supported by vendors to currently supported versions. Regularly patch and update software to the latest available versions. Prioritize timely patching of internet-facing servers—as well as software processing internet data, such as web browsers, browser plugins, and document readers—for known vulnerabilities. Consider using a centralized patch management system; use a risk-based assessment strategy to determine which network assets and zones should participate in the patch management program.Automatically update antivirus and anti-malware solutions and conduct regular virus and malware scans.Conduct regular vulnerability scanning to identify and address vulnerabilities, especially those on internet-facing devices. (See the Cyber Hygiene Services section above for more information on CISA’s free services.) USE STRONG PASSWORDS. Ensurestrong passwordsand challenge responses. Passwords should not be reused across multiple accounts or stored on the system where an adversary may have access. USE MULTI-FACTOR AUTHENTICATION. Require multi-factor authentication (MFA) for all services to the extent possible, particularly for remote access, virtual private networks, and accounts that access critical systems. SECURE YOUR NETWORK(S): IMPLEMENT SEGMENTATION, FILTER TRAFFIC, AND SCAN PORTS. Implement network segmentation with multiple layers, with the most critical communications occurring in the most secure and reliable layer.Filter network traffic to prohibit ingress and egress communications with known malicious IP addresses. Prevent users from accessing malicious websites by implementing URL blocklists and/or allowlists.Scan network for open and listening ports and close those that are unnecessary.For companies with employees working remotely, secure home networks—including computing, entertainment, and Internet of Things devices—to prevent a cyberattack; use separate devices for separate activities; and do not exchange home and work content. SECURE YOUR USER ACCOUNTS. Regularly audit administrative user accounts and configure access controls under the principles of least privilege and separation of duties.Regularly audit logs to ensure new accounts are legitimate users. HAVE AN INCIDENT RESPONSE PLAN. Create, maintain, and exercise a basic cyber incident response plan that:Includes procedures for response and notification in a ransomware incident andPlans for the possibility of critical systems being inaccessible for a period of time. Includes procedures for response and notification in a ransomware incident andPlans for the possibility of critical systems being inaccessible for a period of time. Note:for help with developing your plan, review available incident response guidance, such as thePublic Power Cyber Incident Response Playbookand the Ransomware Response Checklist in theCISA-MS-ISAC Joint Ransomware Guide. USE THE RANSOMWARE RESPONSE CHECKLIST IN CASE OF INFECTION. If your organization is impacted by a ransomware incident, the FBI and CISA recommend the following actions. Follow the Ransomware Response Checklist on p. 11 of theCISA-MS-ISAC Joint Ransomware Guide.Scan your backups. If possible, scan your backup data with an antivirus program to check that it is free of malware."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-229a,"Mitigations CISA strongly encourages critical infrastructure organizations and other organizations developing, maintaining, supporting, or using affected QNX-based systems to patch affected products as quickly as possible. Manufacturersof products that incorporate vulnerable versions should contact BlackBerry to obtain the patch.Manufacturers of products who develop unique versions of RTOS softwareshould contact BlackBerry to obtain the patch code.Note:in some cases, manufacturers may need to develop and test their own software patches.End usersof safety-critical systems should contact the manufacturer of their product to obtain a patch. If a patch is available, users should apply the patch as soon as possible. If a patch is not available, users should apply the manufacturer's recommended mitigation measures until the patch can be applied.Note: installation of software updates for RTOS frequently may require taking the device out of service or to an off-site location for physical replacement of integrated memory. Note: installation of software updates for RTOS frequently may require taking the device out of service or to an off-site location for physical replacement of integrated memory. Critical infrastructure organizationsare encouraged to review the following guidance for additional information: U.S. Coast Guard Maritime Security Advisory:Maritime Cyber Alert 02-21U.S. Nuclear Regulatory Commission Security Advisory:Blackberry QNX VulnerabilityJoint WaterISAC:U.S. Environmental Protection Agency Advisory - BadAlloc Vulnerability Impacting BlackBerry QNX RTOS"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-209a,"Mitigations and Indicators of Compromise One of the most effective best practices to mitigate many vulnerabilities is to update software versions once patches are available and as soon as is practicable. If this is not possible, consider applying temporary workarounds or other mitigations, if provided by the vendor. If an organization is unable to update all software shortly after a patch is released, prioritize implementing patches for CVEs that are already known to be exploited or that would be accessible to the largest number of potential attackers (such as internet-facing systems). This advisory highlights vulnerabilities that should be considered as part of the prioritization process. To further assist remediation, automatic software updates should be enabled whenever possible. Focusing scarce cyber defense resources on patching those vulnerabilities that cyber actors most often use offers the potential of bolstering network security while impeding our adversaries’ operations. For example, nation-state APTs in 2020 extensively relied on a single RCE vulnerability discovered in the Atlassian Crow, a centralized identity management and application (CVE-2019-11580) in its reported operations. A concerted focus on patching this vulnerability could have a relative broad impact by forcing the actors to find alternatives, which may not have the same broad applicability to their target set. Additionally, attackers commonly exploit weak authentication processes, particularly in external-facing devices. Organizations should require multi-factor authentication to remotely access networks from external sources, especially for administrator or privileged accounts. Tables 2–14 provide more details about, and specific mitigations for, each of the top exploited CVEs in 2020. Note:The lists of associated malware corresponding to each CVE below are not meant to be exhaustive but intended to identify a malware family commonly associated with exploiting the CVE. Table 2: CVE-2019-19781 Vulnerability Details Citrix Netscaler Directory Traversal (CVE-2019-19781) Vulnerability DescriptionCitrix Netscaler Application Delivery Control (ADC) is vulnerable to RCE and full system compromise due to poor access controls, thus allowing directory traversal. CVSS 3.02 Critical Vulnerability Discussion, IOCs, and Malware Campaigns The lack of adequate access controls allows an attacker to enumerate system directories for vulnerable code (directory traversal). In this instance, Citrix ADC maintains a vulnerable Perl script (newbm.pl) that, when accessed viaHTTP POSTrequest (POST https://$TARGET/vpn/../vpn/portal/scripts/newbm.pl), allows local operating system (OS) commands to execute. Attackers can use this functionality to upload/execute command and control (C2) software (webshell or reverse-shell executable) using embedded commands (e.g.,curl,wget,Invoke-WebRequest) and gain unauthorized access to the OS. Multiple malware campaigns, including NOTROBIN, have taken advantage of this vulnerability. Fix Patch Available Recommended Mitigations Implement the appropriate refresh build according to the vulnerability details outlined by the vendor: Citrix: Mitigation Steps for CVE-2019-19781If possible, only allow the VPN to communicate with known Internet Protocol (IP) addresses (allow-list). Detection Methods CISA has developed a free detection tool for this vulnerability:cisagov/check-cve-2019-19781: Test a host for susceptibility to CVE-2019-19781.Nmap developed a script that can be used with the port scanning engine:CVE-2019-19781 - Citrix ADC Path Traversal #1893.Citrix also developed a free tool for detecting compromises of Citrix ADC Appliances related to CVE-2019-19781:Citrix / CVE-2019-19781: IOC Scanner for CVE-2019-19781.CVE-2019-19781 is commonly exploited to install web shell malware. The National Security Agency (NSA) provides guidance on detecting and preventing web shell malware athttps://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDFand signatures athttps://github.com/nsacyber/Mitigating-Web-Shells. Vulnerable Technologies and VersionsCitrix ADC and Gateway 10.5, 11.1, 12.0, 12.1, and 13.0 References and Additional Guidance Citrix Blog: Citrix releases final fixes for CVE-2019-19781National Institute for Standards and Technology (NIST) National Vulnerability Database (NVD): Vulnerability Detail CVE-2019-19781Tripwire Vulnerability and Exposure Research Team (VERT) Article: Citrix NetScaler CVE-2019-19781: What You Need to KnowNational Security Agency Cybersecurity Advisory: Critical Vulnerability In Citrix Application Delivery Controller (ADC) And Citrix GatewayCISA Alert: Detecting Citrix CVE-2019-19781NCSC Alert: Actors Exploiting Citrix Products VulnerabilityCISA-NCSC Joint Cybersecurity Advisory: COVID-19 Exploited by Malicious Cyber ActorsCISA Alert: Critical Vulnerability in Citrix Application Delivery Controller, Gateway, and SD-WAN WANOPFBI-CISA Joint Cybersecurity Advisory: Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network DefendersDoJ: Seven International Cyber Defendants, Including “Apt41” Actors, Charged in Connection with Computer Intrusion Campaigns Against More Than 100 Victims GloballyFBI News: Russian Foreign Intelligence Service Exploiting Five Publicly Known Vulnerabilities to Compromise U.S. and Allied NetworksFBI FLASH: Indictment of China-Based Cyber Actors Associated with APT 41 for Intrusion ActivitiesGitHub: nsacyber / Mitigating Web Shells  Table 3: CVE 2019-11510 Vulnerability Details Vulnerability DescriptionPulse Secure Connect is vulnerable to unauthenticated arbitrary file disclosure. An attacker can exploit this vulnerability to gain access to administrative credentials. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware CampaignsImproper access controls allow a directory traversal that an attacker can exploit to read the contents of system files. For example, the attacker could use a string such ashttps://sslvpn.insecure-org.com/dana-na/../dana/html5/acc/guacmole/../../../../../../etc/passwd?/dana/html5/guacamole/to obtain the local password file from the system. The attacker can also obtain admin session data and replay session tokens in the browser. Once compromised, an attacker can run arbitrary scripts on any host that connects to the VPN. This could lead to anyone connecting to the VPN as a potential target to compromise. Multiple malware campaigns have taken advantage of this vulnerability, most notably REvil/Sodinokibi ransomware. Fix Patch Available Upgrade to the latest Pulse Secure VPN.Stay alert to any scheduled tasks or unknown files/executables.Create detection/protection mechanisms that respond on directory traversal (/../../../) attempts to read local system files. CISA developed a tool to help determine if IOCs exist in the log files of a Pulse Secure VPN Appliance for CVE-2019-11510: cisagov/check-your-pulse.Nmap developed a script that can be used with the port scanning engine: http-vuln-cve2019-11510.nse #1708. Vulnerable Technologies and VersionsPulse Secure Pulse Connect Secure (PCS) 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4 are vulnerable. References NIST NVD Vulnerability Detail: CVE-2019-11510CISA Alert: Continued Threat Actor Exploitation Post Pulse Secure VPN PatchingPulse Security Advisory: SA44101 – 2019-04: Out-of-Cycle Advisory: Multiple vulnerabilities resolved in Pulse Connect Secure / Pulse Policy Secure 9.0RXGitHub: cisagov / Check Your PulseCISA Analysis Report: Federal Agency Compromised by Malicious Cyber ActorCISA Alert: Exploitation of Pulse Connect Secure VulnerabilitiesCISA-FBI Joint Cybersecurity Advisory: Russian State-Sponsored Advanced Persistent Threat Actor Compromises U.S. Government TargetsNCSC Alert: Vulnerabilities Exploited in VPN Products Used WorldwideDoJ Press Release: Seven International Cyber Defendants, Including “Apt41” Actors, Charged in Connection with Computer Intrusion Campaigns Against More Than 100 Victims GloballyFBI News: Russian Foreign Intelligence Service Exploiting Five Publicly Known Vulnerabilities to Compromise U.S. and Allied NetworksFBI FLASH: Indicators Associated with Netwalker RansomwareFBI FLASH: Indictment of China-Based Cyber Actors Associated with APT 41 for Intrusion Activities  Table 4: CVE 2018-13379 Vulnerability Details Vulnerability DescriptionFortinet Secure Sockets Layer (SSL) VPN is vulnerable to unauthenticated directory traversal, which allows attackers to gain access to thesslvpn_websessionfile. An attacker is then able to exact clear-text usernames and passwords. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware CampaignsWeakness in user access controls and web application directory structure allows attackers to read system files without authentication. Attackers are able to perform aHTTP GET request http://$SSLVPNTARGET?lang=/../../../..//////////dev/cmdb/sslvpn_websession. This results the server responding with unprintable/hex characters alongside cleartext credential information. Multiple malware campaigns have taken advantage of this vulnerability. The most notable being Cring ransomware (also known as Crypt3, Ghost, Phantom, and Vjszy1lo). Fix Patch Available Upgrade to the latest Fortinet SSL VPN.Monitor for alerts to any unscheduled tasks or unknown files/executables.Create detection/protection mechanisms that respond on directory traversal (/../../../) attempts to read thesslvpn_websessionsfile. Nmap developed a script that can be used with the port scanning engine: Fortinet SSL VPN CVE-2018-13379 vuln scanner #1709. Vulnerable Technologies and VersionsFortinet FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, and 5.4.6 to 5.4.12 are vulnerable. FortiOS System File Leak Through SSL VPN via Specialty Crafted HTTP Resource RequestsGithub: Fortinet Ssl Vpn Cve-2018-13379 Vuln Scanner #1709Fortinet Blog: Update Regarding CVE-2018-13379NIST NVD Vulnerability Detail: CVE-2018-13379FBI-CISA Joint Cybersecurity Advisory: Russian State-Sponsored Advanced Persistent Threat Actor Compromises U.S. Government TargetsFBI-CISA Joint Cybersecurity Advisory: APT Actors Exploit Vulnerabilities to Gain Initial Access for Future AttacksNCSC Alert: Vulnerabilities Exploited in VPN Products Used WorldwideFBI News: Russian Foreign Intelligence Service Exploiting Five Publicly Known Vulnerabilities to Compromise U.S. and Allied NetworksFBI FLASH: APT Actors Exploiting Fortinet Vulnerabilities to Gain Access for Malicious Activity  Table 5: CVE-2020-5902 Vulnerability Details Vulnerability DescriptionThe Traffic Management User Interface (TMUI), also referred to as the Configuration Utility, has an RCE vulnerability in undisclosed pages. CVSS 3.0Critical Vulnerability Discussion, IOCs, and Malware CampaignsThis vulnerability allows for unauthenticated attackers, or authenticated users, with network access to the Configuration Utility (through the BIG-IP management port and/or self IPs) to execute arbitrary system commands, create or delete files, disable services, and execute arbitrary Java code. This vulnerability may result in complete system compromise. The BIG-IP system in Appliance mode is also vulnerable. This issue is not exposed on the data plane; only the control plane is affected. Recommended MitigationsDownload and install a fixed software version of the software from a vendor approved resource. If it is not possible to update quickly, restrict access via the following actions. Address unauthenticated and authenticated attackers on self IPs by blocking all access.Address unauthenticated attackers on management interface by restricting access. F5 developed a free detection tool for this vulnerability:f5devcentral / cve-2020-5902-ioc-bigip-checker.Manually check your software version to see if it is susceptible to this vulnerability. Vulnerable Technologies and VersionsBIG-IP (LTM, AAM, Advanced WAF, AFM, Analytics, APM, ASM, DDHD, DNS, FPS, GTM, Link Controller, PEM, SSLO, CGNAT) 15.1.0, 15.0.0-15.0.1, 14.1.0-14.1.2, 13.1.0-13.1.3, 12.1.0-12.1.5, and 11.6.1-11.6.5 are vulnerable. F5 Article: TMUI RCE Vulnerability CVE-2020-5902NIST NVD Vulnerability Detail: CVE-2020-5902CISA Alert: Threat Actor Exploitation of F5 BIG-IP CVE-2020-5902MITRE CVE Record: CVE-2020-5902  Table 6: CVE-2020-15505 Vulnerability Details Vulnerability Description MobileIron Core & Connector, Sentry, and Monitoring and Reporting Database (RDB) software are vulnerable to RCE via unspecified vectors. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware Campaigns CVE-2020-15505 is an RCE vulnerability in MobileIron Core & Connector versions 10.3 and earlier. This vulnerability allows an external attacker, with no privileges, to execute code of their choice on the vulnerable system. As mobile device management (MDM) systems are critical to configuration management for external devices, they are usually highly permissioned and make a valuable target for threat actors. Multiple APTs have been observed exploiting this vulnerability to gain unauthorized access. Fix Patch Available Recommended Mitigations Download and install a fixed software version of the software from a vendor approved resource. Detection Methods None. Manually check your software version to see if it is susceptible to this vulnerability. Vulnerable Technologies and Versions MobileIron Core & Connector versions 10.3.0.3 and earlier, 10.4.0.0, 10.4.0.1, 10.4.0.2, 10.4.0.3, 10.5.1.0, 10.5.2.0, and 10.6.0.0; Sentry versions 9.7.2 and earlier and 9.8.0; and Monitor and Reporting Database (RDB) version 2.0.0.1 and earlier are vulnerable. References Ivanti Blog: MobileIron Security Updates AvailableCISA-FBI Joint Cybersecurity Advisory: APT Actors Chaining Vulnerabilities Against SLTT, Critical Infrastructure, and Elections OrganizationsNIST NVD Vulnerability Detail: CVE-2020-15505MITRE CVE Record: CVE-2020-15505NSA Cybersecurity Advisory: Chinese State-Sponsored Actors Exploit Publicly Known Vulnerabilities  Table 7: CVE-2020-0688 Vulnerability Details Vulnerability Description An RCE vulnerability exists in Microsoft Exchange software when the software fails to properly handle objects in memory. CVSS 3.0 High Vulnerability Discussion, IOCs, and Malware CampaignsCVE-2020-0688 exists in the Microsoft Exchange Server when the server fails to properly create unique keys at install time. An authenticated user with knowledge of the validation key and a mailbox may pass arbitrary objects for deserialization by the web application that runs asSYSTEM. The security update addresses the vulnerability by correcting how Microsoft Exchange creates the keys during install. A nation-stateAPT actor has been observed exploiting this vulnerability to conduct widespread, distributed, and anonymized brute force access attempts against hundreds of government and private sector targets worldwide. Fix Patch Available Recommended Mitigations Download and install a fixed software version of the software from a vendor approved resource. Detection Methods Manually check your software version to see if it is susceptible to this vulnerability.CVE-2020-0688 is commonly exploited to install web shell malware. NSA provides guidance on detecting and preventing web shell malware athttps://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDFand signatures athttps://github.com/nsacyber/Mitigating-Web-Shells. Vulnerable Technologies and Versions Microsoft Exchange Server 2019 Cumulative Update 3 and 4, 2016 Cumulative Update 14 and 15, 2013 Cumulative Update 23, and 2010 Service Pack 3 Update Rollup 30 are vulnerable. References Microsoft Security Update Guide: CVE-2020-0688NIST NVD Vulnerability Detail: CVE-2020-0688Microsoft Security Update: Description of the security update for Microsoft Exchange Server 2019 and 2016: February 11, 2020CISA-FBI Joint Cybersecurity Advisory: Russian State-Sponsored Advanced Persistent Threat Actor Compromises U.S. Government TargetsACSC Alert: Active Exploitation of Vulnerability in Microsoft Internet Information ServicesNSA-CISA-FBI-NCSC Cybersecurity Advisory: Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments  Table 8: CVE-2019-3396 Vulnerability Details Vulnerability Description Atlassian Confluence Server and Data Center Widget Connector is vulnerable to a server-side template injection attack. CVSS Critical Vulnerability Discussion, IOCs, and Malware Campaigns Confluence Server and Data Center versions released before June 18, 2018, are vulnerable to this issue. A remote attacker is able to exploit a server-side request forgery (SSRF) vulnerability in the WebDAV plugin to send arbitrary HTTP and WebDAV requests from a Confluence Server or Data Center instance. A successful attack is able to exploit this issue to achieve server-side template injection, path traversal, and RCE on vulnerable systems. Multiple malware campaigns have taken advantage of this vulnerability; the most notable being GandCrab ransomware. Fix Patch Available Recommended Mitigations Download and install a fixed software version of the software from a vendor-approved resource. Detection Methods Manually check the software version to see if it is susceptible to this vulnerability.CVE-2019-3396 is commonly exploited to install web shell malware. NSA provides guidance on detecting and preventing web shell malware athttps://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDFand signatures athttps://github.com/nsacyber/Mitigating-Web-Shells. Manually check the software version to see if it is susceptible to this vulnerability. CVE-2019-3396 is commonly exploited to install web shell malware. NSA provides guidance on detecting and preventing web shell malware athttps://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDFand signatures athttps://github.com/nsacyber/Mitigating-Web-Shells. Vulnerable Technologies and Versions All versions of Confluence Server and Confluence Data Center before version 6.6.12, from version 6.7.0 before 6.12.3 (the fixed version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for 6.13.x), and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x) are vulnerable. References NIST NVD Vulnerability Detail: CVE-2019-3396MITRE CVE Record: CVE-2019-3396Confluence Security Advisory: Confluence Data Center and Server 7.12Confluence Server and Data Center CONFSERVER-57974: Remote Code Execution via Widget Connector Macro - CVE-2019-3396TrendMicro Research Article: CVE-2019-3396: Exploiting the Confluence Vulnerability  Table 9: CVE 2017-11882 Vulnerability Details Vulnerability Description Microsoft Office is prone to a memory corruption vulnerability allowing an attacker to run arbitrary code, in the context of the current user, by failing to properly handle objects in memory. It is also known as the ""Microsoft Office Memory Corruption Vulnerability."" Cyber actors continued to exploit this four-year-old vulnerability in Microsoft Office that the U.S. Government publicly assessed last year was the most frequently targeted. Cyber actors most likely continue to exploit this vulnerability because Microsoft Office use is ubiquitous worldwide, the vulnerability is ideal for phasing campaigns, and it enables RCE on vulnerable systems. CVSS 3.0 High Vulnerability Discussion, IOCs, and Malware Campaigns Microsoft Equation Editor, a component of Microsoft Office, contains a stack buffer overflow vulnerability that enables RCE on a vulnerable system. The component was compiled on November 9, 2000. Without any further recompilation, it was used in all currently supported versions of Microsoft Office. Microsoft Equation Editor is an out-of-process COM server that is hosted byeqnedt32.exe, meaning it runs as its own process and can accept commands from other processes. Data execution prevention (DEP) and address space layout randomization (ASLR) should protect against such attacks. However, because of the manner in whicheqnedt32.exewas linked, it will not use these features, subsequently allowing code execution. Being an out-of-process COM server, protections specific to Microsoft Office such as EMET and Windows Defender Exploit Guard are not applicable toeqnedt32.exe, unless applied system-wide. This provides the attacker with an avenue to lure targets into opening specially crafted documents, resulting in the ability to execute an embedded attacker commands. Multiple cyber espionage campaigns have taken advantage of this vulnerability. CISA has noted CVE-2017-11882 being exploited todeliver LokiBot malware. Fix Patch Available Recommended Mitigations To remediate this issue, administrators should deploy Microsoft’s patch for this vulnerability:https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882.Those who cannot deploy the patch should consider disabling the Equation Editor as discussed inMicrosoft Knowledge Base Article 4055535. Detection Methods Microsoft Defender Antivirus, Windows Defender, Microsoft Security Essentials, and the Microsoft Safety Scanner will all detect and patch this vulnerability. Vulnerable Technologies and Versions Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, and Microsoft Office 2016 are vulnerable. References NIST NVD Vulnerability Detail: CVE-2017-11882CISA Malware Analysis Report: MAR-10211350-1.v2Palo Alto Networks Analysis: Analysis of CVE-2017-11882 Exploit in the WildCERT Coordination Center Vulnerability Note: Microsoft Office Equation Editor stack buffer overflow  Table 10: CVE 2019-11580 Vulnerability Details Vulnerability Description Atlassian Crowd and Crowd Data Center had thepdkinstalldevelopment plugin incorrectly enabled in release builds. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware Campaigns Attackers who can send unauthenticated or authenticated requests to a Crowd or Crowd Data Center instance can exploit this vulnerability to install arbitrary plugins, which permits RCE on systems running a vulnerable version of Crowd or Crowd Data Center. Fix Patch Available Recommended Mitigations Atlassian recommends customers running a version of Crowd below version 3.3.0 to upgrade to version 3.2.8. For customers running a version above or equal to 3.3.0, Atlassian recommends upgrading to the latest version.Released Crowd and Crowd Data Center version 3.4.4 contains a fix for this issue and is available athttps://www.atlassian.com/software/crowd/download.Released Crowd and Crowd Data Center versions 3.0.5, 3.1.6, 3.2.8, and 3.3.5 contain a fix for this issue and are available athttps://www.atlassian.com/software/crowd/download-archive. Detection Methods Manually check your software version to see if it is susceptible to this vulnerability.CVE-2019-11580 is commonly exploited to install web shell malware. NSA provides guidance on detecting and preventing web shell malware athttps://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF and signatures athttps://github.com/nsacyber/Mitigating-Web-Shells Vulnerable Technologies and Versions All versions of Crowd from version 2.1.0 before 3.0.5 (the fixed version for 3.0.x), from version 3.1.0 before 3.1.6 (the fixed version for 3.1.x), from version 3.2.0 before 3.2.8 (the fixed version for 3.2.x), from version 3.3.0 before 3.3.5 (the fixed version for 3.3.x), and from version 3.4.0 before 3.4.4 (the fixed version for 3.4.x) are affected by this vulnerability. References NIST NVD Vulnerability Detail: CVE-2019-11580Crowd CWD-5388: Crowd – pdkinstall Development Plugin Incorrectly Enabled – CVE-2019-11580Crowd Security Advisory: Crowd Data Center and Server 4.3  Table 11: CVE 2018-7600 Vulnerability Details Vulnerability Description Drupal versions before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1 allow remote attackers to execute arbitrary code because of an issue affecting multiple subsystems with default or common module configurations. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware Campaigns An RCE vulnerability exists within multiple subsystems of Drupal 7.x and 8.x. This potentially allows attackers to exploit multiple attack vectors on a Drupal site, which could result in the site being completely compromised. Failed exploit attempts may result in a denial-of-service condition. A remote user can send specially crafted data to trigger a flaw in the processing of renderable arrays in the Form Application Programming Interface, or API, and cause the target system to render the user-supplied data and execute arbitrary code on the target system. Malware campaigns include the Muhstik botnet and XMRig Monero Cryptocurrency mining. Fix Patch Available Recommended Mitigations Upgrade to the most recent version of Drupal 7 or 8 core. If running 7.x, upgrade to Drupal 7.58. If running 8.5.x, upgrade to Drupal 8.5.1. Detection Methods Dan Sharvit developed a tool to check for the CVE-2018-7600 vulnerability on several URLs:https://github.com/sl4cky/CVE-2018-7600-Masschecker/blob/master/Drupalgeddon-mass.py. Vulnerable Technologies and Versions Drupal versions before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1 are affected. References Drupal Security Advisory: Drupal Core - Highly Critical - Remote Code Execution - SA-CORE-2018-002NIST NVD Vulnerability Detail: CVE-2018-7600Drupal Groups: FAQ about SA-CORE-2018-002  Table 12: CVE 2019-18935 Vulnerability Details Vulnerability Description Telerik User Interface (UI) for ASP.NET does not properly filter serialized input for malicious content. Versions prior to R1 2020 (2020.1.114) are susceptible to  remote code execution attacks on affected web servers due to a deserialization vulnerability. CVS 3.0 Critical Vulnerability Discussion, IOCs, and Malware Campaigns The Telerik UI does not properly sanitize serialized data inputs from the user. This vulnerability leads to the application being vulnerable to RCE attacks that may lead to a full system compromise. A vulnerableHTTP POSTparameterrauPostDatamakes use of a vulnerable function/objectAsyncUploadHandler. The object/function uses theJavaScriptSerializer.Deserialize()method, which not not properly sanitize the serialized data during the deserialization process. This issue is attacked by: Determining the vulnerable function is available/registered:http://<HOST>/Telerik.Web.UI.WebResource.axd?type=rau,Determining if the version running is vulnerable by querying the UI, andCreating an object (e.g., malicious mixed-mode DLL with native OS commands or Reverse Shell) and uploading the object via rauPostData parameter along with the proper encryption key. There were two malware campaigns associated with this vulnerability: Netwalker Ransomware andBlue Mockbird Monero Cryptocurrency-mining. Fix Patch Available Recommended Mitigations Update to the most recent version of Telerik UI for ASP.NET AJAX (at least 2020.1.114 or later). Detection Methods ACSC has an example PowerShell script that can be used to identify vulnerable Telerik UI DLLs on Windows web server hosts.Vulnerable hosts should be reviewed for evidence of exploitation. Indicators of exploitation can be found in IIS HTTP request logs and within the Application Windows event log. Details of the above PowerShell script and exploitation detection recommendations are available inACSC Advisory 2020-004.Exploitation of this and previous Telerik UI vulnerabilities commonly resulted in the installation of web shell malware. NSA provides guidance ondetecting and preventing web shell malware. Vulnerable Technologies and Versions Telerik UI for ASP.NET AJAX versions prior to R1 2020 (2020.1.114) are affected. References Telerik UI for ASP.NET AJAX security advisory – Allows JavaScriptSerializer DeserializationNIST NVD Vulnerability Detail: CVE-2019-18935ACSC Advisory 2020-004: Remote Code Execution Vulnerability Being Actively Exploited in Vulnerable Versions of Telerik UI by Sophisticated ActorsBishop Fox – CVE-2019-18935: Remote Code Execution via Insecure Deserialization in Telerik UIFBI FLASH: Indicators Associated with Netwalker Ransomware  Table 13: CVE-2019-0604 Vulnerability Details Vulnerability Description A vulnerability in an XML deserialization component within Microsoft SharePoint allowed remote attackers to execute arbitrary code on vulnerable Microsoft SharePoint servers. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware Campaigns This vulnerability was typically exploited to install webshell malware to vulnerable hosts. A webshell could be placed in any location served by the associated Internet Information Services (IIS) web server and did not require authentication. These web shells would commonly be installed in the Layouts folder within the Microsoft SharePoint installation directory, for example: C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\<version_number>\Template\Layouts ThexmlSerializer.Deserialize()method does not adequately sanitize user input that is received from the PickerEnitity/ValidateEnity (picker.aspx) functions in the serialized XML payloads. Once the serialized XML payload is deserialized, the XML code is evaulated for relevant XML commands and stings. A user can attack .Net based XML parsers with XMLNS payloads using the <system:string> tag and embedding malicious operating system commands. The exploit was used in malware phishing and the WickrMe/Hello Ransomware campaigns. Fix Patch Available Recommended Mitigations Upgrade on-premise installations of Microsoft Sharepoint to the latest available version (Microsoft SharePoint 2019) and patch level.On-premise Microsoft SharePoint installations with a requirement to be accessed by internet-based remote staff should be moved behind an appropriate authentication mechanism such as a VPN, if possible. Detection Methods The patch level of on-premise Microsoft SharePoint installations should be reviewed for the presence of relevant security updates as outlined in the Microsoft SharePoint security advisory.Vulnerable SharePoint servers should be reviewed for evidence of attempted exploitation.ACSC Advisory 2019-125contains advice on reviewing IIS HTTP request logs for evidence of potential exploitation.NSA provides guidance ondetecting and preventing web shell malware. Vulnerable Technologies and Versions At the time of the vulnerability release, the following Microsoft SharePoint versions were affected: Microsoft Sharepoint 2019, Microsoft SharePoint 2016, Microsoft SharePoint 2013 SP1, and Microsoft SharePoint 2010 SP2. References Microsoft – SharePoint Remote Code Execution Vulnerability Security AdvisoryNIST NVD Vulnerability Detail: CVE-2019-0604ACSC Advisory 2019-125: Targeting of Microsoft SharePoint CVE-2019-0604NSCS Alert: Microsoft SharePoint Remote Code Vulnerability  Table 14: CVE-2020-0787 Vulnerability Details Vulnerability Description The Windows Background Intelligent Transfer Service (BITS) is vulnerable to a privilege elevation vulnerability if it improperly handles symbolic links. An actor can exploit this vulnerability to execute arbitrary code with system-level privileges. CVSS 3.0 High Vulnerability Discussion, IOCs, and Malware Campaigns To exploit this vulnerability, an actor would first need to have the ability to execute arbitrary code on a vulnerable Windows host. Actors exploiting this vulnerability commonly used the proof of concept code released by the security researcher who discovered the vulnerability. If an actor left the proof of concept exploit’s working directories unchanged, then the presence of the following folders could be used as an indicator of exploitation: C:\Users\<username>\AppData\Local\Temp\workspaceC:\Users\<username>\AppData\Local\Temp\workspace\mountpointC:\Users\<username>\AppData\Local\Temp\workspace\bait The exploit was used in Maze and Egregor ransomware campaigns. Fix Patch Available Recommended Mitigations Apply the security updates as recommended in the Microsoft Netlogon security advisory. Detection Methods The patch level of all Microsoft Windows installations should be reviewed for the presence of relevant security updates as outlined in the Microsoft BITS security advisory. Vulnerable Technologies and Versions Windows 7 for 32-bit and x64-based Systems Service Pack 1, 8.1 for 32-bit and x64-based systems, RT 8.1, 10 for 32-bit and x64-based Systems, 10 1607 for 32-bit and x64-based Systems, 10 1709 for 32-bit and x64-based and ARM64-based Systems, 10 1803 for 32-bit and ARM64-based and x64-based Systems, 10 1809 for 32-bit and ARM64-based and x64-based Systems, 10 1903 for 32-bit and ARM64-based and x64-based Systems, 10 1909 for 32-bit, and ARM64-based and x64-based Systems are vulnerable. Windows Server 2008 R2 for x64-based Systems Service Pack 1, 2008 R2 for x64-based Systems Service Pack 1 (Server Core Installation), 2008 for 32-bit Systems Service Pack 2, 2008 for 32-bit Systems Service Pack 2 (Server Core Installation), 2012, 2012 (Server Core Installation), 2012 R2, 2012 R2 (Server Core Installation), 2016, 2016 (Server Core Installation), 2019, 2019 (Server Core Installation), 1803 (Server Core Installation), 1903 (Server Core Installation), and 1909 (Server Core Installation) are also vulnerable. References Microsoft – Windows Background Intelligent Transfer Service Elevation of Privilege Security AdvisoryNIST NVD Vulnerability Detail: CVE-2020-0787Security Researcher – Proof of Concept Exploit Code  Table 15: CVE-2020-1472 Vulnerability Details Vulnerability Description The Microsoft Windows Netlogon Remote Protocol (MS-NRPC) reuses a known, static, zero-value initialization vector (VI) in AES-CFB8 mode, which could allow an unauthenticated attacker to impersonate a domain-joined computer including a domain controller, and potentially obtain domain administrator privileges. CVSS 3.0 Critical Vulnerability Discussion, IOCs, and Malware Campaigns To exploit this vulnerability, an actor would first need to have an existing presence on an internal network with network connectivity to a vulnerable Domain Controller, assuming that Domain Controllers are not exposed to the internet. The immediate effect of successful exploitation results in the ability to authentication to the vulnerable Domain Controller with Domain Administrator level credentials. In compromises exploiting this vulnerability, exploitation was typically followed immediately by dumping all hashes for Domain accounts. Threat actors were seen combining the MobileIron CVE-2020-15505 vulnerability for initial access, then using the Netlogon vulnerability to facilitate lateral movement and further compromise of target networks. A nation-state APT group has been observed exploiting this vulnerability.[18] Fix Patch Available Recommended Mitigations Apply the security updates as recommended in the Microsoft Netlogon security advisory. Detection Methods The patch level of Domain Controllers should be reviewed for the presence of relevant security updates as outlined in the Microsoft Netlogon security advisory.Reviewing and monitoring Windows Event Logs can identify potential exploitation attempts. However, further investigation would still be required to eliminate legitimate activity. Further information on these event logs is available in theACSC 2020-016 Advisory. Vulnerable Technologies and Versions At the time of the vulnerability release, the following Microsoft Windows Server versions were vulnerable: all versions of Windows Server 2019; all versions of Windows Server 2016; Windows Server 2012 R2; Windows Server 2012; Windows Server 2008 R2 SP1; and Windows Server versions 1909/1903/1809. References Microsoft – Netlogon Elevation of Privilege VulnerabilityNIST NVD Vulnerability Detail: CVE-2020-1472ACSC 2020-016 Netlogon AdvisoryCISA-FBI Joint Cybersecurity Advisory: APT Actors Chaining Vulnerabilities Against SLTT, Critical Infrastructure, and Elections OrganizationsCISA-FBI Joint Cybersecurity Advisory: Russian State-Sponsored Advanced Persistent Threat Actor Compromises U.S. Government TargetsACSC Advisory 2020-016: ""Zerologon"" – Netlogon Elevation of Privilege Vulnerability (CVE-2020-1472)NCSC Alert: UK Organisations Should Patch Netlogon Vulnerability (Zerologon)  For additional general best practices for mitigating cyber threats, see the joint advisory from Australia, Canada, New Zealand, the United Kingdom, and the United States onTechnical Approaches to Uncovering and Remediating Malicious Activityand ACSC’sEssential Eightmitigation strategies."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-201a,"Mitigations CISA and the FBI urge Energy Sector and other CI owners and operators to apply the following mitigations to implement a layered, defense-in-depth cyber posture. By implementing a layered approach, administrators will enhance the defensive cyber posture of their OT/ICS networks, reducing the risk of compromise or severe operational degradation if their system is compromised by malicious cyber actors. Harden the IT/corporate networkto reduce the risk of initial compromise.Update all software, including operating systems, applications, and firmware, in a timely manner. Consider using a centralized patch management system.Replace all end-of-life software and hardwaredevices.Restrict and manage remote access software. Remote access tools are a common method for threat actors to gain initial access and persistence on target networks.Manage and restrict users and groups who are permitted to access remote capabilities. Permissions should be limited to users that require the capability to complete their duties.Require multi-factor authentication (MFA) for remote access.Limit access to resources over networks, especially by restricting Remote Desktop Protocol (RDP). If RDP is operationally necessary, restrict the originating sources and require MFA.Enable strong spam filters to prevent phishing emailsfrom reaching end users.Implement unauthorized execution prevention by:Disabling macro scrips from Microsoft Office files transmitted via email.Implementing application allowlisting, which only allows systems to execute programs known and permitted by security policy. Implement software restriction policies (SRPs) or other controls to prevent programs from executing from common malware locations, such as temporary folders supporting popular internet browsers.Filter network trafficto prohibit ingress and egress communications with known malicious IP addresses. Prevent users from accessing malicious websites by implementing URL blocklists and/or allow lists.Set antivirus/antimalware programsto regularly scan IT network assets using up-to-date signatures. Update all software, including operating systems, applications, and firmware, in a timely manner. Consider using a centralized patch management system.Replace all end-of-life software and hardwaredevices.Restrict and manage remote access software. Remote access tools are a common method for threat actors to gain initial access and persistence on target networks.Manage and restrict users and groups who are permitted to access remote capabilities. Permissions should be limited to users that require the capability to complete their duties.Require multi-factor authentication (MFA) for remote access.Limit access to resources over networks, especially by restricting Remote Desktop Protocol (RDP). If RDP is operationally necessary, restrict the originating sources and require MFA.Enable strong spam filters to prevent phishing emailsfrom reaching end users.Implement unauthorized execution prevention by:Disabling macro scrips from Microsoft Office files transmitted via email.Implementing application allowlisting, which only allows systems to execute programs known and permitted by security policy. Implement software restriction policies (SRPs) or other controls to prevent programs from executing from common malware locations, such as temporary folders supporting popular internet browsers.Filter network trafficto prohibit ingress and egress communications with known malicious IP addresses. Prevent users from accessing malicious websites by implementing URL blocklists and/or allow lists.Set antivirus/antimalware programsto regularly scan IT network assets using up-to-date signatures. Manage and restrict users and groups who are permitted to access remote capabilities. Permissions should be limited to users that require the capability to complete their duties.Require multi-factor authentication (MFA) for remote access.Limit access to resources over networks, especially by restricting Remote Desktop Protocol (RDP). If RDP is operationally necessary, restrict the originating sources and require MFA. Disabling macro scrips from Microsoft Office files transmitted via email.Implementing application allowlisting, which only allows systems to execute programs known and permitted by security policy. Implement software restriction policies (SRPs) or other controls to prevent programs from executing from common malware locations, such as temporary folders supporting popular internet browsers. Implement and ensure robust network segmentation between IT and ICS networksto limit the ability of cyber threat actors to move laterally to ICS networks if the IT network is compromised.Implement a network topology for ICS that has multiple layers, with the most critical communications occurring in the most secure and reliable layer. For more information refer to National Institute of Standard and Technology (NIST)Special Publication 800-82: Guide to ICS Security.Use one-way communication diodes to prevent external access, whenever possible.Set up demilitarized zones (DMZs)to create a physical and logical subnetwork that acts as an intermediary for connected security devices to avoid exposure.Employ reliable network security protocols and serviceswhere feasible.Consider using virtual local area networks (VLANs)for additional network segmentation, for example, by placing all printers in separate, dedicated VLANs and restricting users’ direct printer access. Implement a network topology for ICS that has multiple layers, with the most critical communications occurring in the most secure and reliable layer. For more information refer to National Institute of Standard and Technology (NIST)Special Publication 800-82: Guide to ICS Security.Use one-way communication diodes to prevent external access, whenever possible.Set up demilitarized zones (DMZs)to create a physical and logical subnetwork that acts as an intermediary for connected security devices to avoid exposure.Employ reliable network security protocols and serviceswhere feasible.Consider using virtual local area networks (VLANs)for additional network segmentation, for example, by placing all printers in separate, dedicated VLANs and restricting users’ direct printer access. Implement perimeter security between network segmentsto limit the ability of cyber threat actors to move laterally.Control traffic between network segmentsby using firewalls, intrusion detection systems (IDSs), and filter routers and switches.Implement network monitoringat key chokepoints—including egress points to the internet, between network segments, core switch locations—and at key assets or services (e.g., remote access services).Configure an IDSto create alarms for any ICS traffic outside normal operations (after establishing a baseline of normal operations and network traffic).Configure security incident and event monitoring (SIEM)to monitor, analyze, and correlate event logs from across the ICS network to identify intrusion attempts. Control traffic between network segmentsby using firewalls, intrusion detection systems (IDSs), and filter routers and switches.Implement network monitoringat key chokepoints—including egress points to the internet, between network segments, core switch locations—and at key assets or services (e.g., remote access services).Configure an IDSto create alarms for any ICS traffic outside normal operations (after establishing a baseline of normal operations and network traffic).Configure security incident and event monitoring (SIEM)to monitor, analyze, and correlate event logs from across the ICS network to identify intrusion attempts. Implement the following additional ICS environment best practices:Update all software. Use a risk-based assessment strategy to determine which ICS network and assets and zones should participate in the patch management program.Test all patches in off-line text environments before implementation.Implement application allowlisting on human machine interfaces.Harden field devices, including tablets and smartphones.Replace all end-of-life software and hardware devices.Disable unused ports and services on ICS devices(after testing to ensure this will not affect ICS operation).Restrict and manage remote access software. Require MFA for remote access to ICS networks.Configure encryption and security for ICS protocols.Use a risk-based asset inventory strategy to determine how OT network assets are identified and evaluated for the presence of malware.Do not allow vendors to connect their devices to the ICS network. Use of a compromised device could introduce malware.Maintain an ICS asset inventoryof all hardware, software, and supporting infrastructure technologies.Ensure robust physical security is in placeto prevent unauthorized personal from accessing controlled spaces that house ICS equipment.Regularly test manual controlsso that critical functions can be kept running if ICS/OT networks need to be taken offline.Manage the supply chainby adjusting the ICS procurement process to weigh cybersecurity heavily as part of the scoring and evaluation methodology. Additionally, establish contractual agreements for all outsourced services that ensure proper incident handling and reporting, security of interconnections, and remote access specifications and processes. Update all software. Use a risk-based assessment strategy to determine which ICS network and assets and zones should participate in the patch management program.Test all patches in off-line text environments before implementation.Implement application allowlisting on human machine interfaces.Harden field devices, including tablets and smartphones.Replace all end-of-life software and hardware devices.Disable unused ports and services on ICS devices(after testing to ensure this will not affect ICS operation).Restrict and manage remote access software. Require MFA for remote access to ICS networks.Configure encryption and security for ICS protocols.Use a risk-based asset inventory strategy to determine how OT network assets are identified and evaluated for the presence of malware.Do not allow vendors to connect their devices to the ICS network. Use of a compromised device could introduce malware.Maintain an ICS asset inventoryof all hardware, software, and supporting infrastructure technologies.Ensure robust physical security is in placeto prevent unauthorized personal from accessing controlled spaces that house ICS equipment.Regularly test manual controlsso that critical functions can be kept running if ICS/OT networks need to be taken offline.Manage the supply chainby adjusting the ICS procurement process to weigh cybersecurity heavily as part of the scoring and evaluation methodology. Additionally, establish contractual agreements for all outsourced services that ensure proper incident handling and reporting, security of interconnections, and remote access specifications and processes. Test all patches in off-line text environments before implementation. Implement the following additional best practices:Implement IP geo-blocking, as appropriate.Implement regular, frequent data backup procedureson both the IT and ICS networks. Data backup procedures should address the following best practices:Ensure backups are regularly tested.Store backups separately, i.e., backups should be isolated from network connections that could enable spread of malware or lateral movement.Maintain regularly updated “gold images” of critical systems in the event they need to be rebuilt.Retain backup hardware to rebuild systems in the even rebuilding the primary system is not preferred.Implement a user training programto train employees to recognize spearphishing attempts, discourage users from visiting malicious websites or opening malicious attachments, and re-enforce appropriate user response to spearphishing emails. Implement IP geo-blocking, as appropriate.Implement regular, frequent data backup procedureson both the IT and ICS networks. Data backup procedures should address the following best practices:Ensure backups are regularly tested.Store backups separately, i.e., backups should be isolated from network connections that could enable spread of malware or lateral movement.Maintain regularly updated “gold images” of critical systems in the event they need to be rebuilt.Retain backup hardware to rebuild systems in the even rebuilding the primary system is not preferred.Implement a user training programto train employees to recognize spearphishing attempts, discourage users from visiting malicious websites or opening malicious attachments, and re-enforce appropriate user response to spearphishing emails. Ensure backups are regularly tested.Store backups separately, i.e., backups should be isolated from network connections that could enable spread of malware or lateral movement.Maintain regularly updated “gold images” of critical systems in the event they need to be rebuilt.Retain backup hardware to rebuild systems in the even rebuilding the primary system is not preferred."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-200b,"Mitigations NSA, CISA, and FBI urge federal and SLTT government, CI, DIB, and private industry organizations to apply the following recommendations as well as the detection and mitigation recommendations in Appendix A, which are tailored to observed tactics and techniques: Patch systems and equipment promptly and diligently.Focus on patching critical and high vulnerabilities that allow for remote code execution or denial-of-service on externally facing equipment and CVEs known to be exploited by Chinese state-sponsored cyber actors. Consider implementing a patch management program that enables a timely and thorough patching cycle.Note:for more information on CVEs routinely exploited by Chinese state-sponsored cyber actors refer to the resources listed in the Trends in Chinese State-Sponsored Cyber Operations section.Enhance monitoring of network traffic, email, and endpoint systems.Review network signatures and indicators for focused activities, monitor for new phishing themes, and adjust email rules accordingly. Follow the best practices of restricting attachments via email and blocking URLs and domains based upon reputation. Ensure that log information is aggregated and correlated to enable maximum detection capabilities, with a focus on monitoring for account misuse. Monitor common ports and protocols for command and control (C2) activity. SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols. Implement and enhance network and endpoint event analysis and detection capabilities to identify initial infections, compromised credentials, and the manipulation of endpoint processes and files.Use protection capabilities to stop malicious activity.Implement anti-virus software and other endpoint protection capabilities to automatically detect and prevent malicious files from executing. Use a network intrusion detection and prevention system to identify and prevent commonly employed adversarial malware and limit nefarious data transfers. Use a domain reputation service to detect suspicious or malicious domains. Use strong credentials for service accounts and multi-factor authentication (MFA) for remote access to mitigate an adversary's ability to leverage stolen credentials, but be aware of MFA interception techniques for some MFA implementations.▪ Patch systems and equipment promptly and diligently.Focus on patching critical and high vulnerabilities that allow for remote code execution or denial-of-service on externally facing equipment and CVEs known to be exploited by Chinese state-sponsored cyber actors. Consider implementing a patch management program that enables a timely and thorough patching cycle.Note:for more information on CVEs routinely exploited by Chinese state-sponsored cyber actors refer to the resources listed in the Trends in Chinese State-Sponsored Cyber Operations section."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-148a,"Mitigations CISA and FBI urge CI owners and operators to apply the following mitigations. Implement multi-factor authentication (MFA) for every account. While privileged accounts and remote access systems are critical, it is also important to ensure full coverage across SaaS solutions. Enabling MFA for corporate communications platforms (as with all other accounts) provides vital defense against these types of attacks and, in many cases, can prevent them.Keep all software up to date. The most effective cybersecurity programs quickly update all of their software as soon as patches are available. If your organization is unable to update all software shortly after a patch is released, prioritize implementing patches for CVEs that are already known to be exploited.Implement endpoint and detection response (EDR) tools. EDR allows a high degree of visibility into the security status of endpoints and is can be an effective tool against threat actors.Note:Organizations using Microsoft Defender for Endpoint or Microsoft 365 Defense should refer to Microsoft: Use attack surface reduction rules to prevent malware infection for more information on hardening the enterprise attack surface.Implement centralized log management for host monitoring. A centralized logging application allows technicians to look out for anomalous activity in the network environment, such as new applications running on hosts, out-of-place communication between devices, or unaccountable login failures on machines. It also aids in troubleshooting applications or equipment in the event of a fault. CISA and the FBI recommend that organizations:Forward logs from local hosts to a centralized log management server—often referred to as a security information and event management (SIEM) tool.Ensure logs are searchable. The ability to search, analyze, and visualize communications will help analysts diagnose issues and may lead to detection of anomalous activity.Correlate logs from both network and host security devices. By reviewing logs from multiple sources, an organization can better triage an individual event and determine its impact to the organization as a whole.Review both centralized and local log management policies to maximize efficiency and retain historical data. Organizations should retain critical logs for a minimum of 30 days.Deploy signatures to detect and/or block inbound connection from Cobalt Strike servers and other post-exploitation tools.Implement unauthorized execution prevention by disabling macro scripts from Microsoft Office files transmitted via email. Consider using Office Viewer software to open Microsoft Office files transmitted via email instead of full Microsoft Office suite applications.Configure and maintain user and administrative accounts using a strong account management policy.Use administrative accounts on dedicated administration workstations.Limit access to and use of administrative accounts.Use strong passwords. For more information on strong passwords, refer to CISA Tip: Choosing and Protecting Passwords and National Institute of Standards (NIST) SP 800-63: Digital Identity Guidelines: Authentication and Lifecycle Management.Remove default accounts if unneeded. Change the password of default accounts that are needed.Disable all unused accounts.Implement a user training program and simulated attacks for spearphishing to discourage users from visiting malicious websites or opening malicious attachments and re-enforce the appropriate user responses to spearphishing emails. Forward logs from local hosts to a centralized log management server—often referred to as a security information and event management (SIEM) tool.Ensure logs are searchable. The ability to search, analyze, and visualize communications will help analysts diagnose issues and may lead to detection of anomalous activity.Correlate logs from both network and host security devices. By reviewing logs from multiple sources, an organization can better triage an individual event and determine its impact to the organization as a whole.Review both centralized and local log management policies to maximize efficiency and retain historical data. Organizations should retain critical logs for a minimum of 30 days. Use administrative accounts on dedicated administration workstations.Limit access to and use of administrative accounts.Use strong passwords. For more information on strong passwords, refer to CISA Tip: Choosing and Protecting Passwords and National Institute of Standards (NIST) SP 800-63: Digital Identity Guidelines: Authentication and Lifecycle Management.Remove default accounts if unneeded. Change the password of default accounts that are needed.Disable all unused accounts. Volexity Blog:Suspected APT29 Operation Launches Election Fraud Themed Phishing Campaigns | VolexityMicrosoft Blog:New sophisticated email-based attack from NOBELIUM - Microsoft SecurityMicrosoft Blog:Another Nobelium Cyberattack"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-131a,"Mitigations CISA and FBI urge CI owners and operators to apply the following mitigations to reduce the risk of compromise by ransomware attacks. Require multi-factor authenticationfor remote access to OT and IT networks.Enable strong spam filters to prevent phishing emails from reaching end users. Filter emails containing executable files from reaching end users.Implement a user training program and simulated attacks for spearphishingto discourage users from visiting malicious websites or opening malicious attachments and re-enforce the appropriate user responses to spearphishing emails.Filter network trafficto prohibit ingress and egress communications with known malicious IP addresses. Prevent users from accessing malicious websites by implementing URL blocklists and/or allowlists.Update software, including operating systems, applications, and firmware on IT network assets, in a timely manner. Consider using a centralized patch management system; use a risk-based assessment strategy to determine which OT network assets and zones should participate in the patch management program.Limit access to resources over networks, especially by restricting RDP. After assessing risks, if RDP is deemed operationally necessary, restrict the originating sources and require multi-factor authentication.Set antivirus/antimalware programs to conduct regular scansof IT network assets using up-to-date signatures. Use a risk-based asset inventory strategy to determine how OT network assets are identified and evaluated for the presence of malware.Implement unauthorized execution prevention by:Disabling macro scripts from Microsoft Office filestransmitted via email. Consider using Office Viewer software to open Microsoft Office files transmitted via email instead of full Microsoft Office suite applications.Implementing application allowlisting, which only allows systems to execute programs known and permitted by security policy. Implement software restriction policies (SRPs) or other controls to prevent programs from executing from common ransomware locations, such as temporary folders supporting popular internet browsers or compression/decompression programs, including theAppData/LocalAppDatafolder.Monitor and/or block inbound connections from Tor exit nodes and other anonymization servicesto IP addresses and ports for which external connections are not expected (i.e., other than VPN gateways, mail ports, web ports). For more guidance, refer to Joint Cybersecurity AdvisoryAA20-183A: Defending Against Malicious Cyber Activity Originating from Tor.Deploy signatures to detect and/or block inbound connection from Cobalt Strike serversand other post exploitation tools. Disabling macro scripts from Microsoft Office filestransmitted via email. Consider using Office Viewer software to open Microsoft Office files transmitted via email instead of full Microsoft Office suite applications.Implementing application allowlisting, which only allows systems to execute programs known and permitted by security policy. Implement software restriction policies (SRPs) or other controls to prevent programs from executing from common ransomware locations, such as temporary folders supporting popular internet browsers or compression/decompression programs, including theAppData/LocalAppDatafolder.Monitor and/or block inbound connections from Tor exit nodes and other anonymization servicesto IP addresses and ports for which external connections are not expected (i.e., other than VPN gateways, mail ports, web ports). For more guidance, refer to Joint Cybersecurity AdvisoryAA20-183A: Defending Against Malicious Cyber Activity Originating from Tor.Deploy signatures to detect and/or block inbound connection from Cobalt Strike serversand other post exploitation tools. CISA and FBI urge CI owners and operators to apply the following mitigations now to reduce the risk of severe business or functional degradation should their CI entity fall victim to a ransomware attack in the future. Implement and ensure robust network segmentation between IT and OT networksto limit the ability of adversaries to pivot to the OT network even if the IT network is compromised. Define a demilitarized zone that eliminates unregulated communication between the IT and OT networks.Organize OT assets into logical zonesby taking into account criticality, consequence, and operational necessity. Define acceptable communication conduits between the zones and deploy security controls to filter network traffic and monitor communications between zones. Prohibit industrial control system (ICS) protocols from traversing the IT network.Identify OT and IT network inter-dependencies and develop workarounds or manual controlsto ensure ICS networks can be isolated if the connections create risk to the safe and reliable operation of OT processes. Regularly test contingency plans such as manual controls so that safety critical functions can be maintained during a cyber incident. Ensure that the OT network can operate at necessary capacity even if the IT network is compromised.Regularly test manual controlsso that critical functions can be kept running if ICS or OT networks need to be taken offline.Implement regular data backup procedureson both the IT and OT networks. Backup procedures should be conducted on a frequent, regular basis. The data backup procedures should also address the following best practices:Ensure that backups are regularly tested.Store your backups separately. Backups should be isolated from network connections that could enable the spread of ransomware. It is important that backups be maintained offline as many ransomware variants attempt to find and encrypt or delete accessible backups. Maintaining current backups offline is critical because if your network data is encrypted with ransomware, your organization can restore systems to its previous state. Best practice is to store your backups on a separate device that cannot be accessed from a network, such as on an external hard drive. (See the Software Engineering Institute’s page onransomware).Maintain regularly updated “gold images” of critical systems in the event they need to be rebuilt. This entails maintaining image “templates” that include a preconfigured operating system (OS) and associated software applications that can be quickly deployed to rebuild a system, such as a virtual machine or server.Retain backup hardwareto rebuild systems in the event rebuilding the primary system is not preferred. Hardware that is newer or older than the primary system can present installation or compatibility hurdles when rebuilding from images.Store source code or executables. It is more efficient to rebuild from system images, but some images will not install on different hardware or platforms correctly; having separate access to needed software will help in these cases.Ensure user and process accounts are limited through account use policies, user account control, and privileged account management. Organize access rights based on the principles of least privilege and separation of duties. Ensure that backups are regularly tested.Store your backups separately. Backups should be isolated from network connections that could enable the spread of ransomware. It is important that backups be maintained offline as many ransomware variants attempt to find and encrypt or delete accessible backups. Maintaining current backups offline is critical because if your network data is encrypted with ransomware, your organization can restore systems to its previous state. Best practice is to store your backups on a separate device that cannot be accessed from a network, such as on an external hard drive. (See the Software Engineering Institute’s page onransomware).Maintain regularly updated “gold images” of critical systems in the event they need to be rebuilt. This entails maintaining image “templates” that include a preconfigured operating system (OS) and associated software applications that can be quickly deployed to rebuild a system, such as a virtual machine or server.Retain backup hardwareto rebuild systems in the event rebuilding the primary system is not preferred. Hardware that is newer or older than the primary system can present installation or compatibility hurdles when rebuilding from images.Store source code or executables. It is more efficient to rebuild from system images, but some images will not install on different hardware or platforms correctly; having separate access to needed software will help in these cases. If your organization is impacted by a ransomware incident, CISA and FBI recommend the following actions: Isolate the infected system. Remove the infected system from all networks, and disable the computer’s wireless, Bluetooth, and any other potential networking capabilities. Ensure all shared and networked drives are disconnected, whether wired or wireless.Turn off other computers and devices. Power-off and segregate (i.e., remove from the network) the infected computer(s). Power-off and segregate any other computers or devices that shared a network with the infected computer(s) that have not been fully encrypted by ransomware. If possible, collect and secure all infected and potentially infected computers and devices in a central location, making sure to clearly label any computers that have been encrypted. Powering-off and segregating infected computers and computers that have not been fully encrypted may allow for the recovery of partially encrypted files by specialists. (SeeBefore You Connect a New Computer to the Internetfor tips on how to make a computer more secure before you reconnect it to a network.)Secure your backups. Ensure that your backup data is offline and secure. If possible, scan your backup data with an antivirus program to check that it is free of malware.Refer to Joint Cybersecurity Advisory:AA20-245A: Technical Approaches to Uncovering and Remediating Malicious Activityfor more best practices on incident response. Note:CISA and the FBI do not encourage paying a ransom to criminal actors. Paying a ransom may embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or may fund illicit activities. Paying the ransom also does not guarantee that a victim’s files will be recovered. CISA and FBI urge you to report ransomware incidents to yourlocal FBI field office. CISA offers a range of no-costcyber hygiene servicesto help CI organizations assess, identify and reduce their exposure to threats, including ransomware. By requesting these services, organizations of any size could find ways to reduce their risk and mitigate attack vectors."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-116a,Mitigations The FBI and DHS recommend service providers strengthen their user validation and verification systems to prohibit misuse of their services.
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-110a,"Mitigations (Updated May 3, 2021)CISA strongly urges organizations using Pulse Secure devices to immediately: Review thePulse Secure Connect Integrity Tool Quick Start GuideandCustomer FAQsRun thePulse Secure Connect Integrity Tool.The tool requires a reboot.If virtualized, take a snapshot before running.If the appliance is physical, consider the consequences of rebooting and running the tool and contact Ivanti for assistance or questions.(Updated May 3, 2021)Continue to run the tool daily until the XML mitigations have been implemented or the patch has been deployed.Note:the Pulse Secure team releasedSecurity Advisory SA44784that addressesCVE-2021-22893, CVE-2021-22984, CVE-2021-22899, and CVE-2021-22900 with patches.Implement the mitigations released by the vendor. According Ivanti Pulse Secure, the interim XML configurations listed in the ""Workaround"" section ofSA44784 - 2021-04: Out-of-Cycle Advisory: Pulse Connect Secure RCE Vulnerability (CVE-2021-22893)provide significant protection against threat actor activity.(Updated May 3, 2021)Update to the latest software version., per the process outlined on Ivanti Pulse Secure’s website which contains security enhancements.(Updated May 27, 2021)Using the Pulse Secure Integrity Checker. The Integrity Checker Tool (ICT) helps system owners understand if their Pulse Secure Connect device has been compromised. While the tool is accurate, there are several nuances to its effective use.The ICT detects evidence of adversary cleanup only on the current, running version of PCS.It may be necessary to roll back the current PCS version to have a valid run of the ICT.During the upgrade process, the active version becomes a rollback partition.Only one rollback partition exists on a device, as the rollback partition is replaced on each update.Therefore, if an entity has updated their PCS device without running the correct version of the ICT (as outlined in Appendix B), anomalous activity will not be detected. The tool requires a reboot.If virtualized, take a snapshot before running.If the appliance is physical, consider the consequences of rebooting and running the tool and contact Ivanti for assistance or questions.(Updated May 3, 2021)Continue to run the tool daily until the XML mitigations have been implemented or the patch has been deployed.Note:the Pulse Secure team releasedSecurity Advisory SA44784that addressesCVE-2021-22893, CVE-2021-22984, CVE-2021-22899, and CVE-2021-22900 with patches. The ICT detects evidence of adversary cleanup only on the current, running version of PCS.It may be necessary to roll back the current PCS version to have a valid run of the ICT.During the upgrade process, the active version becomes a rollback partition.Only one rollback partition exists on a device, as the rollback partition is replaced on each update.Therefore, if an entity has updated their PCS device without running the correct version of the ICT (as outlined in Appendix B), anomalous activity will not be detected. If the Integrity Checker Tools finds mismatched or unauthorized files, CISA urges organizations to: Contact CISA to report your findings (see Contact Information section below).ContactIvanti Pulse Securefor assistance in capturing forensic information.Review “Unauthenticated Web Requests” log for evidence of exploitation, if enabled.Change all passwords associated with accounts passing through the Pulse Secure environment (including user accounts, service accounts, administrative accounts and any accounts that could be modified by any account described above, all of these accounts should be assumed to be compromised).Note:Unless an exhaustive password reset occurs, factory resetting a Pulse Connect Secure appliance (see Step 3 below) will only remove malicious code from the device, and may not remove the threat actor from the environment. The threat actor may use the credentials harvested to regain access even after the appliance is fully patched.Review logs for any unauthorized authentications originating from the Pulse Connect Secure appliance IP address or the DHCP lease range of the Pulse Connect Secure appliance's VPN lease pool.(Updated May 27, 2021)Note:adversary activity may not be easily identifiable on your network as it may appear as a normal user traffic. If a device has been compromised, entities should take all precautions as if the adversary has intruded past the device into your network and take steps to ensure there are no further signs of an intrusion into networks that include:Look for unauthorized applications and scheduled tasks in environments.Ensure no new administrators were created.Ensure non-privileged users were not added to privileged groups.Scrutinize and monitor all accounts with domain administrator privileges.Monitor domain administrator accounts to ensure they are only accessing the part of the network they are authorized to access.Check all accounts should be checked to ensure they have the proper level of privileges and have not been altered such as increased privileges.Remove any remote access programs not approved by the organization.Carefully inspect scheduled tasks for scripts or executables that may allow a threat actor to connect to an environment. Look for unauthorized applications and scheduled tasks in environments.Ensure no new administrators were created.Ensure non-privileged users were not added to privileged groups.Scrutinize and monitor all accounts with domain administrator privileges.Monitor domain administrator accounts to ensure they are only accessing the part of the network they are authorized to access.Check all accounts should be checked to ensure they have the proper level of privileges and have not been altered such as increased privileges.Remove any remote access programs not approved by the organization.Carefully inspect scheduled tasks for scripts or executables that may allow a threat actor to connect to an environment. In addition to the recommendations above, organizations that find evidence of malicious, suspicious, or anomalous activity or files, should consider the guidance inKB44764 - Customer FAQ: PCS Security Integrity Tool Enhancements, which includes: After preservation, you can remediate your Pulse Connect Secure appliance by: Disabling the external-facing interface.Saving the system and user config.Performing a factory reset via the Serial Console.Note:For more information refer toKB22964(How to reset a PCS device to the factory default setting via the serial console)Updating the appliance to the newest version.Re-importing the saved config.Re-enabling the external interface. CISA recommends performing checks to ensure any infection is remediated, even if the workstation or host has been reimaged. These checks should include running thePulse Secure Connect Integrity Toolagain after remediation has been taken place. CISA would like to thank Ivanti for their contributions to this Alert."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-077a,"Mitigations INTERPRETING THE RESULTS CHIRP provides results of its scan in JSON format. CISA encourages uploading the results into a security information and event management (SIEM) system, if available. If no SIEM system is available, results can be viewed in a compatible web browser or text editor. If CHIRP detects any post-compromise threat activity, those detections should be reviewed and confirmed. CISA has provided confidence scores for each IOC and YARA rule included with CHIRP’s release. For confirmed positive hits, CISA recommends collecting a forensic image of the relevant system(s) and conducting a forensic analysis on the system(s). If you do not have the capability to follow the guidance in this Alert, consider soliciting third-party IT security support.Note:Responding to confirmed positive hits is essential to evict an adversary from a compromised network. FREQUENTLY ASKED QUESTIONS What systems should CHIRP run on?Systems running SolarWinds Orion or believed to be involved in any resulting lateral movement.What should I do with results?Ingest the JSON results into a SIEM system, web browser, or text editor.Are there existing tools that CHIRP complements and/or provide the same benefit as CHIRP?Antivirus software developers may have begun to roll out detections for the SolarWinds post-compromise activity. However, those products can miss historical signs of compromise. CHIRP can provide a complementary benefit to antivirus when run.CISA previously released the Sparrow tool that scans for APT activity within M365 and Azure environments related to activity detailed in CISA Alerts AA20-352A and AA21-008A. CHIRP provides a complementary capability to Sparrow by scanning for on-premises systems for similar activity.How often should I run CHIRP?CHIRP can be run once or routinely. Currently, CHIRP does not provide a mechanism to run repeatedly in its native format.Do I need to configure the tool before I run it?No.Will CHIRP change or affect anything on the system(s) it runs on?No, CHIRP only scans the system(s) it runs on and makes no active changes.How long will it take to run CHIRP?CHIRP will complete its scan in approximately 1 to 2 hours. Duration will be dependent on the level of activity, the system, and the size of the resident data sets. CHIRP will provide periodic progress updates as it runs.If I have questions, who do I contact?For general questions regarding CHIRP, please contact CISA via email atcentral@cisa.dhs.govor by phone at 1-888-282-0870. For reporting indicators of potential compromise, contact us by submitting a report through our website athttps://us-cert.cisa.gov/report. For all technical issues or support for CHIRP, please submit issues at theCISA CHIRP GitHub Repository. Systems running SolarWinds Orion or believed to be involved in any resulting lateral movement. Ingest the JSON results into a SIEM system, web browser, or text editor. Antivirus software developers may have begun to roll out detections for the SolarWinds post-compromise activity. However, those products can miss historical signs of compromise. CHIRP can provide a complementary benefit to antivirus when run.CISA previously released the Sparrow tool that scans for APT activity within M365 and Azure environments related to activity detailed in CISA Alerts AA20-352A and AA21-008A. CHIRP provides a complementary capability to Sparrow by scanning for on-premises systems for similar activity. Antivirus software developers may have begun to roll out detections for the SolarWinds post-compromise activity. However, those products can miss historical signs of compromise. CHIRP can provide a complementary benefit to antivirus when run. CISA previously released the Sparrow tool that scans for APT activity within M365 and Azure environments related to activity detailed in CISA Alerts AA20-352A and AA21-008A. CHIRP provides a complementary capability to Sparrow by scanning for on-premises systems for similar activity. CHIRP can be run once or routinely. Currently, CHIRP does not provide a mechanism to run repeatedly in its native format. No. No, CHIRP only scans the system(s) it runs on and makes no active changes. CHIRP will complete its scan in approximately 1 to 2 hours. Duration will be dependent on the level of activity, the system, and the size of the resident data sets. CHIRP will provide periodic progress updates as it runs. For general questions regarding CHIRP, please contact CISA via email atcentral@cisa.dhs.govor by phone at 1-888-282-0870. For reporting indicators of potential compromise, contact us by submitting a report through our website athttps://us-cert.cisa.gov/report. For all technical issues or support for CHIRP, please submit issues at theCISA CHIRP GitHub Repository."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-062a,"Mitigations CISA strongly recommends organizations readMicrosoft’s advisoryandsecurity blog postfor more information on how to look for this malicious activity and to apply critical patches as soon as possible. (Updated March 4, 2021):CISA is aware of threat actors using open source tools to search for vulnerable Microsoft Exchange Servers. This particular type of attack is scriptable, allowing attackers to easily exploit vulnerabilities through automated mechanisms. CISA advises all entities to patch as soon as possible to avoid being compromised. (Updated March 4, 2021):FromMicrosoft's patch release, the security updates are available for the following operating systems: Exchange Server 2010 (update requires SP 3 or any SP 3 RU – this is a Defense in Depth update)Exchange Server 2013 (update requires CU 23)Exchange Server 2016 (update requires CU 19 or CU 18)Exchange Server 2019 (update requires CU 8 or CU 7) (Updated March 4, 2021):If you are running an older CU then what the patch will accept, you must upgrade to at least the required CU as stated above then apply the patch. (Updated March 4, 2021):All patches must be applied using administrator privileges. (Updated March 5, 2021): If patching is not an immediate option, CISA strongly recommends following alternative mitigations found inMicrosoft’s blog on Exchange Server Vulnerabilities Mitigations. However, these options should only be used as a temporary solution, not a replacement for patching. Additionally, there are other mitigation options available. CISA recommends limiting or blocking external access to internet-facing Exchange Servers via the following: Restrict untrusted connections to port 443, or set up a VPN to separate the Exchange Server from external access; note that this will not prevent an adversary from exploiting the vulnerability if the attacker is already in your network.Block external access to on-premises Exchange:Restrict external access to OWA URL:/owa/.Restrict external access to Exchange Admin Center (EAC) aka Exchange Control Panel (ECP) URL:/ecp/.(Updated March 4, 2021):Disconnect vulnerable Exchange servers from the internet until a patch can be applied. Restrict external access to OWA URL:/owa/.Restrict external access to Exchange Admin Center (EAC) aka Exchange Control Panel (ECP) URL:/ecp/. Restrict external access to Exchange Admin Center (EAC) aka Exchange Control Panel (ECP) URL:/ecp/. (Updated March 4, 2021):Disconnect vulnerable Exchange servers from the internet until a patch can be applied. CISA would like to thank Microsoft and Volexity for their contributions to this Alert."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-055a,"Mitigations Organizations with Accellion FTA should: Temporarily isolate or block internet access to and from systems hosting the software.Assess the system for evidence of malicious activity including the IOCs, and obtain a snapshot or forensic disk image of the system for subsequent investigation.If malicious activity is identified, obtain a snapshot or forensic disk image of the system for subsequent investigation, then:Consider conducting an audit of Accellion FTA user accounts for any unauthorized changes, and consider resetting user passwords.Reset any security tokens on the system, including the “W1” encryption token, which may have been exposed through SQL injection.Update Accellion FTA to version FTA_9_12_432 or later.Evaluate potential solutions for migration to a supported file-sharing platform after completing appropriate testing.Accellion has announced that FTA will reach end-of-life (EOL) on April 30, 2021.[9] Replacing software and firmware/hardware before it reaches EOL significantly reduces risks and costs. Consider conducting an audit of Accellion FTA user accounts for any unauthorized changes, and consider resetting user passwords.Reset any security tokens on the system, including the “W1” encryption token, which may have been exposed through SQL injection. Accellion has announced that FTA will reach end-of-life (EOL) on April 30, 2021.[9] Replacing software and firmware/hardware before it reaches EOL significantly reduces risks and costs. Additional general best practices include: Deploying automated software update tools to ensure that third-party software on all systems is running the most recent security updates provided by the software vendor.Only using up-to-date and trusted third-party components for the software developed by the organization.Adding additional security controls to prevent the access from unauthenticated sources."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-008a,"Mitigations DETECTION Guidance on identifying affected SolarWinds software is well documented.[2] However—once an organization identifies a compromise via SolarWinds Orion products or other threat actor TTPs—identifying follow-on activity for on-premises networks requires fine-tuned network and host-based forensics. The nature of cloud forensics is unique due to the growing and rapidly evolving technology footprints of major vendors. Microsoft's O365 and M365 environments have built-in capabilities for detecting unusual activity. Microsoft also provides premium services (Advanced Threat Protection [ATP] and Azure Sentinel), which enable network defenders to investigate TTPs specific to the Solorigate activity.[3] DETECTION TOOLS CISA is providing examples of detection tools for informational purposes only. CISA does not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services does not constitute or imply their endorsement, recommendation, or favoring by CISA. There are a number of open-source tools available to investigate adversary activity in Microsoft cloud environments and to detect unusual activity, service principals, and application activity.[4]Publicly available PowerShell tools that network defenders can use to investigate M365 and Microsoft Azure include: CISA's Sparrow,Open-source utility Hawk, andCrowdStrike's Azure Reporting Tool (CRT). Additionally, Microsoft's Office 365 Management API and Graph API provide an open interface for ingesting telemetry and evaluating service configurations for signs of anomalous activity and intrusion. Note: these open-source tools are highlighted and explained to assist with on-site investigation and remediation in cloud environments but are not all-encompassing. Open source tools can be complemented by services such as Azure Sentinel, a Microsoft premium service that provides comprehensive analysis tools, including custom detections for the activity indicated. GENERAL GUIDANCE ON USING DETECTION TOOLS Audit the creation and use of service principal credentials. Look for unusual application usage, such as use of dormant applications.Audit the assignment of credentials to applications that allow non-interactive sign-in by the application. Look for unexpected trust relationships added to the Azure Active Directory.Download the interactive sign-ins from the Azure admin portal or use the Microsoft Sentinel product. Review new token validation time periods with high values and investigate whether it was a legitimate change or an attempt to gain persistence by a threat actor. SPARROW CISA createdSparrowto help network defenders detect possible compromised accounts and applications in the Azure/M365 environment. The tool focuses on the narrow scope of user and application activity endemic to identity- and authentication-based attacks seen recently in multiple sectors. It is neither comprehensive nor exhaustive of available data. It is intended to narrow a larger set of available investigation modules and telemetry to those specific to recent attacks on federated identity sources and applications. (Updated April 8, 2021):CISA has also created ""Aviary,"" which is a companion Splunk dashboard that can assist in visualizing and reviewing the output of Sparrow. Network defenders can find Aviary onCISA's Sparrow GitHub page. CISA advises network defenders to perform the following actions to use Sparrow: Use Sparrow to detect any recent domain authentication or federation modifications.Domain and federation modification operations are uncommon and should be investigated.Examine logs for new and modified credentials applied to applications and service principals; delineate for the credential type. Sparrow can be used to detect the modification of service principals and application credentials.Create a timeline for all credential changes, focusing on recent wholesale changes.Review the “top actors” for activity in the environment and the number of credential modifications performed.Monitor changes in application and service principal credentials.Investigate any instances of excessive permissions being granted, including, but not limited to, Exchange Online, Microsoft Graph, and Azure AD Graph.Use Sparrow to detect privilege escalation, such as adding a service principal, user, or group to a privileged role.Use Sparrow to detectOAuthconsent and users’ consent to applications, which is useful for interpreting changes in adversary TTPs.Use Sparrow to identify anomalous Security Assertion Markup Language (SAML) token sign-ins by pivoting on the unified audit log UserAuthenticationValue of 16457, which is an indicator of how a SAML token was built and is a potential indicator for forged SAML tokens.Note that this TTP has not been the subject of significant published security research but may indicate an unusual usage of a token, such as guest access for external partners to M365 resources.Review the PowerShell logs that Sparrow exports.Review PowerShell mailbox sign-ins and validate that the logins are legitimate actions.Review PowerShell usage for users with PowerShell in the environment.Use Sparrow to check the Graph API application permissions of all service principals and applications in M365/Azure AD.Investigate unusual activity regarding Microsoft Graph API permissions (using either the legacyhttps://graph.windows.net/orhttps://graph.microsoft.com). Graph is used frequently as part of these TTPs, often to access and manipulate mailbox resources.Review Sparrow’s listed tenant’s Azure AD domains, to see if the domains have been modified.For customers with G5 or E5 licensing levels, review MailItemsAccessed for insight into what application identification (ID) was used for accessing users’ mailboxes. Use Sparrow to query for a specific application ID using the app id investigation capability, which will check to see if it is accessing mail or file items.The MailItemsAccessed event provides audibility for mailbox data accessed via mail protocols or clients.By analyzing the MailItemsAccessed action, incident responders can determine which user mailbox items have been accessed and potentially exfiltrated by a threat actor. This event will be recorded even in some situations where the message was not necessarily read interactively (e.g., bind or sync).[5]The resulting suspicious application ID can provide incident responders with a pivot to detect other suspicious applications that require additional analysis.Check for changes to applications with regards to the accessing of resources such as mail or file items. Domain and federation modification operations are uncommon and should be investigated. Create a timeline for all credential changes, focusing on recent wholesale changes.Review the “top actors” for activity in the environment and the number of credential modifications performed.Monitor changes in application and service principal credentials.Investigate any instances of excessive permissions being granted, including, but not limited to, Exchange Online, Microsoft Graph, and Azure AD Graph. Note that this TTP has not been the subject of significant published security research but may indicate an unusual usage of a token, such as guest access for external partners to M365 resources. Review PowerShell mailbox sign-ins and validate that the logins are legitimate actions.Review PowerShell usage for users with PowerShell in the environment. Investigate unusual activity regarding Microsoft Graph API permissions (using either the legacyhttps://graph.windows.net/orhttps://graph.microsoft.com). Graph is used frequently as part of these TTPs, often to access and manipulate mailbox resources. The MailItemsAccessed event provides audibility for mailbox data accessed via mail protocols or clients.By analyzing the MailItemsAccessed action, incident responders can determine which user mailbox items have been accessed and potentially exfiltrated by a threat actor. This event will be recorded even in some situations where the message was not necessarily read interactively (e.g., bind or sync).[5]The resulting suspicious application ID can provide incident responders with a pivot to detect other suspicious applications that require additional analysis.Check for changes to applications with regards to the accessing of resources such as mail or file items. (Updated April 8, 2021):Aviary can be used to assist with performing the above tasks. To install Aviary, after running Sparrow: Ingest comma separated values (CSV) output from the Sparrow PowerShell script into Splunk.Sparrow output will have the following default filenames, which should not be modified:AppUpdate_Operations_Export.csv,AppRoleAssignment_Operations_Export.csv,Consent_Operations_Export.csv,Domain_List.csv,Domain_Operations_Export.csv,FileItems_Operations_Export.csv,MailItems_Operations_Export.csv,PSLogin_Operations_Export.csv,PSMailbox_Operations_Export.csv,SAMLToken_Operations_Export.csv,ServicePrincipal_Operations_Export.csvCopy and paste the contents of the .xml file (aviary.xml in the root directory) into a new dashboard.Use the data selection filters to point to the indexed Sparrow data (see figure 1) Sparrow output will have the following default filenames, which should not be modified:AppUpdate_Operations_Export.csv,AppRoleAssignment_Operations_Export.csv,Consent_Operations_Export.csv,Domain_List.csv,Domain_Operations_Export.csv,FileItems_Operations_Export.csv,MailItems_Operations_Export.csv,PSLogin_Operations_Export.csv,PSMailbox_Operations_Export.csv,SAMLToken_Operations_Export.csv,ServicePrincipal_Operations_Export.csv  Figure 1: Data Selection Filters  HAWK Hawk is an open-source, PowerShell-driven, community-developed tool network defenders can use to quickly and easily gather data from O365 and Azure for security investigations. Incident responders and network defenders can investigate specific user principals or the entire tenant. Data it provides include IP addresses and sign-in data. Additionally, Hawk can track IP usage for concurrent login situations. Hawk users should review login details for administrator accounts and take the following steps. CROWDSTRIKE AZURE REPORTING TOOL CrowdStrike's Azure Reporting Tool(CRT) can help network defenders analyze their Microsoft Azure AD and M365 environment to help organizations analyze permissions in their Azure AD tenant and service configuration. This tool has minor overlap with Sparrow; it shows unique items, but it does not cover the same areas. CISA is highlighting this tool because it is one of the only free, open-source tools available to investigate this activity and could be used to complement Sparrow. DETECTION TOOL DISTINCTIONS DETECTION METHODS Microsoft breaks the threat actor’s recent activity into four primary stages, which are described below along with associated detection methods. Microsoft describes these stages as beginning with all activity after the compromise of the on-premises identity solution, such as ADFS.[6] Note: this step provides an entry vector to cloud technology environments, and is unnecessary when the threat actor has compromised an identity solution or credential that allows the APT direct access to the cloud(e.g., without leveraging the SolarWinds Orion vulnerability). Stage 1: Forging a trusted authentication token used to access resources that trust the on-premises identity provider These attacks (often referred to as “Golden Security Assertion Markup Language” attacks) can be analyzed using a combination of cloud-based and standard on-premises techniques.[7]For example, network defenders can useOAuthclaims for specific principals made at the Azure AD level and compare them to the on-premises identity. Export sign-in logs from the Azure AD portal and look at the Authentication Method field. Note: at portal.azure.com, click on a user and review the authentication details (e.g., date, method, result). Without Sentinel, this is the only way to get these logs, which are critical for this effort. Detection Method 1: Correlating service provider login events with corresponding authentication events in Active Directory Federation Services (ADFS) and Domain Controllers Using SAML single sign-on, search for any logins to service providers that do not have corresponding event IDs 4769, 1200, and 1202 in the domain. Detection Method 2: Identifying certificate export events in ADFS Look for: Detection Method 3: Customizing SAML response to identify irregular access This method serves as prevention for the future (and would only detect future, not past, activity), as it helps identify irregularities from the point of the change forward. Organizations can modify SAML responses to include custom elements for each service provider to monitor and detect any anomalous requests.[8] Detection Method 4: Detecting malicious ADFS trust modification A threat actor who gains administrative access to ADFS can add a new, trusted ADFS rather than extracting the certificate and private key as part of a standard Golden SAML attack.[9]Network defenders should look for: Stage 2: Using the forged authentication token to create configuration changes in the Service Provider, such as Azure AD (establishing a foothold) After the threat actor has compromised the on-premises identity provider, they identify their next series of objectives by reviewing activity in the Microsoft Cloud activity space (Microsoft Azure and M365 tenants). The threat actor uses the ability to forge authentication tokens to establish a presence in the cloud environment. The actor adds additional credentials to an existing service principal. Once the threat actor has impersonated a privileged Azure AD account, they are likely to further manipulate the Azure/M365 environment (action on objectives in the cloud). Network defenders should take the following steps. Stage 3: Acquiring anOAuthaccess token for the application using the forged credentials added to an existing application or service principal and calling APIs with the permissions assigned to that application In some cases, the threat actor has been observed adding permissions to existing applications or service principals. Additionally the actor has been seen establishing new applications or service principals briefly and using them to add permissions to the existing applications or service principals, possibly to add a layer of indirection (e.g., using it to add a credential to another service principal, and then deleting it).[11] Network defenders should use Sparrow to: Stage 4: Once access has been established, the threat actor Uses Microsoft Graph API to conduct action on objectives from an external RESTful API (queries impersonating existing applications). Network defenders should: MICROSOFT TELEMETRY NUANCES The existing tools and techniques used to evaluate cloud-based telemetry sources present challenges not represented in traditional forensic techniques. Primarily, the amount of telemetry retention is far less than the traditional logging facilities of on-premises data sources. Threat actor activity that is more than 90 days old is unlikely to have been saved by traditional sources or be visible with the Microsoft M365 Management API or in the UAL. Service principal logging is available using the Azure Portal via the ""Service Principal Sign-ins"" feature. Enable settings in the Azure Portal (see “Diagnostic Setting”) to ingest logs into Sentinel or a third-party security information and event management (SIEM) tool. An Azure Premium P1 or Premium P2 license is necessary to access this setting as well as other features, such as a log analytics workspace, storage account, or event hub.[12]These logs must be downloaded manually if not ingested by one of the methods listed in the Detection Methods section. Global Administrator rights are often required by tools other than Hawk and Sparrow to evaluate M365 cloud security posture. Logging capability and visibility of data varies by licensing models and subscription to premium services, such as Microsoft Defender for O365 and Azure Sentinel. According to CrowdStrike, ""There was an inability to audit via API, and there is the requirement for global admin rights to view important information which we found to be excessive. Key information should be easily accessible.""[13] Documentation for specific event codes, such as UserAuthenticationMethod 16457, which may indicate a suspicious SAML token forgery, is no longer available in the M365 Unified Access Log. Auditing narratives on some events no longer exist as part of core Microsoft documentation sources. The use of industry-standard SIEMs for log detection is crucial for providing historical context for threat hunting in Microsoft cloud environments. Standard G3/E3 licenses only provide 90 days of auditing; with the advanced auditing license that is provided with a G5/E5 license, audit logs can be extended to retain information for a year. CISA notes that this license change is proactive, rather than reactive: it allows enhanced visibility and features for telemetry from the moment of integration but does not provide retroactive visibility on previous events or historical context. A properly configured SIEM can provide: Built-in tools, such as Microsoft Cloud Services and M365 applications, provide much of the same visibility available from custom tools and are mapped to the MITRE ATT&CK framework and easy-to-understand dashboards.[14]However, these tools often do not have the ability to pull historical data older than seven days. Therefore, storage solutions that appropriately meet governance standards and usability metrics for analysts for the SIEM must be carefully planned and arranged. Ingest comma separated values (CSV) output from the Sparrow PowerShell script into Splunk.Sparrow output will have the following default filenames, which should not be modified:AppUpdate_Operations_Export.csv,AppRoleAssignment_Operations_Export.csv,Consent_Operations_Export.csv,Domain_List.csv,Domain_Operations_Export.csv,FileItems_Operations_Export.csv,MailItems_Operations_Export.csv,PSLogin_Operations_Export.csv,PSMailbox_Operations_Export.csv,SAMLToken_Operations_Export.csv,ServicePrincipal_Operations_Export.csvCopy and paste the contents of the .xml file (aviary.xml in the root directory) into a new dashboard.Use the data selection filters to point to the indexed Sparrow data (see figure 1)Investigate high-value administrative accounts to detect anomalous or unusual activity (Global Admins).Enable PowerShell logging, and evaluate PowerShell activity in the environment not used for traditional or expected purposes.PowerShell logging does not reveal the exactcmdletthat was run on the tenant.Look for users with unusual sign-in locations, dates, and times.Check permissions of service principals and applications in M365/Azure AD.Detect the frequency of resource access from unusual places. Use the tool to pivot to a trusted application and see if it is accessing mail or file items.Review mailbox rules and recent mailbox rule changes.Sparrow differs from CRT by looking for specific indicators of compromise associated with the recent attacks.CRT focuses on the tenant’s Azure AD permissions and Exchange Online configuration settings instead of the unified audit log, which gives it a different output from Sparrow or Hawk.CRT returns the same broad scope of application/delegated permissions for service principals and applications as Hawk.As part of its investigation, Sparrow homes in on a narrow set of application permissions given to the Graph API, which is common to the recent attacks.CRT looks at Exchange Online federation configuration and federation trust, while Sparrow focuses on listing Azure AD domains.Among the items network defenders can use CRT to review are delegated permissions and application permissions, federation configurations, federation trusts, mail forwarding rules, service principals, and objects with KeyCredentials.The IP address and Activity_ID in EventCode 410 and the Activity_ID and Instance_ID in EventCode 500.Export-PfxCertificate or certutil-exportPFX in Event IDs 4103 and 4104, which may include detection of a certificate extraction technique.Deleted certificate extraction with ADFSdump performed using Sysmon Event ID 18 with the pipe name \microsoft##wid\tsql\query (exclude processes regularly making this pipe connection on the machine).Event ID 307 (The Federation Service configuration was changed), which can be correlated to relevant Event ID 510 with the same instance ID for change details (Event ID 510 with the same Instance ID could be more than one event per single Event ID 307 event).Event ID 307 (The Federation Service configuration was changed), which can be correlated to relevant Event ID 510 with the same Instance ID for change details. (Event ID 510 with the same Instance ID could be more than one event per single Event ID 307 event.)Review events, particularly searching for Configuration: Type: IssuanceAuthority where Property Value references an unfamiliar domain.Possible activity of an interrogating ADFS host by using ADFS PowerShell plugins. Look for changes in the federation trust environment that would indicate new ADFS sources.Audit the creation and use of service principal and application credentials. Sparrow will detect modifications to these credentials.Look for unusual application usage, such as dormant or forgotten applications being used again.Audit the assignment of credentials to applications that allow non-interactive sign-in by the application.Look for unexpected trust relationships that have been added to Azure AD. (Download the last 30 days of non-interactive sign-ins from the Azure portal or use Azure Sentinel.).[10]Use Hawk (and any sub-modules available) to run an investigation on a specific user. Hawk will provide IP addresses, sign-in data, and other data. Hawk can also track IP usage in concurrent login situations.Review login details for administrator accounts (e.g., high-value administrative accounts, such as Global Admins). Look for unusual sign-in locations, dates, and times.Review new token validation time periods with high values and investigate whether the changes are legitimate or a threat actor’s attempts to gain persistence.Examine highly privileged accounts; specifically using sign-in logs, look for unusual sign-in locations, dates, and times.Create a timeline for all credential changes.Monitor changes in application credentials (the script will export into csv named AppUpdate_Operations_Export).Detect service principal credentials change and service principal change (e.g., if an actor adds new permissions or expands existing permissions).Export and view this activity via the ServicePrincipal_Operations_Export.RecordOAuthconsent and consent to applicationsExport and view this record via the Consent_Operations_Export file.Investigate instances of excessive high permissions, including, but not limited to Exchange Online, Microsoft Graph, and Azure AD Graph.Review Microsoft Graph API permissions granted to service principals.Export and view this activity via the ApplicationGraphPermissions csv file.Note:Hawk can also return the full list of service principal permissions for further investigation.Review top actors and the amount of credential modifications performed.Monitor changes in application credentials.Identify manipulation of custom or third-party applications.Network defenders should review the catalog of custom or third-party vendors with applications in the Microsoft tenant and perform the above interrogation principles on those applications and trusts.Review modifications to federation trust settings.Review new token validation time periods with high values and investigate whether this was a legitimate change or an attempt to gain persistence by the threat actor.The script detects the escalation of privileges, including the addition of Service Principals (SP) to privileged roles. Export this data into csv called AppRoleAssignment_Operations_Export.In MailItemsAccessed operations, found within the Unified Audit Log (UAL), review the application ID used (requires G5 or E5 license for this specific detail).Query the specific application ID, using the Sparrow script’s app ID investigation capability to interrogate mail and file items accessed for that applicationID (Use the application ID utility for any other suspicious apps that require additional analysis.).Check the permissions of an application in M365/Azure AD using Sparrow.Hawk will return Azure_Application_Audit, and Sparrow will return ApplicationGraphPermissions.Network defenders will see the IP address that Graph API uses.Note: the Microsoft IP address may not show up as a virtual private server/anonymized endpoint.Investigate a specific service principal, if it is a user-specific user account, in Hawk. This activity is challenging to see without Azure Sentinel or manually downloading and reviewing logs from the sign-in portal.Longer term storage of log data.Cross correlation of log data with endpoint data and network data (such as those produced by ADFS servers), endpoint detection and response data, and identity provider information.Ability to query use of application connectors in Azure. Sparrow output will have the following default filenames, which should not be modified:AppUpdate_Operations_Export.csv,AppRoleAssignment_Operations_Export.csv,Consent_Operations_Export.csv,Domain_List.csv,Domain_Operations_Export.csv,FileItems_Operations_Export.csv,MailItems_Operations_Export.csv,PSLogin_Operations_Export.csv,PSMailbox_Operations_Export.csv,SAMLToken_Operations_Export.csv,ServicePrincipal_Operations_Export.csv Investigate high-value administrative accounts to detect anomalous or unusual activity (Global Admins).Enable PowerShell logging, and evaluate PowerShell activity in the environment not used for traditional or expected purposes.PowerShell logging does not reveal the exactcmdletthat was run on the tenant.Look for users with unusual sign-in locations, dates, and times.Check permissions of service principals and applications in M365/Azure AD.Detect the frequency of resource access from unusual places. Use the tool to pivot to a trusted application and see if it is accessing mail or file items.Review mailbox rules and recent mailbox rule changes. PowerShell logging does not reveal the exactcmdletthat was run on the tenant. Sparrow differs from CRT by looking for specific indicators of compromise associated with the recent attacks.CRT focuses on the tenant’s Azure AD permissions and Exchange Online configuration settings instead of the unified audit log, which gives it a different output from Sparrow or Hawk.CRT returns the same broad scope of application/delegated permissions for service principals and applications as Hawk.As part of its investigation, Sparrow homes in on a narrow set of application permissions given to the Graph API, which is common to the recent attacks.CRT looks at Exchange Online federation configuration and federation trust, while Sparrow focuses on listing Azure AD domains.Among the items network defenders can use CRT to review are delegated permissions and application permissions, federation configurations, federation trusts, mail forwarding rules, service principals, and objects with KeyCredentials. The IP address and Activity_ID in EventCode 410 and the Activity_ID and Instance_ID in EventCode 500.Export-PfxCertificate or certutil-exportPFX in Event IDs 4103 and 4104, which may include detection of a certificate extraction technique.Deleted certificate extraction with ADFSdump performed using Sysmon Event ID 18 with the pipe name \microsoft##wid\tsql\query (exclude processes regularly making this pipe connection on the machine).Event ID 307 (The Federation Service configuration was changed), which can be correlated to relevant Event ID 510 with the same instance ID for change details (Event ID 510 with the same Instance ID could be more than one event per single Event ID 307 event).Event ID 307 (The Federation Service configuration was changed), which can be correlated to relevant Event ID 510 with the same Instance ID for change details. (Event ID 510 with the same Instance ID could be more than one event per single Event ID 307 event.)Review events, particularly searching for Configuration: Type: IssuanceAuthority where Property Value references an unfamiliar domain.Possible activity of an interrogating ADFS host by using ADFS PowerShell plugins. Look for changes in the federation trust environment that would indicate new ADFS sources.Audit the creation and use of service principal and application credentials. Sparrow will detect modifications to these credentials.Look for unusual application usage, such as dormant or forgotten applications being used again.Audit the assignment of credentials to applications that allow non-interactive sign-in by the application.Look for unexpected trust relationships that have been added to Azure AD. (Download the last 30 days of non-interactive sign-ins from the Azure portal or use Azure Sentinel.).[10]Use Hawk (and any sub-modules available) to run an investigation on a specific user. Hawk will provide IP addresses, sign-in data, and other data. Hawk can also track IP usage in concurrent login situations.Review login details for administrator accounts (e.g., high-value administrative accounts, such as Global Admins). Look for unusual sign-in locations, dates, and times.Review new token validation time periods with high values and investigate whether the changes are legitimate or a threat actor’s attempts to gain persistence.Examine highly privileged accounts; specifically using sign-in logs, look for unusual sign-in locations, dates, and times.Create a timeline for all credential changes.Monitor changes in application credentials (the script will export into csv named AppUpdate_Operations_Export).Detect service principal credentials change and service principal change (e.g., if an actor adds new permissions or expands existing permissions).Export and view this activity via the ServicePrincipal_Operations_Export.RecordOAuthconsent and consent to applicationsExport and view this record via the Consent_Operations_Export file.Investigate instances of excessive high permissions, including, but not limited to Exchange Online, Microsoft Graph, and Azure AD Graph.Review Microsoft Graph API permissions granted to service principals.Export and view this activity via the ApplicationGraphPermissions csv file.Note:Hawk can also return the full list of service principal permissions for further investigation.Review top actors and the amount of credential modifications performed.Monitor changes in application credentials.Identify manipulation of custom or third-party applications.Network defenders should review the catalog of custom or third-party vendors with applications in the Microsoft tenant and perform the above interrogation principles on those applications and trusts.Review modifications to federation trust settings.Review new token validation time periods with high values and investigate whether this was a legitimate change or an attempt to gain persistence by the threat actor.The script detects the escalation of privileges, including the addition of Service Principals (SP) to privileged roles. Export this data into csv called AppRoleAssignment_Operations_Export.In MailItemsAccessed operations, found within the Unified Audit Log (UAL), review the application ID used (requires G5 or E5 license for this specific detail).Query the specific application ID, using the Sparrow script’s app ID investigation capability to interrogate mail and file items accessed for that applicationID (Use the application ID utility for any other suspicious apps that require additional analysis.).Check the permissions of an application in M365/Azure AD using Sparrow.Hawk will return Azure_Application_Audit, and Sparrow will return ApplicationGraphPermissions.Network defenders will see the IP address that Graph API uses.Note: the Microsoft IP address may not show up as a virtual private server/anonymized endpoint.Investigate a specific service principal, if it is a user-specific user account, in Hawk. This activity is challenging to see without Azure Sentinel or manually downloading and reviewing logs from the sign-in portal.Longer term storage of log data.Cross correlation of log data with endpoint data and network data (such as those produced by ADFS servers), endpoint detection and response data, and identity provider information.Ability to query use of application connectors in Azure. Review events, particularly searching for Configuration: Type: IssuanceAuthority where Property Value references an unfamiliar domain. Look for unusual application usage, such as dormant or forgotten applications being used again.Audit the assignment of credentials to applications that allow non-interactive sign-in by the application. Export and view this activity via the ServicePrincipal_Operations_Export. Export and view this record via the Consent_Operations_Export file. Review Microsoft Graph API permissions granted to service principals.Export and view this activity via the ApplicationGraphPermissions csv file.Note:Hawk can also return the full list of service principal permissions for further investigation.Review top actors and the amount of credential modifications performed.Monitor changes in application credentials. Note:Hawk can also return the full list of service principal permissions for further investigation. Network defenders should review the catalog of custom or third-party vendors with applications in the Microsoft tenant and perform the above interrogation principles on those applications and trusts. Review new token validation time periods with high values and investigate whether this was a legitimate change or an attempt to gain persistence by the threat actor.The script detects the escalation of privileges, including the addition of Service Principals (SP) to privileged roles. Export this data into csv called AppRoleAssignment_Operations_Export. The script detects the escalation of privileges, including the addition of Service Principals (SP) to privileged roles. Export this data into csv called AppRoleAssignment_Operations_Export. Hawk will return Azure_Application_Audit, and Sparrow will return ApplicationGraphPermissions.Network defenders will see the IP address that Graph API uses.Note: the Microsoft IP address may not show up as a virtual private server/anonymized endpoint."
