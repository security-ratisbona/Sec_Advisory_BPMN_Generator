URL,Content
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a,"MITIGATIONS These mitigations apply to all critical infrastructure organizations and network defenders. FBI, CISA, and HHS recommend that software manufactures incorporate secure by design principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the security posture for their customers. For more information on secure by design, see CISA’sSecure by Designwebpage andjoint guide. FBI, CISA, and HHS recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity and to reduce the risk of compromise by ALPHV Blackcat threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Due to the threat ALPHV Blackcat’s poses in the healthcare sector, healthcare organizations can look to theHealthcare and Public Health (HPH) Sector Cybersecurity Performance Goalsto implement cybersecurity protections against the most common threats. tactics, techniques, and procedures used against this sector. Secure remote access tools by:Implementing application controlsto manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.Applying recommendations in CISA's jointGuide to Securing Remote Access Software.Implementing FIDO/WebAuthn authentication or Public key Infrastructure (PKI)-based MFA[CPG 2.H][HPH CPG – Multifactor Authentication]. These MFA implementations are resistant to phishing and not susceptible to push bombing or SIM swap attacks, which are techniques known be used by ALPHV Blackcat affiliates. See CISA’s Fact SheetImplementing Phishing-Resistant MFAfor more information.Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.To aid in detecting ransomware, implement a tool that logs and reports all network traffic [CPG 5.1][HPH CPG – Detect and Respond to Relevant Threats and Tactics, Techniques and Procedures], including lateral movement activity on a network. Endpoint detection and response (EDR) tools are useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.Implement user training on social engineering and phishing attacks[CPG 2.I][HPH CPG – Basic Cybersecurity Training]. Regularly educate users on identifying suspicious emails and links, not interacting with those suspicious items, and the importance of reporting instances of opening suspicious emails, links, attachments, or other potential lures.Implement internal mail and messaging monitoring. Monitoring internal mail and messaging traffic to identify suspicious activity is essential as users may be phished from outside the targeted network or without the knowledge of the organizational security team. Establish a baseline of normal network traffic and scrutinize any deviations.Implement free security toolsto prevent cyber threat actors from redirecting users to malicious websites to steal their credentials. For more information see, CISA’sFree Cybersecurity Services and Toolswebpage.Install and maintain antivirus software.Antivirus software recognizes malware and protects your computer against it. Installing antivirus software from a reputable vendor is an important step in preventing and detecting infections. Always visit vendor sites directly rather than clicking on advertisements or email links. Because attackers are continually creating new viruses and other forms of malicious code, it is important to keep your antivirus software up to date."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-349a,"MITIGATIONS NETWORK DEFENDERS CISA recommends HPH Sector and other critical infrastructure organizations implement the mitigations in Table 6 to mitigate the issues listed in the Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Additionally, CISA recommends that HPH sector organizations implement the following strategies to mitigate cyber threats: Mitigation Strategy #1 Asset Management and Security:CISA recommends that HPH sector organizations implement and maintain an asset management policy to reduce the risk of exposing vulnerabilities, devices, or services that could be exploited by threat actors to gain unauthorized access, steal sensitive data, or disrupt critical services. The focus areas for this mitigation strategy include asset management and asset security, addressing asset inventory, procurement, decommissioning, and network segmentation as they relate to hardware, software, and data assets.Mitigation Strategy #2 Identity Management and Device Security:CISA recommends entities secure their devices and digital accounts and manage their online access to protect sensitive data and PII/PHI from compromise. The focus areas for this mitigation strategy include email security, phising prevention, access management, password policies, data protection and loss prevention, and device logs and monitoring solutions.Mitigation Strategy #3 Vulnerability, Patch, and Configuration Management:CISA recommends entities mitigate known vulnerabilities and establish secure configuration baselines to reduce the likelihood of threat actors exploiting known vulnerabilities to breach organizational networks. The focus areas for this mitigation strategy include vulnerability and patch Management, and configuration and change management. For more information on these mitigations strategies, see CISA’sHealthcare and Public Health Sectorwebpage. SOFTWARE MANUFACTURERS The above mitigations apply to HPH sector and other critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of the majority of these flaws, and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team: Embed security into product architecture throughout theentiresoftware development lifecycle (SDLC).Eliminate default passwords. Do not provide software with default passwords. To eliminate default passwords, require administrators set a “strong” password [CPG 2.B] during installation and configuration.Create secure configuration templates. Provide configuration templates with certain safe settings based on an organization’s risk appetite (e.g., low, medium, and high security templates). Support these templates with hardening guides based on the risks the manufacturer has identified. The default configuration should be a secure one, and organizations should need to opt in if they desire a less secure configuration.Design products so that the compromise of a single security control does not result in compromise of the entire system. For example, narrowly provision user privileges by default and employ ACLs to reduce the impact of a compromised account. This will make it more difficult for a malicious cyber actor to escalate privileges and move laterally.Mandate MFA,ideally phishing-resistant MFA, for privileged usersand make MFA a default, rather than opt-in, feature. These mitigations align with tactics provided in the joint guideShifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates. For more information on secure by design, see CISA’sSecure by Designwebpage. For more information on common misconfigurations and guidance on reducing their prevalence, see the joint advisoryNSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a,"MITIGATIONS The FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of this campaign poses a threat to public safety and recommend organizations implement the mitigations below to improve organization’s cybersecurity posture. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Apply available patchesfor CVE-2023-42793 issued by JetBrains TeamCity in mid-September 2023, if not already completed.Monitor the networkfor evidence of encoded commands and execution of network scanning tools.Ensure host-based anti-virus/endpoint monitoring solutions are enabledand set to alert if monitoring or reporting is disabled, or if communication is lost with a host agent for more than a reasonable amount of time.Require use of multi-factor authentication[CPG 1.3] for all services to the extent possible, particularly for email, virtual private networks, and accounts that access critical systems.Organizations should adopt multi-factor authentication (MFA) as an additional layer of security for all users with access to sensitive data. Enabling MFA significantly reduces the risk of unauthorized access, even if passwords are compromised.Keep all operating systems, software, and firmware up to date.Immediately configure newly-added systems to the network, including those used for testing or development work, to follow the organization’s security baseline and incorporate into enterprise monitoring tools.Audit log filesto identify attempts to access privileged certificates and creation of fake identity providers.Deploy software to identify suspicious behavior on systems.Deploy endpoint protection systemswith the ability to monitor for behavioral indicators of compromise.Use available public resources to identify credential abuse with cloud environments.Configure authentication mechanismsto confirm certain user activities on systems, including registering new devices."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-341a,"MITIGATIONS A number of mitigations will be useful in defending against the activity described in this advisory. Use strong passwords. Use a separate password for email accounts and avoid password re-use across multiple services.See NCSC guidance:Top Tips for Staying Secure Online.Use multi-factor authentication(2-factor authentication/two-step authentication) to reduce the impact of password compromises. See NCSC guidance:Multi-factor Authentication for Online ServicesandSetting Up 2-Step Verification (2SV).Protect your devices and networks by keeping them up to date:Use the latest supported versions, apply security updates promptly, use anti-virus and scan regularly to guard against known malware threats. See NCSC guidance:Device Security Guidance.Exercise vigilance.Spearphishing emails are tailored to avoid suspicion. You may recognize the sender’s name, but has the email come from an address that you recognize? Would you expect contact from this person’s webmail address rather than their corporate email address? Has the suspicious email come to your personal/webmail address rather than your corporate one? Can you verify that the email is legitimate via another means? See NCSC guidance:Phishing attacks: Defending Your OrganizationandInternet Crime Complaint Center(IC3) | Industry Alerts.Enable your email providers’ automated email scanning features.These are turned on by default for consumer mail providers. See NCSC guidance:Telling Users to ""Avoid Clicking Bad Links"" Still Isn’t Working.Disable mail-forwarding.Attackers have been observed to set up mail-forwarding rules to maintain visibility of target emails. If you cannot disable mail-forwarding, then monitor settings regularly to ensure that a forwarding rule has not been set up by an external malicious actor."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-339a,"MITIGATIONS CISA recommends organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. These mitigations apply to all critical infrastructure organizations and network defenders. CISA recommends that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices, limiting the impact of threat actor techniques and strengthening the security posture for their customers. For more information on secure by design, see CISA’sSecure by Designwebpage. MANAGE VULNERABILITIES AND CONFIGURATIONS Upgrade all versions affected by this vulnerability.Keep all software up to date and prioritize patching according to CISA’sKnown Exploited Vulnerabilities Catalog[1.E].Prioritize remediation of vulnerabilities on internet-facing systems,for example, by conducting continuous automated and/or routine vulnerability scans.Prioritize secure-by-default configurationssuch as eliminating default passwords, implementing single sign-on (SSO) technology via modern open standards. This also includes disabling default credentials. SEGMENT NETWORKS Employ proper network segmentation, such as a demilitarized zone (DMZ)[2.F]. The end goal of a DMZ network is to allow an organization to access untrusted networks, such as the internet, while ensuring its private network or local area network (LAN) remains secure. Organizations typically store external-facing services and resources—as well as servers used for DNS, file transfer protocol (FTP), mail, proxy, voice over internet protocol (VoIP)—and web servers in the DMZ.Use a firewall or web-application firewall (WAF) and enable logging[2.G, 2.T] to prevent/detect potential exploitation attempts. Review ingress and egress firewall rules and block all unapproved protocols. Limit risky (but approved) protocols through rules.Implement network segmentation to separate network segments based on role and functionality[2.E].Proper network segmentation significantly reduces the ability for threat actor lateral movement by controlling traffic flows between—and access to—various subnetworks. See CISA’sLayering Network Security Through Segmentationinfographic and the National Security Agency’s (NSA’s)Segment Networks and Deploy Application-Aware Defenses.Deploy application-aware network defenses to block improperly formed traffic and restrict content,according to policy and legal authorizations. Traditional intrusion detection systems (IDS) based on known-bad signatures are quickly decreasing in effectiveness due to encryption and obfuscation techniques. Threat actors hide malicious actions and remove data over common protocols, making the need for sophisticated, application-aware defensive mechanisms critical for modern network defenses. APPLICATION CONTROL Enforce signed software execution policies.Use a modern operating system that enforces signed software execution policies for scripts, executables, device drivers, and system firmware. Maintain a list of trusted certificates to prevent and detect the use and injection of illegitimate executables. Execution policies, when used in conjunction with a secure boot capability, can assure system integrity.Application control should be used with signed software execution policies to provide greater control. Allowing unsigned software enables threat actors to gain a foothold and establish persistence through embedded malicious code. See NSA’sEnforce Signed Software Execution Policies. MANAGE ACCOUNTS, PERMISSIONS, AND WORKSTATIONS Requirephishing-resistant multifactor authentication (MFA)[2.H] for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.Implement the principle of least privilegeto decrease threat actors’ abilities to access key network resources.Restrict file and directory permissions. Use file system access controls to protect folders such as C:\Windows\System32.Restrict NTLM authentication policy settings,including incoming NTLM traffic from client computers, other member servers, or a domain controller.[8]"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-336a,"Mitigations The authoring agencies recommend critical infrastructure organizations, including WWS Sector facilities, implement the following mitigation and detection strategies to improve organizational cybersecurity posture to defend against IRGC-affiliated activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Note:The mitigations below are based on threat actor activity against Unitronics PLCs, but threat actors have targeted multiple internet-exposed PLCs in 2024.1These mitigations should be applied to any internet-facing PLCs. NETWORK DEFENDERS (Updated Dec. 18, 2024) The cyber threat actors accessed the affected devices—Unitronics Vision Series PLCs—by authenticating to internet-connected devices using default or no passwords. To safeguard against this threat, the authoring agencies urge organizations to consider the following: Immediate steps to prevent the attack: (Updated Dec. 18, 2024)Upgrade engineering workstations to 9.9.00 VisiLogic software and upgrade the firmware of all Vision series PLC/HMI devicesto the newest firmware for that model, [CPG 2.A], ensuring a strong password is used.For more information, see Unitronics’ blogUnitronics Cybersecurity for Vision and Samba PLC SeriesandRelease notes for VisiLogic 9.9.00.Replace all default passwords on PLCs and HMIs with a strong password.[CPG 2.A] In particular, ensure the Unitronics PLC default password is not in use. Apply new security-related ladder logic elements to the project files on these devices, to include TCP/IP passwords, upload project files passwords, INFO mode passwords, and SD card passwords.Disconnect the PLC from the public-facing internet[CPG 2.X]. Either disable the capability for remotely programming PLCs or require a strong password for remotely programming the PLC. Also change the default port, default PLC device name, and place behind a firewall that can detect attempted remote brute-forcing for the device password. (Update End) Follow-up steps to strengthen security posture: Implement multifactor authentication[CPG 2.H] for access to the OT network whenever applicable.If remote access is required,implement a network proxy, gateway, firewall and/or virtual private network (VPN) in front of the PLC to control network access.A VPN or gateway device can enable multifactor authentication for remote access even if the PLC does not support multifactor authentication. Implement security rules on these higher-level network security mechanisms that prevent the type of repeated and sustained login attempts that would be seen during a brute force attack. When possible, implement a device control list for workstations sending messages or connecting to OT components.Keep Unitronics and other PLC devices updated with the latest software patches by the manufacturer.Confirm third-party vendors apply the above recommended countermeasuresto mitigate exposure of these devices and all installed equipment. (Updated Dec. 18, 2024) Implement network segmentation[CPG 2.F] through the use of network proxies, gateways, and firewalls and/or through the use of the Purdue Model to establish multiple levels and zones.Adopt mature asset management processesand understand which assets are being exposed, why they are being exposed, and their support and patch status.Periodically inventory internet accessible devices[CPG 1.A]to identify any unexpected devices connected to the network.Configure external and internal firewalls to block traffic using common ports associated with network protocols that are unnecessary for the particular network segment.Authenticate all access to field controllers before authorizing access to, or modification of, a device’s state, logic, or programs.Centralized authentication techniques can help manage the large number of field controller accounts needed across the industrial control system (ICS).Disable any unused authentication methods,logic, or features,such as default authentication keys.Use a role-based mechanism to limit operating mode changes to required authenticated users only.Physical mechanisms (e.g., keys) can also be used to prevent unauthorized operating mode changes.Implement device management systemsthat can authenticate all network messages to prevent unauthorized system changes.Ensure all field controllers require users to authenticate for all management sessions.Use host-based allowlists to prevent devices from accepting connections from unauthorized systems and ensure they can only connect with known workstations.Implement network intrusion detection and prevention systemswhenever possible to identify malicious activity.Use this to monitor for logon activity for unexpected or unusual access to devices from the internet.[11]Retain cold-standby or replacement hardware of similar modelsto ensure continued operations of critical functions if the primary system is compromised or unavailable [CPG 2.R].[12]Create and test strong backups of the logic and configurations of PLCs to enable fast recovery.Utilize watchdog timers,when possible, to enable quick detection of unresponsive systems.Monitor asset management systems for device configuration changes,which can be used to understand expected parameter settings.Monitor the content of network traffic for the following:Unusual logins to internet-connected devices or unexpected protocols to/from the internet.Functions of ICS management protocols that change an asset’s operating mode or modify programs.Unexpected protocols connected to ports that are mismatched with the protocols that would normally connect to these ports.[11] Block all non-used high ephemeral ports and monitor for attempted connections using standard protocols on non-standard ports [CPG 2.V]. (Update End) In addition, the authoring agencies recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, as well as reduce the impact and risk of compromise by cyber threat actors: Reduce risk exposure.CISA offers a range of services at no cost, including scanning and testing, to help organizations reduce exposure to threats via mitigating attack vectors.CISA Cyber Hygieneservices can help provide additional review of organizations’ internet accessible assets. Emailvulnerability@cisa.dhs.govwith the subject line “Requesting Cyber Hygiene Services” to get started.(Updated Dec. 18, 2024)U.K. organizations can sign up for the freeNCSC Early Warning serviceto receive email alerts tailored to the cyber threat for your organization’s IP address.(End Update) DEVICE MANUFACTURERS Although critical infrastructure organizations using Unitronics (including rebranded Unitronics) PLC devices can take steps to mitigate the risks, it is ultimately the responsibility of the device manufacturer to build products that are secure by design and default. The authoring agencies urge device manufacturers to take ownership of their customers’ security outcomes by following the principles in the joint guideShifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software, primarily: Do not ship products with default passwords; instead, either ship products with random initial passwords or require users to change the password upon first use.(Updated Dec. 18, 2024)Change the manufacturers’ default settings to prevent exposing administrative interfaces to the internet.(End Update)Do not charge additional fees for basic security features needed to operate the product securely.Support multifactor authentication, including via phishing-resistant methods. By using secure by design tactics, software manufacturers can make product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing tiered security software and logs, monitoring, and making routine updates. For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisoryNSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations. For more information on secure by design, see CISA’sSecure by Designwebpage and joint guide."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a,"MITIGATIONS These mitigations apply to all critical infrastructure organizations and network defenders using Citrix NetScaler ADC and Gateway software. CISA and authoring organizations recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of exploitation such as threat actors leveraging unpatched vulnerabilities within Citrix NetScaler appliances, which strengthens the security posture of their customers. For more information on secure by design, see CISA’sSecure by Design and Defaultwebpage andjoint guide. The authoring organizations of this CSA recommend organizations implement the mitigations below to improve your cybersecurity posture on the basis of the threat actor activity and to reduce the risk of compromise associated with Citrix CVE 2023-4966 and LockBit 3.0 ransomware & ransomware affiliates. These mitigations align with the Cross-Sector Cybersecurity performance goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Isolate NetScaler ADC and Gateway appliancesfor testing until patching is ready and deployable.Secure remote access tools by:Implement application controlsto manage and control the execution of software, including allowlisting remote access programs. Application controls should prevent the installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Applyphishing-resistant multifactor authentication (MFA).Log RDP login attempts.Restrict the use of PowerShell, using Group Policy, and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [CPG 2.E].Update Windows PowerShell or PowerShell Coreto the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E, 2.S, 2.T].Enable enhanced PowerShell logging[CPG 2.T, 2.U].PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor’s PowerShell use.Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operationsrequiring administrator privileges to reduce the risk of lateral movement by PsExec.Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts) to comply withNIST's standardsfor developing and managing password policies.Use longer passwords consisting of at least 15 characters [CPG 2.B].Store passwords in hashed format using industry-recognized password managers.Add password user “salts” to shared login credentials.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.""Require administrator credentials to install software.Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Upgrade vulnerable NetScaler ADC and Gateway appliances to the latest version available to lower the risk of compromise."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-320a,"MITIGATIONS These mitigations apply to all critical infrastructure organizations and network defenders. The FBI and CISA recommend that software manufactures incorporate secure-by-design and -default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the secure posture for their customers. For more information on secure by design, see CISA’sSecure by Design and Defaultwebpage andjoint guide. The FBI and CISA recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on the threat actor activity and to reduce the risk of compromise by Scattered Spider threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Implement application controlsto manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.Reduce threat of malicious actorsusing remote access tools by:Auditing remote access toolson your network to identify currently used and/or authorized software.Reviewing logs for execution of remote access softwareto detect abnormal use of programs running as a portable executable [CPG 2.T].Using security softwareto detect instances of remote access software being loaded only in memory.Requiring authorized remote access solutionsto be used only from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).Blocking both inbound and outbound connectionson common remote access software ports and protocols at the network perimeter.Applying recommendationsin theGuide to Securing Remote Access Software.Implementing FIDO/WebAuthn authentication or Public Key Infrastructure (PKI)-based MFA. These MFA implementations are resistant to phishing and not suspectable to push bombing or SIM swap attacks, which are techniques known to be used by Scattered Spider actors. See CISA’s fact sheetImplementing Phishing-Resistant MFAfor more information.Strictly limit the use of Remote Desktop Protocol (RDP) and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Apply phishing-resistant multifactor authentication (MFA).Log RDP login attempts. In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors: Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).Maintain offline backups of dataand regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices [CPG 2.R].Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts)to complywithNIST's standardsfor developing and managing password policies.Implement password policies in compliance with NIST’s standards.Use “strong” passwords that are unique and random, as well as contain at least sixteen characters and no more than 64 characters in length [CPG 2.B].Consider implementing industry-recognized password managers that align with organizational technology procurement policies.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring recurring password changes.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Require phishing-resistant multifactor authentication (MFA)for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems [CPG 2.H].Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Disable unusedports and protocols[CPG 2.V].Consider adding an email banner to emailsreceived from outside your organization [CPG 2.M].Disable hyperlinksin received emails.Ensure all backup data is encrypted, immutable(i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a,"MITIGATIONS These mitigations apply to all organizations using non-cloud Atlassian Confluence Data Center and Server software. CISA, FBI, and MS-ISAC recommend that software manufacturers incorporate secure by design and default principles and tactics into their software development practices to reduce the prevalence of Broken Access Control vulnerabilities, thus strengthening the secure posture for their customers. For more information on secure by design, see CISA’sSecure by Design and Defaultwebpage andjoint guide. As of October 10, 2023, proof-of-concept exploits for CVE-2023-22515 have been observed in open source publications.[5] While there are immediate concerns such as increased risk of exploitation and the potential integration into malware toolkits, the availability of a proof-of-concept presents an array of security and operational challenges that extend beyond these immediate issues. Immediate action is strongly advised to address the potential risks associated with this development. CISA, FBI, and MS-ISAC recommend taking immediate action to address the potential associated risks and encourage organizations to: Immediately upgrade to fixed versions.See Atlassian’s upgrading instructions[6] for more information. If unable to immediately apply upgrades,restrict untrusted network access until feasible. Malicious cyber threat actors who exploit the affected instance can escalate to administrative privileges.Follow best cybersecurity practices in your production and enterprise environments.While not observed in this instance of exploitation, mandatingphishing-resistant multifactor authentication (MFA)for all staff and services can make it more difficult for threat actors to gain access to networks and information systems. For additional best practices, see:CISA’sCross-Sector Cybersecurity Performance Goals(CPGs).The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common tactics, techniques, and procedures (TTPs). Because the CPGs are a subset of best practices, CISA recommends software manufacturers implement a comprehensive information security program based on a recognized framework, such as the NIST Cybersecurity Framework (CSF).Center for Internet Security’s (CIS)Critical Security Controls.The CIS Critical Security Controls are a prescriptive, prioritized, and simplified set of best practices that organizations can use to strengthen cybersecurity posture and protect against cyber incidents."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-284a,"MITIGATIONS These mitigations apply to all critical infrastructure organizations and network defenders. The FBI and CISA recommend that software manufactures incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of ransomware techniques (such as threat actors leveraging backdoor vulnerabilities into remote software systems), thus, strengthening the secure posture for their customers. For more information on secure by design, see CISA’sSecure by Design and Defaultwebpage andjoint guide. FBI and CISA recommend organizations implement the mitigations below to improve your cybersecurity posture on the basis of the threat actor activity and to reduce the risk of compromise by AvosLocker ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Secure remote access tools by:Implementing application controlsto manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.Applying recommendations in CISA's jointGuide to Securing Remote Access Software.Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Applyphishing-resistant multifactor authentication (MFA).Log RDP login attempts.Disable command-line and scripting activities and permissions[CPG 2.N].Restrict the use of PowerShell, using Group Policy, and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [CPG 2.E].Update Windows PowerShell or PowerShell Coreto the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E, 2.S, 2.T].Enable enhanced PowerShell logging[CPG 2.T, 2.U].PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor’s PowerShell use.Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible. Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operationsrequiring administrator privileges to reduce the risk of lateral movement by PsExec. In addition, FBI and CISA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the impact and risk of compromise by ransomware or data extortion actors: Disable File and Printer sharing services.If these services are required, use strong passwords or Active Directory authentication.Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).Maintain offline backups of data,and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization minimizes the impact of disruption to business practices as they will not be as severe and/or only have irretrievable data [CPG 2.R]. Recommend organizations follow the 3-2-1 backup strategy in which organizations have three copies of data (one copy of production data and two backup copies) on two different media such as disk and tape, with one copy kept off-site for disaster recovery.Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts)to complywithNIST's standardsfor developing and managing password policies.Use longer passwords consisting of at least 15 characters [CPG 2.B].Store passwords in hashed format using industry-recognized password managers.Add password user “salts” to shared login credentials.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Require phishing-resistant multifactor authenticationfor all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [CPG 2.H].Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks, restricting further lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections, as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Disable unusedports[CPG 2.V].Consider adding an email banner to emailsreceived from outside your organization [CPG 2.M].Ensure all backup data is encrypted, immutable(i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a,"MITIGATIONS NETWORK DEFENDERS NSA and CISA recommend network defenders implement the recommendations that follow to mitigate the issues identified in this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST) as well as with theMITRE ATT&CK Enterprise MitigationsandMITRE D3FENDframeworks. The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections.[24] SOFTWARE MANUFACTURERS NSA and CISA recommend software manufacturers implement the recommendations in Table 11 to reduce the prevalence of misconfigurations identified in this advisory. These mitigations align with tactics provided in joint guideShifting the Balance of Cybersecurity Risk: Principles and Approaches for Security-by-Design and -Default. NSA and CISA strongly encourage software manufacturers apply these recommendations to ensure their products are secure “out of the box” and do not require customers to spend additional resources making configuration changes, performing monitoring, and conducting routine updates to keep their systems secure.[1]"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-263a,"MITIGATIONS The FBI and CISA recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture on the basis of the Snatch threat actor’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Reduce threat of malicious actorsusing remote access tools by:Auditing remote access toolson your network to identify currently used and/or authorized software.Reviewing logs for execution of remote access softwareto detect abnormal use of programs running as a portable executable [CPG 2.T].Using security softwareto detect instances of remote access software being loaded only in memory.Requiring authorized remote access solutionsto be used only from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).Blocking both inbound and outbound connectionson common remote access software ports and protocols at the network perimeter.Implement application controlsto manage and control execution of software, including allowlisting remote access programs.Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Apply phishing-resistant multifactor authentication (MFA).Log RDP login attempts.Disable command-line and scriptingactivities and permissions [CPG 2.N].Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts [CPG 4.C].Audit user accounts with administrative privilegesand configure access controls according to the principle of least privilege (PoLP) [CPG 2.E].Reduce the threat of credential compromisevia the following:Place domain admin accounts in the protected users’ groupto prevent caching of password hashes locally.Refrain from storing plaintext credentials in scripts.Implement time-based access for accountsset at the admin level and higher [CPG 2.A, 2.E]. In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors: Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).Maintain offline backups of dataand regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices [CPG 2.R].Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts)to complywithNIST's standardsfor developing and managing password policies.Use longer passwords consisting of at least eight characters and no more than 64 characters in length [CPG 2.B].Store passwords in hashed format using industry-recognized password managers.Add password user “salts” to shared login credentials.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Require phishing-resistant multifactor authentication (MFA)for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems [CPG 2.H].Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Disable unusedports and protocols[CPG 2.V].Consider adding an email banner to emailsreceived from outside your organization [CPG 2.M].Disable hyperlinksin received emails.Ensure all backup data is encrypted, immutable(i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-250a,"MITIGATIONS Note:These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. MANAGE VULNERABILITIES AND CONFIGURATIONS [CPG 1.E, CPG 3.A] CISA and co-sealers identified that exploitation of CVE-2022-47966 granted initial access to the public-facing application, Zoho ManageEngine ServiceDesk Plus. Multiple Zoho ManageEngine on-premises products, such as ServiceDesk Plus through 14003, allow remote code execution due to use of version 1.4.1 of Apache XML Security for Java (also known as xmlsec) from the Apache Santuario project. Due to the xmlsec XSLT features by design in that version, the application is responsible for certain security protections. CISA and co-sealers recommend the following: Document device configurations[CPG 2.O].Organizations should maintain updated documentation describing the current configuration details of all critical IT assets (and OT, where applicable), as this facilitates more effective vulnerability and response activities.Keep all software up to date and patch systems for known exploited vulnerabilities.In places with known exploited vulnerabilities on an endpoint device (e.g., firewall security appliances), conduct investigation prior to patching [CPG 1.E].Follow a routine patching cycle[M1051] for all operating systems, applications, and software (including all third-party software) to mitigate the potential for exploitation.Prioritize remediation of vulnerabilities on internet-facing systems,for example, by conducting continuous automated and/or routine vulnerability scans [M1016]. CISA offers a range of services at no cost, including scanning and testing to help organizations reduce exposure to threats via mitigating attack vectors. Specifically,Cyber Hygieneservices can help provide a second-set of eyes on organizations' internet-accessible assets. Organizations can emailvulnerability@cisa.dhs.govwith the subject line, “Requesting Cyber Hygiene Services” to get started. For additional guidance on remediating these vulnerabilities, seeCISA Insights - Remediate Vulnerabilities for Internet-Accessible Systems.Deploy security.txt files[CPG 4.C].All public-facing web domains have a security.txt file that conforms to the recommendations in RFC 9116.[9] SEGMENT NETWORKS [CPG 2.F] CISA and co-sealers identified that the organization did not employ proper network segmentation, such as a demilitarized zone (DMZ), during the initial discovery phase of the incident response. A DMZ serves as a perimeter network that protects and adds an extra layer of security to an organization’s internal local area network (LAN) from untrusted traffic. Employ proper network segmentation, such as a DMZ,and ensure to address the following recommendations.Note:The end goal of a DMZ network is to allow an organization to access untrusted networks, such as the internet, while ensuring its private network or LAN remains secure. Organizations typically store external-facing services and resources, as well as servers for DNS, File Transfer Protocol (FTP), mail, proxy, Voice over Internet Protocol (VoIP), and web servers in the DMZ [CPG 2.K,CPG 2.W].Limit internet-facing port exposure for critical resources in the DMZ networks.Limit exposed ports to only required IP addresses and avoid placing wildcards in destination port or host entries.Ensure unsecured protocols like FTP and HTTP are limited in use and restricted to specific IP ranges.If data flows from untrusted zone to trusted zone, ensure it is conducted over a secure protocol like HTTPS with mandatory multi-factor authentication.Use a firewall or web-application firewall (WAF) and enable loggingto prevent/detect potential exploitation attempts [M1050]. Review ingress and egress firewall rules and block all unapproved protocols. Limit risky (but approved) protocols through rules.Use WAF to limit exposure to just approved ports, as well as monitor file changes in web directories.Implement network segmentation to separate network segments based on role and functionality.Proper network segmentation significantly reduces the ability for threat actor lateral movement by controlling traffic flows between—and access to—various subnetworks. See CISA’sLayering Network Security Through Segmentationinfographic and the National Security Agency’s (NSA’s)Segment Networks and Deploy Application-Aware Defenses. MANAGE ACCOUNTS, PERMISSIONS, AND WORKSTATIONS APT actors were able to leverage disabled administrative accounts, as well as clear logs on several critical servers, which prevented the ability to detect follow-on exploitation or data exfiltration. CISA and co-sealers recommend the following: Use phishing-resistant multi-factor authentication (MFA)[CPG 2.H] (e.g., security tokens) for remote access and access to any sensitive data repositories. Implement phishing-resistant MFA for as many services possible—particularly for webmail and VPNs—for accounts that access critical systems and privileged accounts that manage backups.MFA should also be used for remote logins [M1032]. For additional guidance on secure MFA configurations, visitcisa.gov/MFAand CISA’sImplementing Phishing-Resistant MFAFactsheet.Employ strong password managementalongside other attribute-based information, such as device information, time of access, user history, and geolocation data. Set a password policy to require complex passwords for all users (minimum of 16 characters) and enforce this new requirement as users’ passwords expire [CPG 2.A,CPG 2.B,CPG 2.C].Implement the principle of least privilegeto decrease threat actors’ abilities to access key network resources.Limit the ability of a local administrator account to log in from a local interactive session[CPG 2.E] (e.g., “Deny access to this computer from the network”) and prevent access via an RDP session.Establish policy and procedure for the prompt removal of unnecessary (disabled) accountsand groups from the enterprise that are no longer needed, especially privileged accounts. Implement and enforce use of Local Administrator Password Solution (LAPS).Control and limit local administration,ensuring administrative users do not have access to other systems outside of the local machine and across the domain.Create a change control processfor all privilege escalations and role changes on user accounts. Enable alerts on privilege escalations and role changes, as well as log privileged user changes in the network environment and create alerts for abnormal events.Create and deploy a secure system baseline image to all workstations.See Microsoft’s guidance onUsing Security Baselines in Your Organization.Implement policies to block workstation-to-workstation RDP connections[CPG 2.V] through a Group Policy Object on Windows, or by a similar mechanism. The RDP service should be disabled if it is unnecessary [M1042]. SECURE REMOTE ACCESS SOFTWARE Remote access software provides a proactive and flexible approach for organizations to internally oversee networks, computers, and other devices; however, cyber threat actors increasingly co-opt these tools for access to victim systems. APT actors were observed using legitimate remote access tools—ConnectWise ScreenConnectandAnyDesk—to connect to victim hosts within the organization’s environment and further conduct malicious operations. CISA and co-sealers recommend the following: Establish a software behavior baselineto detect anomalies in behavior [CPG 2.T,CPG 2.U].Monitor for unauthorized use of remote access softwareusing endpoint detection tools. For more information, see CISA’s jointGuide to Securing Remote Access Softwareon best practices for using remote capabilities and how to detect and defend against malicious actors abusing this software. OTHER BEST PRACTICE MITIGATION RECOMMENDATIONS Use application allowlistson domain controllers, administrative hosts, and other sensitive systems. Following exploitation of the public-facing application (Zoho ManageEngine ServiceDesk Plus), APT actors were able to download and execute multiple files on the system, which were then utilized to enumerate the network and perform reconnaissance operations.Use directory allowlistingrather than attempting to list every possible permutation of applications in a network environment. Safe defaults allow applications to run fromPROGRAMFILES,PROGRAMFILES(X86), andSYSTEM32. Disallow all other locations unless an exception is granted and documented. Application directory allowlisting can be enabled through Microsoft Software Restriction Policy or AppLocker and can prevent the execution of unauthorized software.Audit scheduled tasks and validate all findingsvia a Group Policy Object (GPO) or endpoint detection and response (EDR) solution.Follow Microsoft’sBest Practices for Securing Active Directory.Review NSA’sNetwork Infrastructure Security Guide."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-242a,"MITIGATIONS Note:For situational awareness, the following SHA-256 hash is associated with FBI’s QakBot uninstaller:7cdee5a583eacf24b1f142413aabb4e556ccf4ef3a4764ad084c1526cc90e117 CISA and FBI recommend network defenders apply the following mitigations to reduce the likelihood of QakBot-related activity and promote identification of QakBot-induced ransomware and malware infections. Disruption of the QakBot botnet does not mitigate other already-installed malware or ransomware on victim computers.Note:These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. BEST PRACTICE MITIGATION RECOMMENDATIONS Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud) [CPG 2.O, 2.R, 5.A].Require all accountswith password logins (e.g., service accounts, admin accounts, and domain admin accounts) to comply withNIST’s standardswhen developing and managing password policies [CPG 2.B]. This includes:Use longer passwords consisting of at least 8 characters and no more than 64 characters in length;Store passwords in hashed format using industry-recognized password managers;Add password user “salts” to shared login credentials;Avoid reusing passwords;Implement multiple failed login attempt account lockouts;Disable password “hints”;Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Use phishing-resistant multi-factor authentication (MFA)[CPG 2.H] (e.g., security tokens) for remote access and access to any sensitive data repositories. Implement phishing-resistant MFA for as many services as possible—particularly for webmail and VPNs—for accounts that access critical systems and privileged accounts that manage backups.MFA should also be used for remote logins. For additional guidance on secure MFA configurations, visitcisa.gov/MFAand CISA’sImplementing Phishing-Resistant MFAFactsheet.Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patchingknown exploited vulnerabilitiesof internet-facing systems [CPG 1.E]. CISA offers a range of services at no cost, including scanning and testing to help organizations reduce exposure to threats via mitigating attack vectors. Specifically,Cyber Hygieneservices can help provide a second-set of eyes on organizations’ internet-accessible assets. Organizations can emailvulnerability@cisa.dhs.govwith the subject line, “Requesting Cyber Hygiene Services” to get started.Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks to restrict adversary lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated malware with a networking monitoring tool.To aid in detecting the malware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts.Audit user accountswith administrative privileges and configure access controls according to the principle of least privilege [CPG 2.D, 2.E].Disable unusedports[CPG 2.V, 2.W, 2X].Consider adding an email banner to emailsreceived from outside your organization.Disable hyperlinksin received emails.Implement time-based access for accounts set at the admin level and higher.For example, the Just-in-Time access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as theZero Trustmodel). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task [CPG 2.E].Disable command-line and scripting activities and permissions.Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.Perform regular secure system backupsand create known good copies of all device configurations for repairs and/or restoration. Store copies off-network in physically secure locations and test regularly [CPG 2.R].Ensure all backup data is encrypted, immutable(i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure. RANSOMWARE GUIDANCE CISA.gov/stopransomwareis a whole-of-government resource that serves as one central location for ransomware resources and alerts.CISA, FBI, the National Security Agency (NSA), and Multi-State Information Sharing and Analysis Center (MS-ISAC) published an updated version of the#StopRansomware Guide, as ransomware actors have accelerated their tactics and techniques since its initial release in 2020.CISA has released a new module in its Cyber Security Evaluation Tool (CSET), theRansomware Readiness Assessment (RRA). CSET is a desktop software tool that guides network defenders through a step-by-step process to evaluate cybersecurity practices on their networks."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-215a,"MITIGATIONS VENDORS AND DEVELOPERS The authoring agencies recommend vendors and developers take the following steps to ensure their products are secure by design and default: Identify repeatedly exploited classes of vulnerability.Perform an analysis of both CVEs and known exploited vulnerabilities to understand which classes of vulnerability are identified more than others. Implement appropriate mitigations to eliminate those classes of vulnerability. For example, if a product has several instances of SQL injection vulnerabilities, ensure all database queries in the product use parameterized queries, and prohibit other forms of queries.Ensure business leaders are responsible for security.Business leaders should ensure that proactive steps to eliminate entire classes of security vulnerabilities, rather than only making one-off patches when new vulnerabilities are discovered.Follow the SSDF(SP 800-218)and implement secure design practices into each stage of the SDLC. Pay attention to:Prioritizing the use of memory safe languages wherever possible [SSDF PW 6.1].Exercising due diligence when selecting software components (e.g., software libraries, modules, middleware, frameworks) to ensure robust security in consumer software products [SSDF PW 4.1].Setting up secure development team practices; this includes conducting peer code reviews, working to a common organization secure coding standard, and maintaining awareness of language specific security concerns [SSDF PW.5.1, PW.7.1, PW.7.2].Establishing avulnerability disclosure programto verify and resolve security vulnerabilities disclosed by people who may be internal or external to the organization [SSDF RV.1.3]. As part of this, establish processes to determine root causes of discovered vulnerabilities.Using static and dynamic application security testing (SAST/DAST) tools to analyze product source code and application behavior to detect error-prone practices [SSDF PW.7.2, PW.8.2].Configuring production-ready products to have to most secure settings as default and providing guidance on the risks of changing each setting [SSDF PW.9.1, PW9.2]Prioritize secure-by-default configurationssuch as eliminating default passwords, implementing single sign on (SSO) technology via modern open standards, and providing high-quality audit logs to customers with no additional configuration and at no extra charge.Ensure published CVEs include the proper CWE field identifying the root cause of the vulnerabilityto enable industry-wide analysis of software security and design flaws. For more information on designing secure-by-design and -default products, including additional recommended secure-by-default configurations, see joint guideShifting the Balance of Cybersecurity Risk: Principles and Approaches for Security-by-Design and -Default. END-USER ORGANIZATIONS The authoring agencies recommend end-user organizations implement the mitigations below to improve cybersecurity posture on the basis of the threat actors’ activity. These mitigations align with the cross-sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on CPGs, including additional recommended baseline protections. VULNERABILITY AND CONFIGURATION MANAGEMENT Update software, operating systems, applications, and firmware on IT network assets in a timely manner[CPG 1.E]. Prioritize patchingknown exploited vulnerabilities, especially those CVEs identified in this CSA, then critical and high vulnerabilities that allow for remote code execution or denial-of-service on internet-facing equipment. For patch information on CVEs identified in this CSA, refer to the appendix.If a patch for a known exploited or critical vulnerability cannot be quickly applied, implement vendor-approved workarounds.Replace end-of-life software (i.e., software no longer supported by the vendor).Routinely perform automated asset discoveryacross the entire estate to identify and catalogue all the systems, services, hardware and software.Implement a robust patch management processand centralized patch management system that establishes prioritization of patch applications [CPG 1.A].Organizations that are unable to perform rapid scanning and patching of internet-facing systems should consider moving these services to mature, reputable cloud service providers (CSPs) or other managed service providers (MSPs). Reputable MSPs can patch applications—such as webmail, file storage, file sharing, and chat and other employee collaboration tools—for their customers. However, MSPs and CSPs can expand their customer’s attack surface and may introduce unanticipated risks, so organizations should proactively collaborate with their MSPs and CSPs to jointly reduce risk [CPG 1.F]. For more information and guidance, see the following resources.CISA InsightsRisk Considerations for Managed Service Provider CustomersCISA InsightsMitigations and Hardening Guidance for MSPs and Small- and Mid-sized BusinessesACSC advice onHow to Manage Your Security When Engaging a Managed Service ProviderDocument secure baseline configurations for all IT/OT components, including cloud infrastructure. Monitor, examine, and document any deviations from the initial secure baseline [CPG 2.O].Perform regular secure system backupsand create known good copies of all device configurations for repairs and/or restoration. Store copies off-network in physically secure locations and test regularly [CPG 2.R].Maintain an updated cybersecurity incident response planthat is tested at least annually and updated within a risk informed time frame to ensure its effectiveness [CPG 2.S]. IDENTITY AND ACCESS MANAGEMENT Enforce phishing-resistant multifactor authentication (MFA) for all users, without exception. [CPG 2.H].Enforce MFA on all VPN connections. If MFA is unavailable, require employees engaging in remote work to use strong passwords [CPG 2.A, 2.B, 2.C, 2.D, 2.G].Regularly review, validate, or remove privileged accounts(annually at a minimum) [CPG 2.D, 2.E].Configure access control under the principle of least privilege[CPG 2.Q].Ensure software service accounts only provide necessary permissions (least privilege) to perform intended functions (using non-administrative privileges where feasible).Note:See CISA’sCapacity Enhancement Guide – Implementing Strong Authenticationand ACSC’s guidance onImplementing Multi-Factor Authenticationfor more information on authentication system hardening. PROTECTIVE CONTROLS AND ARCHITECTURE Properly configure and secure internet-facing network devices, disable unused or unnecessary network ports and protocols, encrypt network traffic, and disable unused network services and devices [CPG 2.V, 2.W, 2X].Harden commonly exploited enterprise network services, including Link-Local Multicast Name Resolution (LLMNR) protocol, Remote Desktop Protocol (RDP), Common Internet File System (CIFS), Active Directory, and OpenLDAP.Manage Windows Key Distribution Center (KDC) accounts (e.g., KRBTGT) to minimize Golden Ticket attacks and Kerberoasting.Strictly control the use of native scripting applications, such as command-line, PowerShell, WinRM, Windows Management Instrumentation (WMI), and Distributed Component Object Model (DCOM).Implement Zero Trust Network Architecture (ZTNA)to limit or block lateral movement by controlling access to applications, devices, and databases. Use private virtual local area networks [CPG 2.F, 2.X].Note:See the Department of Defense’sZero Trust Reference Architecturefor additional information on Zero Trust.Continuously monitor the attack surfaceand investigate abnormal activity that may indicate cyber actor or malware lateral movement [CPG 2.T].Use security tools, such as endpoint detection and response (EDR) and security information and event management (SIEM) tools. Consider using an information technology asset management (ITAM) solution to ensure EDR, SIEM, vulnerability scanner, and other similar tools are reporting the same number of assets [CPG 2.T, 2.V].Use web application firewalls to monitor and filter web traffic. These tools are commercially available via hardware, software, and cloud-based solutions, and may detect and mitigate exploitation attempts where a cyber actor sends a malicious web request to an unpatched device [CPG 2.B, 2.F].Implement an administrative policy and/or automated process configured to monitor unwanted hardware, software, or programs against an allowlist with specified approved versions [CPG 2.Q].Use a network protocol analyzer to examine captured data, including packet-level data. SUPPLY CHAIN SECURITY Reduce third-party applications and unique system/application builds—provide exceptions only if required to support business critical functions [CPG 2.Q].Ensure contracts require vendors and/or third-party service providers to:Provide notification of security incidents and vulnerabilities within a risk informed time frame [CPG 1.G, 1.H, 1.I].Supply a Software Bill of Materials (SBOM) with all products to enhance vulnerability monitoring and to help reduce time to respond to identified vulnerabilities [CPG 4.B].Ask your software providers to discuss their secure by design programand to provide links to information about how they are working to remove classes of vulnerabilities, and to set secure default settings."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-213a,"MITIGATIONS CISA and NCSC-NO recommend organizations: Upgrade Ivanti EPMM versions to the latest versionas soon as possible. SeeIvanti CVE-2023-35081 - Remote Arbitrary File Writefor patch information. This patch protects against CVE-2023-35078 and CVE-2023-35081.See the Evidence of Vulnerability Methods section of this advisory for CISA-developed nuclei templates to find any EPMM versions vulnerable to CVE-2023-35078 and CVE-2023-35081.Organizations using unsupported versions (i.e., versions prior to 11.8.1.0) should immediately upgrade to a supported version. If you cannot immediately upgrade, apply the Ivanti-provided RPM fix for CVE-35078 (this workaround does not protect against CVE-2023-35081):Login to command line shell (CLI) in enable mode.Run the following command:# install rpm url https://support.mobileiron.com/ivanti-updates/ivanti-security-update-1.0.0-1.noarch.rpSee Ivanti’sKnowledge Base (KB) Remote unauthenticated API access vulnerability - CVE-2023-35078for more information on the RPM fix.Treat MDM systems as high-value assets (HVAs) with additional restrictions and monitoring. MDM systems provide elevated access to thousands of hosts and should be treated as high value assets (HVAs) with additional restrictions and monitoring.Follow best cybersecurity practicesin production and enterprise environments, including mandatingphishing-resistant multifactor authentication (MFA)for all staff and services. For additional best practices, see CISA’sCross-Sector Cybersecurity Performance Goals(CPGs). The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common TTPs. Because the CPGs are a subset of best practices, CISA and NCSC-NO also recommend software manufacturers implement a comprehensive information security program based on a recognized framework, such as the NIST Cybersecurity Framework (CSF)."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-208a,"MITIGATIONS VENDORS AND DEVELOPERS ACSC, CISA, and NSA recommend that vendors, designers, and implementors of web applications—including organizations that build and deploy software (such as HR tools) for their internal use and organizations that create open-source projects—implement the following mitigations. These mitigations may reduce prevalence of IDOR vulnerabilities in software and help ensure products are secure-by-design and -default. Implement and injectsecure-by-design and -default principlesand best practices into each stage of the software development life cycle (SDLC). Particular recommended practices are defined in the National Institute of Security and Technology’s (NIST’s) Secure Software Development Framework (SSDF),SP 800-218. Lend special attention to:Conducting code reviews[SSDF PW 7.2, RV 1.2] against peer coding standards, checking for backdoors, malicious content, or logic flaws.ACSC, CISA, and NSA recommend using automated code analysis tools for all supported releases to identify and remediate vulnerabilities.Following secure coding practices[SSDF PW 5.1] for web and mobile applications to ensure that they properly validate user input and generate strong user IDs.Use indirect reference maps, such that IDs, names, and keys are not exposed in URLs. Replace them with cryptographically strong, random values—specifically use a UUID or a GUID.Note:UUIDs and GUIDs should not be used for security capabilities. SeeRequest for Comment (RFC) 4122for more information.Configure applications to deny access by default and ensure the application performs authentication and authorization checksfor every request to modify data, delete data, and access sensitive data. For example:Normalize requests. There are many ways to encode and decode web inputs. Decode and normalize inputs before creating access control checkpoints. Ensure the access control system and other parts of the web application perform the same normalization.Implement parameter verificationleveraging syntactic and logical validation, such that web applications validate all inputs received with every HTTP/S request. Denying invalid requests can reduce the burden on the access control system.Syntactic validation verifies that for each input the incoming value meets your applications’ expectations. When doing syntactic validation, verify that strings are within the minimum and maximum length required, strings do not contain unacceptable characters, numeric values are within the minimum and maximum boundaries, and the input is of the proper data type.Logical validation adds checks to see if the input values make sense and are consistent with design intent. When doing logical validation, verify authorization checks are performed in the correct locations, are of varying pedigree, and that there is error handling of failed authentication and authorization requests.Use CAPTCHA to limit automated invalid user requestswhere feasible.Use memory-safe programming languageswhere possible.Testing codeto identify vulnerabilities and verify compliance with security requirements [SSDF PW 8.2].Use automated testing tools to facilitate testing,fuzz testingtools to find issues with input handling,[8] and penetration testing to simulate how a threat actor may exploit the software. Consider using dynamic application security testing (DAST) tools to identify IDOR vulnerabilities in web applications.Conducting role-based training[SSDF PO 2.2] for personnel responsible for secure software development.Exercising due diligence when selecting third-party libraries or frameworksto incorporate into your application [SSDF PW 4.1].Review and evaluate third-party components in the context of their expected use.Verify the integrity of the product through hash or signature verification.If provided, review component’sSoftware Bill of Materials (SBOM)for outdated, vulnerable, or unauthorized applications before using it.Keep all third-party frameworks and dependencies up to date to limit vulnerability inheritance.Note:Organizations should maintain an inventory or catalog of third-party frameworks and dependencies to assist with proactive updates. Consider using tools to identify project dependencies and known vulnerabilities in third-party code. See OWASP’s Top Ten Proactive Controls 2018,C2: Leverage Security Frameworks and Libraries, for more information.For more information, see the joint Enduring Security Framework’s Securing the Software Supply Chain:Recommended Practices Guide for Developers, CISA’sSupply Chain Risk Management Essentials, and ACSC’sCyber Supply Chain Risk Management.Establish avulnerability disclosure programto verify and resolve security vulnerabilities disclosed by people who may be internal or external to the organization. Additionally, ACSC, CISA, and NSA recommendfollowing cybersecurity best practicesin production and enterprise environments. Software developers are high-value targets because their customers deploy software on their own trusted networks. For best practices, see: ACSC’sEssential Eight. The Essential Eight are prioritized strategies to help cybersecurity professionals mitigate cybersecurity incidents caused by various cyber threats.CISA’sCross-Sector Cybersecurity Performance Goals(CPGs). The CPGs, developed by CISA and NIST, are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common tactics, techniques, and procedures. Because the CPGs are a subset of best practices, ACSC, CISA, and NSA also recommend software manufacturers implement a comprehensive information security program based on a recognized framework, such as theNIST Cybersecurity Framework (CSF).NSA’sTop Ten Cybersecurity Mitigations. The Top Ten sets priorities for enterprise activities to counter a broad range of exploitation techniques and minimize mission impact. ALL END-USER ORGANIZATIONS ACSC, CISA, and NSA recommend that all end-user organizations, including those with on-premises software, SaaS, IaaS, and private cloud models, implement the mitigations below to improve their cybersecurity posture. Exercise due diligence when selecting web applications. Follow best practices for supply chain risk management and source from reputable vendors that demonstrate commitment to secure-by-design and -default principles.Verify the integrity of the product through hash or signature verification.If provided, review theSBOMfor outdated, vulnerable, or unauthorized applications before using the product.For more information, see the Enduring Security Framework’sSecuring the Software Supply Chain: Recommended Practices Guide for Customers, CISA’sSupply Chain Risk Management Essentials, and ACSC’sCyber Supply Chain Risk Management.Apply software patches for web applicationsas soon as possible.Configure the application to log and generate alerts from tamper attempts—with this information, network defenders can investigate and take appropriate follow-on actions.Establish a baseline to efficiently identify abnormal behavior.Note:Web application error codes such asHTTP 404andHTTP 403are associated with common enumeration techniques.Aggregate logs into a centralized solution (e.g., a security information and event management [SIEM] tool) to facilitate active monitoring and threat hunting.Create, maintain, and exercise a basic cyber incident response plan (IRP) and associated communications plan. Plans should include response and notification procedures for data breach and cyber incidents. For more information, see:ACSC:Preparing for and Responding to Cyber IncidentsACSC:Cyber Incident Response Plan - GuidanceACSC:Cyber Incident Response Readiness ChecklistOffice of the Australian Information Commissioner (OAIC):Data Breach Preparation and ResponseOIAC:Data Breach Response PlanCISA:Incident Response Plan BasicsCISA:Federal Government Cybersecurity Incident and Vulnerability Response Playbook(Although tailored to U.S. Federal Civilian Branch (FCEB) agencies, these playbooks provide operational procedures for planning and conducting cybersecurity incident and vulnerability response activities and detail steps for both incident and vulnerability response.)CISA:Protecting Sensitive and Personal Information from Ransomware-Caused Data Breaches Additionally, ACSC, CISA, and NSA recommendfollowing cybersecurity practices. For best practices, see ACSC’sEssential Eight, CISA’sCPGs, and NSA’s Top Ten Cybersecurity Mitigation Strategies. END-USER ORGANIZATIONS WITH ON-PREMISES SOFTWARE, IAAS, OR PRIVATE CLOUD MODELS ACSC, CISA, and NSA recommend that organizations: Conduct regular, proactive penetration testingto ensure network boundaries, as well as web applications, are secure. Prioritize web applications that are internet-facing and contain user login functionality. Such testing may be beyond the technical or financial capabilities of some organizations. Consider using a trusted third party for penetration testing to discover new attack vectors (notably prior to deployment of new or altered internet-facing services).Note:Organizations should consult with their legal counsel as appropriate to determine which systems and applications can be included in the scope of the penetration testing.Use web application penetration testing toolsto capture the user identifier sent to the web server when requesting a web page containing sensitive data and map all locations where user input is used to reference objects directly. Test with users of various privilege levels (e.g., a normal user and admin user).Use DAST and other vulnerability scannersto detect IDOR vulnerabilities. DAST tools identify vulnerabilities in web applications with penetration tests and generate automated alerts.Note:Exercise due diligence when selecting DAST tools. Not all DAST tools can detect IDOR vulnerabilities—tools with the ability may need the environment configured in a specific way and may also need custom rules in place. Sufficient DAST tools often ingest the application API documentation to build a model of the application. While these tools can be used to detect IDOR vulnerabilities, they are not foolproof and should be used with other security testing methods to ensure comprehensive coverage.Immediately report detected vulnerabilities to the vendor or developer. Alternatively (or if the vendor or developer fails to respond), report the vulnerability to CISA atcisa.gov/report.Consider establishing avulnerability disclosure programto verify, resolve, and report security vulnerabilities disclosed by people who may be internal or external to the organization.Use a web application firewall (WAF)to filter, monitor, and block malicious HTTP/S traffic traveling to the web application.Use a data loss prevention (DLP) tool toprevent unauthorized data from leaving the application. ACSC, CISA, and NSA recommend that organizations with on-premises software or IaaS consider using SaaS models for their internet-facing websites. END-USER ORGANIZATIONS WITH SAAS MODELS Organizations leveraging SaaS with sufficient resources may consider conducting penetration testing and using vulnerability scanners. However, such tests may interfere with service provider operations. Organizations should consult with their legal counsel as appropriate to determine what can be included in the scope of the penetration testing."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-201a,"MITIGATIONS CISA recommends all organizations: Install the relevant updated version of NetScaler ADC and NetScaler Gatewayas soon as possible. SeeCitrix ADC and Citrix Gateway Security Bulletin for CVE-2023-3519, CVE-2023-3466, CVE-2023-3467for patch information.Follow best cybersecurity practicesin your production and enterprise environments, including mandatingphishing-resistant multifactor authentication (MFA)for all staff and for all services. For additional best practices, see CISA’sCross-Sector Cybersecurity Performance Goals(CPGs). The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of information technology (IT) and operational technology (OT) security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common TTPs. Because the CPGs are a subset of best practices, CISA and ACSC also recommend software manufacturers implement a comprehensive information security program based on a recognized framework, such as the NIST Cybersecurity Framework (CSF).As a longer-term effort,apply robust network-segmentation controls on NetScaler appliances, and other internet-facing devices. "
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-193a,"GENERAL CLOUD MITIGATIONS All mitigation actions for this activity are the responsibility of Microsoft due to the cloud-based infrastructure affected; however, CISA and the FBI recommend that critical infrastructure organizations implement the following to harden their cloud environments. Although, these mitigations will not prevent this or related activity where actors leverage compromised consumer keys, they will reduce the impact of less sophisticated malicious activity targeting cloud environments.Note:These mitigations align with CISA’sSCuBA Technical Reference Architecture (TRA), which describes essential components of security services and capabilities to secure and harden cloud business applications, including the platforms hosting the applications. Apply CISA’s recommended baseline security configurationsfor MicrosoftDefender for Office 365,Azure Active Directory,Exchange Online,OneDrive for Business,Power BI,Power Platform,SharePoint Online, andTeams[SCuBA TRA Section 6.6].Separate administrator accounts from user accountsaccording to the National Institute of Standards and Technology’s (NIST’s) guidance,AC-5: Separation of Duties. Only allow designated administrator accounts to be used for administration purposes. If an individual user requires administrative rights over their workstation, use a separate account without administrative access to other hosts.Collect and store access and security logsfor secure cloud access (SCA) solutions, endpoint solutions, cloud applications/platforms and security services, such as firewalls, data loss prevention systems, and intrusion detection systems [SCuBA TRA Section 6.8.1].Use a telemetry hosting solution(e.g., SIEM solution) that aggregates logs and telemetry data to facilitate internal organization monitoring, auditing, alerting, and threat detection activities [SCuBA TRA Section 6.8.1].Review contractual relationships with all Cloud Service Providers (CSPs)and ensure contracts include:Security controls the customer deems appropriate.Appropriate monitoring and logging of provider-managed customer systems.Appropriate monitoring of the service provider’s presence, activities, and connections to the customer network.Notification of confirmed or suspected activity."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-187a,"MITIGATIONS CISA and the authoring organizations recommend organizations implement the below mitigations, including mandatingphishing-resistant multifactor authentication (MFA)for all staff and services. For additional best practices, see CISA’sCross-Sector Cybersecurity Performance Goals(CPGs). The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common TTPs. Because the CPGs are a subset of best practices, CISA and co-sealers recommend software manufacturers implement a comprehensive information security program based on a recognized framework, such as the NISTCybersecurity Framework(CSF). Apply patches to CVE-2022-31199Update Netwrix Auditor toversion 10.5 Netwrix recommends using their Auditor application only on internally facing networks. System owners that don't follow this recommendation, and use the application in externally facing instances, are at increased risk to having CVE-2022-31199 exploited on their systems. Reduce threat of malicious actors using remote access tools by: Implementing application controls to manage and control execution of software, including allowlisting remote access programs.Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation. See the National Security Agency’s Cybersecurity Information sheet,Enforce Signed Software Execution Policies, and additional guidance below: Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Apply phishing-resistant multifactor authentication (MFA).Log RDP login attempts.Disable command-line and scripting activities and permissions[CPG 2.N].Restrict the use of PowerShell by using Group Policy, and only grant to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [CPG 2.E].Update Windows PowerShell or PowerShell Coreto the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E, 2.S, 2.T].Enable enhanced PowerShell logging[CPG 2.T, 2.U].PowerShell logs contain valuable data, including historical OS and registry interaction and possible IOCs of a cyber threat actor’s PowerShell use.Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. The authoring organizations recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operationsrequiring administrator privileges to reduce the risk of lateral movement by PsExec.Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts [CPG 4.C].Audit user accountswith administrative privileges and configure access controls according to the principle of least privilege (PoLP) [CPG 2.E].Reduce the threat of credential compromise via the following:Place domain admin accounts in the protected users’ groupto prevent caching of password hashes locally.Implement Credential Guard for Windows 10 and Server 2016(Refer toMicrosoft: Manage Windows Defender Credential Guardfor more information). For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA).Refrain from storing plaintext credentials in scripts.Implement time-based access for accounts set at the admin level and higher[CPG 2.A, 2.E]. For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as theZero Trustmodel). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory (AD) level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task. In addition, CISA, FBI, MS-ISAC, and CCCS recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the impact and risk of compromise by ransomware or data extortion actors: Disable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).Maintain offline backups of dataand regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization minimizes the impact of disruption to business practices as they can retrieve their data [CPG 2.R].Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts)to complywithNational Institute for Standards and Technology (NIST) standardsfor developing and managing password policies.Use longer passwords consisting of at least 15 characters [CPG 2.B].Store passwords in hashed format using industry-recognized password managers.Add password user “salts” to shared login credentials.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Require phishing-resistant multifactor authenticationfor all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [CPG 2.H].Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patching known exploited vulnerabilities in internet-facing systems [CPG 1.E].Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to various subnetworks, restricting further lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections, as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Disable unused ports[CPG 2.V].Consider adding an email banner to emailsreceived from outside your organization [CPG 2.M].Ensure all backup data is encrypted, immutable(i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a,"Mitigations The authoring organizations recommend implementing the mitigations listed below to improve their cybersecurity posture to better defend against LockBit’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. The listed mitigations are ordered by MITRE ATT&CK tactic. Mitigations that apply to multiple MITRE ATT&CK tactics are listed under the tactic that occurs earliest in an incident’s lifecycle. For example, account use polices are mitigations for initial access, persistence, privilege escalation, and credential access but would be listed under initial access mitigations. INITIAL ACCESS Consider implementing sandboxed browsersto protect systems from malware originating from web browsing. Sandboxed browsers isolate the host machine from malicious code.Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts) to comply withNIST standardsfor developing and managing password policies [CPG 2.L].Enforce use of longer passwords consisting of at least 15 characters in length [CPG 2.B, 2.C].Store passwords in a salted and hashed format using industry-recognized password hashing algorithms.Prevent use of commonly used or known-compromised passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software [CPG 2.Q].Implement filters at the email gatewayto filter out emails with known malicious indicators, such as known malicious subject lines, and block suspicious IP addresses at the firewall [CPG 2.M].Install a web application firewalland configure with appropriate rules to protect enterprise assets.Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement. Isolate web-facing applications to further minimize the spread of ransomware across a network [CPG 2.F].Follow the least-privilege best practiceby requiring administrators to use administrative accounts for managing systems and use simple user accounts for non-administrative tasks [CPG 2.E].Enforce the management of and audit user accounts with administrative privileges. Configure access controls according to the principle of least privilege [CPG 2.E].Implement time-based access for accounts set at the admin level and higher.For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Public-facing applications must be patched in a timely manner as vulnerabilities can often be exploited directly by the threat actor. By closely monitoring the threat landscape, threat actors often take advantage of vulnerabilities before systems are patched. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours from when a vulnerability is disclosed. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Restrict service accounts from remotely accessing other systems.Configure group policy to Deny log on locally, Deny log on through Terminal Services, and Deny access to this computer from the network for all service accounts to limit the ability for compromised service accounts to be used for lateral movement.Block direct internet access for administration interfaces(e.g., application protocol interface (API)) and for remote access.Require phishing-resistant multifactor authentication(MFA) for all services to the extent possible, particularly for webmail, virtual private networks, and privileged accounts that access critical systems [CPG 2.H].Consolidate, monitor, and defend internet gateways.Install, regularly update, and enable real-time detection for antivirus softwareon all hosts.Raise awareness for phishing threats in your organization.Phishing is one of the primary infection vectors in ransomware campaigns, and all employees should receive practical training on the risks associated with the regular use of  email. With the rise of sophisticated phishing methods, such as using stolen email communication or artificial intelligence (AI) systems such as ChatGPT, the distinction between legitimate and malicious emails becomes more complex. This particularly applies to employees from corporate divisions that have to deal with a high volume of external email communication (e.g., staff recruitment) [CPG 2.I, 2.J].Consider adding an external email warning bannerfor emails sent to orreceived from outside of your organization [CPG 2.M].Review internet-facing services and disable any services that are no longer a businessrequirementto be exposed or restrict access to only those users with an explicit requirement to access services, such as SSL, VPN, or RDP. If internet-facing services must be used, control access by only allowing access from an admin IP range [CPG 2.X].Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts.Regularly verify the security level of the Active Directory domainby checking for misconfigurations. EXECUTION Develop and regularly update comprehensive network diagram(s)that describes systems and data flows within your organization’s network(s) [CPG 2.P].Control and restrict network connectionsaccordingly with a network flow matrix.Enable enhanced PowerShell logging[CPG 2.T, 2.U].PowerShell logs contain valuable data, including historical OS, registry interaction, and possibility of a threat actor’s PowerShell use.Ensure PowerShell instances are configured to use the latest version, and have module, script block, and transcription logging enabled (enhanced logging).The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. It is recommended to turn on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as reasonably practical.Configure the Windows Registry to require UAC approval for any PsExec operationsrequiring administrator privileges to reduce the risk of lateral movement by PsExec. PRIVILEGE ESCALATION Disable command-line and scripting activities and permissions.Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [CPG 2.N].Enable Credential Guardto protect your Windows system credentials. This is enabled by default on Windows 11 Enterprise 22H2 and Windows 11 Education 22H2. Credential Guard prevents credential dumping techniques of the Local Security Authority (LSA) secrets. Be aware that enabling this security control has some downsides. In particular, you can no longer use New Technology Local Area Network (LAN) Manager (NTLM) classic authentication single sign-on, Kerberos unconstrained delegation, as well as Data Encryption Standard (DES) encryption.Implement Local Administrator Password Solution (LAPS)where possible if your OS is older than Windows Server 2019 and Windows 10 as these versions do not have LAPS built in.NOTE:The authoring organizations recommend organizations upgrade to Windows Server 2019 and Windows 10 or greater. DEFENSE EVASION Apply local security policies to control application execution(e.g., Software Restriction Policies (SRP), AppLocker, Windows Defender Application Control (WDAC)) with a strict allowlist.Establish an application allowlistof approved software applications and binaries that are allowed to be executed on a system. This measure prevents unwanted software to be run. Usually, application allowlist software can also be used to define blocklists so that the execution of certain programs can be blocked, for example cmd.exe or PowerShell.exe [CPG 2.Q]. CREDENTIAL ACCESS Restrict NTLM useswith security policies and firewalling. DISCOVERY Disable unusedports. Disable ports that are not being used for business purposes (e.g., RDP-TCP Port 3389). Close unused RDP ports. LATERAL MOVEMENT Identify Active Directory control pathsand eliminate the most critical among them according to the business needs and assets.Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomwarewith a networking monitoring tool.To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network [CPG 1.E]. EDR tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host. COMMAND AND CONTROL Implement a tiering modelby creating trust zones dedicated to an organization’s most sensitive assets.VPN access should not be considered as a trusted network zone.Organizations should instead consider moving to zero trust architectures. EXFILTRATION Block connections to known malicious systemsby using a Transport Layer Security (TLS) Proxy. Malware often uses TLS to communicate with the infrastructure of the threat actor. By using feeds for known malicious systems, the establishment of a connection to a C2 server can be prevented.Use web filtering or a Cloud Access Security Broker (CASB)to restrict or monitor access to public-file sharing services that may be used to exfiltrate data from a network. IMPACT Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, the cloud) [CPG 2.R].Maintain offline backups of data, and regularly maintain backup and restoration (daily or weekly at the minimum). By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data [CPG 2.R]. ACSC recommends organizations follow the 3-2-1 backup strategy in which organizations have three copies of data (one copy of production data and two backup copies) on two different media, such as disk and tape, with one copy kept off-site for disaster recovery.Ensure all backup data is encrypted, immutable(i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.R]. IMPLEMENT MITIGATIONS FOR DEFENSE-IN-DEPTH Implementing multiple mitigations within a defense-in-depth approach can help protect against ransomware, such as LockBit. CERT NZ explains How ransomware happens and how to stop it by applying mitigations, or critical controls, to provide a stronger defense to detect, prevent, and respond to ransomware before an organization’s data is encrypted. By understanding the most common attack vectors, organizations can identify gaps in network defenses and implement the mitigations noted in this advisory to harden organizations against ransomware attacks. In Figure 3, a ransomware attack is broken into three phases: Initial Accesswhere the cyber actor is looking for a way into a network.Consolidation and Preparationwhen the actor is attempting to gain access to all devices.Impact on Targetwhere the actor is able to steal and encrypt data and then demand ransom. Figure 3 shows the mitigations/critical controls, as various colored hexagons, working together to stop a ransomware attacker from accessing a network to steal and encrypt data. In the Initial Access phase, mitigations working together to deny an attacker network access include securing internet-exposed services, patching devices, implementing MFA, disabling macros, employing application allowlisting, and using logging and alerting. In the Consolidation and Preparation phase, mitigations working together to keep an attacker from accessing network devices are patching devices, using network segmentation, enforcing the principle of least privilege, implementing MFA, and using logging and alerting. Finally, in the Impact on Target phase, mitigations working together to deny or degrade an attacker’s ability to steal and/or encrypt data includes using logging and alerting, using and maintaining backups, and employing application allowlisting. Critical Controls Key Figure 3: Stopping Ransomware Using Layered Mitigations"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-158a,"MITIGATIONS The authoring agencies recommend organizations implement the mitigations below to improve their organization’s security posture in response to  threat actors’ activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections to reduce the risk of compromise by CL0P ransomware. Reduce threat of malicious actorsusing remote access tools by:Auditing remote access toolson your network to identify currently used and/or authorized software.Reviewing logs for execution of remote access softwareto detect abnormal use of programs running as a portable executable [CPG 2.T].Using security softwareto detect instances of remote access software only being loaded in memory.Requiring authorized remote access solutionsonly be used from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).Blocking both inbound and outbound connectionson common remote access software ports and protocols at the network perimeter.Implement application controlsto manage and control execution of software, including allowlisting remote access programs.Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Apply phishing-resistant multifactor authentication (MFA).Log RDP login attempts.Disable command-line and scriptingactivities and permissions [CPG 2.N].Restrict the use of PowerShell, using Group Policy, and only grant to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [CPG 2.E].Update Windows PowerShell or PowerShell Coreto the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E, 2.S, 2.T].Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts [CPG 4.C].Audit user accounts with administrative privilegesand configure access controls according to the principle of least privilege [CPG 2.E].Reduce the threat of credential compromisevia the following:Place domain admin accounts in the protected users’ groupto prevent caching of password hashes locally.Refrain from storing plaintext credentials in scripts.Implement time-based access for accountsset at the admin level and higher [CPG 2.A, 2.E]. In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the impact and risk of compromise by ransomware or data extortion actors: Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).Maintain offline backups of dataand regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices [CPG 2.R].Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts)to complywithNational Institute for Standards and Technology (NIST) standardsfor developing and managing password policies.Use longer passwords consisting of at least eight characters and no more than 64 characters in length [CPG 2.B].Store passwords in hashed format using industry-recognized password managers.Add password user “salts” to shared login credentials.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Require multifactor authenticationfor all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [CPG 2.H].Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Disable unused ports[CPG 2.V].Consider adding an email banner to emailsreceived from outside your organization [CPG 2.M].Disable hyperlinksin received emails.Ensure all backup data is encrypted, immutable(i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a,"Mitigations The authoring agencies recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture on the basis of the threat actor’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity Frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Defenders should harden domain controllers and monitor event logs [2.T] for ntdsutil.exe and similar process creations. Additionally, any use of administrator privileges should be audited and validated to confirm the legitimacy of executed commands.Administrators should limit port proxy usage within environments and only enable them for the period of time in which they are required [2.X].Defenders should investigate unusual IP addresses and ports in command lines, registry entries, and firewall logs to identify other hosts that are potentially involved in actor actions.In addition to host-level changes, defenders should review perimeter firewall configurations for unauthorized changes and/or entries that may permit external connections to internal hosts.Defenders should also look for abnormal account activity, such as logons outside of normal working hours and impossible time-and-distance logons (e.g., a user logging on from two geographically separated locations at the same time).Defenders should forward log files to a hardened centralized logging server, preferably on a segmented network [2.F]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a,"Mitigations FBI, CISA, and ASD’S ACSC recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture on the basis of the threat actors’ activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Reduce threat of malicious actors using remote access tools by:Auditing remote access toolson your network to identify currently used and/or authorized software.Reviewing logs for execution of remote access softwareto detect abnormal use of programs running as a portable executable [CPG 2.T].Using security software to detect instances of remote accesssoftware only being loaded in memory.Requiring authorized remote access solutions only be used from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).Blocking both inbound and outbound connections on common remote access software ports and protocolsat the network perimeter.Implement application controls to manage and control execution of software, including allowlisting remote access programs.Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.See NSA Cybersecurity Information sheetEnforce Signed Software Execution Policiesfor additional guidance.Strictly limit the use of RDP and other remote desktop services.If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:Audit the network for systems using RDP.Close unused RDP ports.Enforce account lockouts after a specified number of attempts.Applyphishing-resistant multifactor authentication (MFA).Log RDP login attempts.Disable command-line and scripting activities and permissions[CPG 2.N].Restrict the use of PowerShell, using Group Policy, and only grant to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [CPG 2.E].Update Windows PowerShell or PowerShell Coreto the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E,2.S,2.T].Enable enhanced PowerShell logging[CPG 2.T,2.U].PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor’s PowerShell use.Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operationsrequiring administrator privileges to reduce the risk of lateral movement by PsExec.Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts [CPG 4.C].Audit user accountswith administrative privileges and configure access controls according to the principle of least privilege [CPG 2.E].Reduce the threat of credential compromise via the following:Place domain admin accounts in the protected users’ groupto prevent caching of password hashes locally.Implement Credential Guard for Windows 10 and Server 2016(Refer toMicrosoft: Manage Windows Defender Credential Guardfor more information). For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA).Refrain from storing plaintext credentials in scripts.Implement time-based access for accounts set at the admin level and higher[CPG 2.A,2.E]. For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the AD level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task. In addition, FBI, CISA, and ASD’S ACSC recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the impact and risk of compromise by ransomware or data extortion actors: Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).Maintain offline backups of data, and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization minimizes the impact of disruption to business practices as they will not be as severe and/or only have irretrievable data [CPG 2.R]. ASD’S ACSC recommends organizations follow the 3-2-1 backup strategy in which organizations have three copies of data (one copy of production data and two backup copies) on two different media such as disk and tape, with one copy kept off-site for disaster recovery.Require all accounts with password logins(e.g., service account, admin accounts, and domain admin accounts)to comply withNational Institute for Standards and Technology (NIST) standardsfor developing and managing password policies.Use longer passwords consisting of at least 15 characters [CPG 2.B].Store passwords in hashed format using industry-recognized password managers.Add password user “salts” to shared login credentials.Avoid reusing passwords [CPG 2.C].Implement multiple failed login attempt account lockouts [CPG 2.G].Disable password “hints.”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Require phishing-resistant multifactor authenticationfor all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [CPG 2.H].Keep all operating systems, software, and firmware up to date.Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours from vulnerability disclosure. Prioritize patchingknown exploited vulnerabilitiesin internet-facing systems [CPG 1.E].Segment networksto prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks, restricting further lateral movement [CPG 2.F].Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections, as they have insight into common and uncommon network connections for each host [CPG 3.A].Install, regularly update, and enable real time detection for antivirus softwareon all hosts.Disable unused ports[CPG 2.V].Consider adding an email banner to emailsreceived from outside your organization [CPG 2.M].Ensure all backup data is encrypted, immutable(i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K,2.L,2.R]."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-131a,"MITIGATIONS FBI and CISA recommend organizations: Upgrade PaperCut to the latest version.If unable to immediately patch, ensure vulnerable PaperCut servers are not accessible over the internetand implement one of the following network controls:Option 1: External controls: Block all inbound traffic from external IP addresses to the web management portal (port 9191 and 9192 by default).Option 2: Internal and external controls: Block all traffic inbound to the web management portal. Note: The server cannot be managed remotely after this step.Follow best cybersecurity practicesin your production and enterprise environments, including mandatingphishing-resistant multifactor authentication (MFA)for all staff and for all services. For additional best practices, see CISA’sCross-Sector Cybersecurity Performance Goals(CPGs). The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common TTPs. Because the CPGs are a subset of best practices, CISA and FBI also recommend all organizations implement a comprehensive information security program based on a recognized framework, such as theNIST Cybersecurity Framework(CSF). ACKNOWLEDGMENTS The Multi-State Information Sharing and Analysis Center (MS-ISAC) contributed to this advisory.REFERENCES[1] PaperCut:URGENT | PaperCut MF/NG vulnerability bulletin (March 2023)[2] Huntress:Critical Vulnerabilities in PaperCut Print Management Software This product is provided subject to thisNotificationand thisPrivacy & Usepolicy."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-129a,"MITIGATIONS A number of complementary detection techniques effectively identify some of the more recent variants of Snake. However, as described above, Snake is purpose-built to avoid large-scale detection. Below is a discussion of the advantages and disadvantages of various detection methodologies available for Snake. Note that some of the techniques identified in this section can affect the availability or stability of a system.Defenders should follow organizational policies and incident response best practices to minimize the risk to operations while hunting for Snake. NETWORK-BASED DETECTION Network Intrusion Detection Systems (NIDS) can feasibly identify some of the more recent variants of Snake and its custom network protocols as detailed above. Advantages:High-confidence, large-scale (network-wide) detection of custom Snake communication protocols. Disadvantages:Low visibility of Snake implant operations and encrypted data in transit.There is some potential for false positives in the Snake http, http2, and tcp signatures.Snake operators can easily change network-based signatures. Snake client-to-server http and http2 traffic is contained within an arbitrary HTTP header field. The header field value for http begins with 10 pure alphanumeric characters, followed by base64 encoding of 8 bytes, which yields exactly 11 valid base64 characters plus one base64 padding character. ^[0-9A-Za-z]{10}[0-9A-Za-z/\+]{11}= The following two Suricata rules will detect the traffic described: alert http any any -> any any (msg: ""http rule (Cookie)"";\    pcre:""/[0-9A-Za-z]{10}[0-9A-Za-z\/\+]{11}=/C"";\    flow: established, to_server;\    sid: 7; rev: 1;) alert http any any -> any any (msg: ""http rule (Other Header)"";\    pcre:""/[0-9A-Za-z]{10}[0-9A-Za-z\/\+]{11}=/H"";\    flow: established, to_server;\    sid: 8; rev: 1;) The header field value for http2 begins with 22 pure alphanumeric characters (base62 with non-extraneous characters), followed by the base62 encoding of at least 8 bytes, which must comprise at least 11 base62 characters with the four extraneous characters allowed. The actual requirement is stricter than this expression, since the total number of non-extraneous characters alone must equal or exceed 11; however, it is not possible to encode that aspect into a regular language. ^[0-9A-Za-z]{22}[0-9A-Za-z/;_=]{11} The following two Suricata rules will detect the traffic described: alert http any any -> any any (msg: ""http2 rule (Cookie)"";\    pcre:""/[0-9A-Za-z]{22}[0-9A-Za-z\/_=\;]{11}/C"";\    flow: established, to_server;\    sid: 9; rev: 1;) alert http any any -> any any (msg: ""http2 rule (Other Header)"";\    pcre:""/[0-9A-Za-z]{22}[0-9A-Za-z\/_=\;]{11}/H"";\    flow: established, to_server;\    sid: 10; rev: 1;) The client-to-server communication for tcp must begin with the ustart, which is not captured in this signature set. Immediately following the ustart, the next client-to-server communication must be the big-endian 32-bit unsigned integer 8 followed by any 8 bytes of data. The next communication must also be client-to-server, and it must comprise the big-endian 32-bit unsigned integer 4 followed by any 4 bytes of data. The next two communications must be server-to-client, comprising the integer 8 followed by 8 bytes of data and the integer 4 followed by 4 bytes of data. The following six Suricata rules will, in conjunction, detect traffic of the form described: alert tcp any any -> any any (msg: ""tcp rule"";\    content: ""|00 00 00 08|""; startswith; dsize: 12;\    flow: established, to_server; flowbits: set, a8; flowbits: noalert;\    sid: 1; rev: 1;) alert tcp any any -> any any (msg: ""tcp rule"";\    content: ""|00 00 00 04|""; startswith; dsize:8;\    flow: established, to_server; flowbits: isset, a8; flowbits: unset, a8;\    flowbits: set, a4; flowbits: noalert;\    sid: 2; rev: 1;) alert tcp any any -> any any (msg: ""tcp rule"";\    content: ""|00 00 00 08|""; startswith; dsize: 4;\    flow: established, to_client; flowbits: isset, a4; flowbits: unset, a4;\    flowbits: set, b81; flowbits: noalert;\    sid: 3; rev: 1;) alert tcp any any -> any any (msg: ""tcp rule"";\    dsize: 8; flow: established, to_client; flowbits: isset, b81;\    flowbits: unset, b81; flowbits: set, b8; flowbits: noalert;\    sid: 4; rev: 1;) alert tcp any any -> any any (msg: ""tcp rule"";\    content: ""|00 00 00 04|""; startswith; dsize: 4;\    flow: established, to_client; flowbits: isset, b8; flowbits: unset, b8;\    flowbits: set, b41; flowbits: noalert;\    sid: 5; rev: 1;) alert tcp any any -> any any (msg: ""tcp rule"";\    dsize: 4; flow: established, to_client; flowbits: isset, b41;\    flowbits: unset, b41;\    sid: 6; rev: 1;) HOST-BASED DETECTION Advantages:High confidence based on totality of positive hits for host-based artifacts. Disadvantages:Many of the artifacts on the host are easily shifted to exist in a different location or with a different name. As the files are fully encrypted, accurately identifying these files is difficult. The Snake covert store comprises a file-backed NTFS (usually) or FAT-16 (rarely) filesystem. The filesystem is encrypted with CAST-128 in CBC mode. The encryption key can be either statically hardcoded or dynamically stored in a specified Windows registry location. The IV is 8 bytes, since CAST-128 has an 8-byte block length. The first byte of the IV for any 512-byte block of the covert store is the 0-indexed block number. The remaining bytes of the IV are the corresponding bytes of the key, meaning that bytes at 0-indexed indices 1 through 7 of the IV are the bytes at 0-indexed indices 1 through 7 of the key. When statically hardcoded, the encryption key has the following constant value: ​​​​​​     A1 D2 10 B7 60 5E DA 0F A1 65 AF EF 79 C3 66 FA When stored in the Windows registry, the encryption key is the classname associated with the following key: SECURITY\Policy\Secrets\n The following initial 8-byte sequences are known to be used by NTFS or FAT-16 filesystems as observed: EB 52 90 4E 54 46 53 20      EB 5B 90 4E 54 46 53 20      EB 3C 90 4D 53 44 4F 53      EB 00 00 00 00 00 00 00 For tool development, the following test vector illustrates the encryption of the first given header above (EB 52 90 …) using CAST-128 with the default key shown above and the IV constructed as described, given this header occurs at the beginning of the first 512-byte block of the covert store. Plaintext:EB 52 90 4E 54 46 53 20Key:A1 D2 10 B7 60 5E DA 0F A1 65 AF EF 79 C3 66 FAIV:00 D2 10 B7 60 5E DA 0FCiphertext:C2 C7 F4 CA F7 DA 3A C8 By encrypting each possible initial filesystem byte sequence with CAST-128 using the key obtained from the registry—or the default encryption key if the registry entry does not exist—and searching for any file with a size that is an even multiple of 220, it is possible to efficiently detect Snake covert stores. Validation can be performed by decrypting the entire file using the outlined methodology and then verifying that it comprises an NTFS or FAT-16 filesystem. Registry Blob The registry blob is generally found at the location listed below. In case it is not present at its typical location, the registry blob can be found by searching the full registry for a value of at least 0x1000 bytes in size and entropy of at least 7.9. Typical Name:Unknown (RegBlob)Typical Path:HKLM\SOFTWARE\Classes\.wav\OpenWithProgIdsCharacteristics:High Entropy Queue File Typical Name:< RANDOM_GUID >.<RANDOM_GUID>.crmlogTypical Path:%windows\registration\Unique Characteristics:High Entropy, file attributes of hidden, system, and archiveRole:Snake Queue File The Snake Queue File generally has a predictable path and filename structure, in addition to being high entropy. The Snake Queue File can be located by scanning all files in the typical queue path with filenames matching a regular expression that captures the typical naming convention. Files meeting these criteria should be scanned for high entropy, which is performed by the Yara rule below: rule HighEntropy {    meta:        description = ""entropy rule""    condition:        math.entropy(0, filesize) >= 7.0 } The following UNIX find command will scan files with names matching the GUID-based convention (note that the HighEntropy yara rule is assumed to be contained in a file named “1.yar”): find /PATH/TO/WINDOWS_DIR -type f -regextype posix-egrep -iregex \    '.*\/registration/(\{[0-9A-F]{8}\-([0-9A-F]{4}\-){3}[0-9A-F]{12}\}\.){2}crmlog' \     -exec yara 1.yar {} \; The following PowerShell command does the same: Get-ChildItem -Recurse -File -Path %WINDOWS% | Where-Object {  $_.FullName -match  '(?i)/registration/(\{[0-9A-F]{8}\-([0-9A-F]{4}\-){3}[0-9A-F]{12}\}\.){2}crmlog$' } | ForEach-Object {  yara 1.yar $_.FullName } Comadmin Typical Name:comadmin.datTypical Path:%windows%\system32\ComUnique Characteristics:High EntropyRole:Houses Snake’s kernel driver and the driver’s loader The Snake Comadmin file can be found using analogous techniques to that presented above for locating the Snake Queue File. The following UNIX find command will do so: find /PATH/TO/WINDOWS -type f -regextype posix-egrep -iregex \    '.*\/system32/Com/comadmin\.dat' \     -exec yara 1.yar {} \; The following PowerShell command does the same: Get-ChildItem -Recurse -File -Path %WINDOWS% | Where-Object {    $_.FullName -match '(?i)/system32/Com/comadmin\.dat$' } | ForEach-Object {    yara 1.yar $_.FullName } Werfault Typical Name:Werfault.exeTypical Path:%windows%\WinSxS\x86_microsoft-windows-errorreportingfaults_31bf3856ad364e35_4.0.9600.16384_none_a13f7e283339a0502\Unique Characteristics:Icon is different than that of a valid Windows Werfault.exe fileRole:Persistence mechanism The Snake Werfault.exe file has non-standard icon sizes, which form the basis of the Yara rule below. This rule should be run on all files in the typical path, specifically the %Windows%\WinSxS directory. rule PeIconSizes {    meta:        description = ""werfault rule""    condition:        pe.is_pe        and        for any rsrc in pe.resources:            (rsrc.type == pe.RESOURCE_TYPE_ICON and rsrc.length == 3240)        and        for any rsrc in pe.resources:            (rsrc.type == pe.RESOURCE_TYPE_ICON and rsrc.length == 1384)        and        for any rsrc in pe.resources:            (rsrc.type == pe.RESOURCE_TYPE_ICON and rsrc.length == 7336) } MEMORY ANALYSIS Advantages:High confidence as memory provides the greatest level of visibility into Snake’s behaviors and artifacts. Disadvantages: Potential impact on system stability, difficult scalability. Capturing and analyzing the memory of a system will be the most effective approach in detecting Snake because it bypasses many of the behaviors that Snake employs to hide itself. With a memory analysis tool, such as Volatility, detection of a Snake compromise may be possible.Snake’s principal user mode component is injected into a chosen process via a single allocation of PAGE_EXECUTE_READWRITE memory. The starting offset is generally 0x20000000, however the module does allow for relocation if needed. Additionally, since the user mode component is not obfuscated in any way, a valid PE header can be located at the beginning of the allocated memory region. Further validation can be performed by confirming the presence of strings known to exist in the user mode component also within the memory region. A plugin compatible with Volatility3 which can scan all processes on a system using this method is provided in the Appendix. A screenshot showing the results of the plugin successfully detecting Snake is displayed below."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-061a,"Mitigations NETWORK DEFENDERS The FBI and CISA recommend network defenders implement the mitigations below to improve your organization’s cybersecurity posture based on BlackSuit actor’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Implement a recovery planto maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).Require all accountswith password logins (e.g., service account, admin accounts, and domain admin accounts) to comply withNational Institute for Standards and Technology (NIST) standardsfor developing and managing password policies.Use longer passwords consisting of at least 8 characters and no more than 64 characters in length;Store passwords in hashed format using industry-recognized password managers;Add password user “salts” to shared login credentials;Avoid reusing passwords;Implement multiple failed login attempt account lockouts;Disable password “hints;”Refrain from requiring password changes more frequently than once per year.Note:NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.Require administrator credentials to install software.Keep all operating systems, software, and firmware up to date [CPG 1.E].Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems.Require Phishing-Resistant multifactor authentication to administrator accounts [CPG 2.H],and require standard MFA for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems.Segment networks [CPG 2.F]to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement.Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool [CPG 3.A].To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.Install, regularly update, and enable real time detection for antivirussoftware on all hosts.Implement Secure Logging Collection and Storage Practices [CPG 2.T]. Learn more on logging best practices by referencingCISA’s Logging Made Easyresources.Review domain controllers, servers, workstations, and active directoriesfor new and/or unrecognized accounts.Audit user accountswith administrative privileges and configure access controls according to the principle of least privilege.Disable unused ports.Implement and Enforce Email Security Policies [CPG 2.M].Disable Macros by Default [CPG 2.N].Consider adding an email banner to emailsreceived from outside your organization.Disable hyperlinks in received emails.Implement time-based access for accounts set at the admin level and higher.For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.Disable command-line and scripting activities and permissions.Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.Maintain offline backups of data, and regularly maintain backup and restoration [CPG 2.R].By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data.Ensure all backup data is encrypted,immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure. SOFTWARE MANUFACTURERS The above mitigations apply to enterprises and critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of the majority of these flaws and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of <identified or exploited issues(e.g.,misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team)>: Embed security into product architecturethroughout the entire software development lifecycle (SDLC).Mandate MFA,ideally phishing-resistantMFA, for privileged usersand make MFA a default, rather than opt-in, feature. These mitigations align with tactics provided in the joint guideShifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates. For more information on secure by design, see CISA’sSecure by Designwebpage."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-059a,"MITIGATIONS CISA recommends organizations implement the recommendations in Table 2 to mitigate the issues listed in the Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. See CISA’sCross-Sector Cybersecurity Performance Goalsfor more information on the CPGs, including additional recommended baseline protections. Additionally, CISA recommends organizations implement the mitigations below to improve their cybersecurity posture: Provide users with regular training and exercises, specifically related to phishing emails [CPG 4.3]. Phishing accounts for majority of initial access intrusion events.Enforcephishing-resistant MFAto the greatest extent possible [CPG 1.3].Reduce the risk of credential compromise via the following:Place domain admin accounts in the protected users groupto prevent caching of password hashes locally; this also forces Kerberos AES authentication as opposed to weaker RC4 or NTLM.Implement Credential Guard for Windows 10 and Server 2016(Refer toMicrosoft: Manage Windows Defender Credential Guardfor more information). For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA).Refrain from storing plaintext credentials in scripts[CPG 3.4]. The red team discovered a PowerShell script containing plaintext credentials that allowed them to escalate to admin.Upgrade to Windows Server 2019 or greater and Windows 10 or greater.These versions have security features not included in older operating systems. As a long-term effort,CISA recommends organizations prioritize implementing a more modern,Zero Trustnetwork architecturethat: Leverages secure cloud services for key enterprise security capabilities (e.g., identity and access management, endpoint detection and response, policy enforcement).Upgrades applications and infrastructure to leverage modern identity management and network access practices.Centralizes and streamlines access to cybersecurity data to drive analytics for identifying and managing cybersecurity risks.Invests in technology and personnel to achieve these goals. CISA encourages organizational IT leadership to ask their executive leadership the question: Can the organization accept the business risk of NOT implementing critical security controls such as MFA? Risks of that nature should typically be acknowledged and prioritized at the most senior levels of an organization."
