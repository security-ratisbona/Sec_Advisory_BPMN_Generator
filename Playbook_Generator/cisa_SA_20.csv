URL,Content
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-352a,"Mitigations (UPDATED JANUARY 6, 2021) SOLARWINDS ORION OWNERS Networks with SolarWinds Orion products will generally fall into one of three categories. (Note: for the purposes of mitigation analysis, a network is defined as any computer network with hosts that share either a logical trust or any account credentials with SolarWinds Orion.) Category 1includes those who do not have the identified malicious binary code on their network and can forensically confirm that the binary was never present on their systems. This includes networks that do not, and never did, utilize the affected versions of SolarWinds Orion products (see Appendix A).Category 2includes networks where the presence of the malicious binary has been identified—with or without beaconing toavsvmcloud[.]com. This includes networks that previously utilized affected versions of SolarWinds Orion but where the organization has forensically verified (through comprehensive network monitoring and analysis) that platforms running the affected software either:Had no beaconing, orOnly beaconed toavsvmcloud[.]comand have not had any secondary C2 activity to a separate domain or IP address or other adversary activity or secondary actions on objectives (AOOs),[6] such as SAML token abuse.Category 2 organizations, after conducting appropriate forensic analysis to ensure they only have Category 2 activity, can rebuild the platform, harden the configuration based on SolarWinds secure configuration guidelines, and resume use as determined by and consistent with their thorough risk evaluation. For entities not subject to ED 21-01, this can be accomplished by following the steps below. Federal agencies subject to ED 21-01 must follow the appropriate steps as outlined in the effective ED 21-01 supplemental guidance.Denying all incoming and outgoing (any:any) communications outside of the organization’s device network management enclave, with additional assurance that communications to the public internet to and from hosts running SolarWinds Orion products has been blocked.Cloud instances of Orion should only monitor cloud resources in that cloud infrastructure.On-premises instances of Orion should not be permissioned with any cloud/hosted identity accounts.Restoration of SolarWinds may be done from the legacy database following the SolarWinds restore guidance (http://solarwinds.com/upgrading-your-environment). Restoration for affected versions will differ from restoration for unaffected versions—agencies must ensure that they are following the correct restoration guidance.Before building SolarWinds:All account credentials, or other shared secrets (e.g., Simple Network Management Protocol [SNMP] strings) that are or had been utilized by the affected SolarWinds Orion device being rebuilt should be changed.Enable MFA for these credentials, whenever possible.Provide service accounts with the minimum privilege necessary for the role performed, whenever possible.For accounts where MFA is not possible  (e.g., service accounts), use randomly generated long and complex passwords (greater than 25 characters) and implement a maximum 90-day rotation policy for these passwords.Remove all inbound trust relationships to the SolarWinds Orion device being rebuilt.Re-building a SolarWinds Orion Platform to at least version 2020.2.1 HF2 and updating the host to the latest supported build, at least Windows 2016.Following the SolarWinds secure configuration (hardening) guidelines provided by the vendor, which can be found at:https://documentation.solarwinds.com/en/Success_Center/orionplatform/content/core-secure-configuration.htm. CISA does not recommend configuring the SolarWinds software to implement SAML-based authentication that relies on Microsoft’s Active Directory Federated Services if it has not already been configured to leverage SAML. This configuration is currently being exploited by the threat actor with this activity.Configuring logging to ensure that all logs on the host operating system and SolarWinds platform are being captured and stored for at least 180 days.Configure logging to ensure that all logs from the host OS, SolarWinds platform, and associated network logs are being captured and stored for at least 180 days in a separate, centralized log aggregation capability.Implementing subsequent SolarWinds Orion Platform updates. CISA recommends installing all updates within 48 hours of release.Category 3includes those networks that used affected versions of SolarWinds Orion and have evidence of follow-on threat actor activity, such as binary beaconing toavsvmcloud[.]comand secondary C2 activity to a separate domain or IP address (typically but not exclusively returned inavsvmcloud[.]comCNAME responses). Additionally, organizations that have observed communications withavsvmcloud[.]comthat appear to suddenly cease prior to December 14, 2020—not due to an action taken by their network defenders—fall into this category. Assume the environment has been compromised, and initiate incident response procedures immediately. Recovery and remediation of Category 3 activity requires a complex reconstitution and mitigation plan, which may include comprehensively rebuilding the environment. This should be coordinated with an organization’s leadership and incident response team. Had no beaconing, orOnly beaconed toavsvmcloud[.]comand have not had any secondary C2 activity to a separate domain or IP address or other adversary activity or secondary actions on objectives (AOOs),[6] such as SAML token abuse. Denying all incoming and outgoing (any:any) communications outside of the organization’s device network management enclave, with additional assurance that communications to the public internet to and from hosts running SolarWinds Orion products has been blocked.Cloud instances of Orion should only monitor cloud resources in that cloud infrastructure.On-premises instances of Orion should not be permissioned with any cloud/hosted identity accounts.Restoration of SolarWinds may be done from the legacy database following the SolarWinds restore guidance (http://solarwinds.com/upgrading-your-environment). Restoration for affected versions will differ from restoration for unaffected versions—agencies must ensure that they are following the correct restoration guidance.Before building SolarWinds:All account credentials, or other shared secrets (e.g., Simple Network Management Protocol [SNMP] strings) that are or had been utilized by the affected SolarWinds Orion device being rebuilt should be changed.Enable MFA for these credentials, whenever possible.Provide service accounts with the minimum privilege necessary for the role performed, whenever possible.For accounts where MFA is not possible  (e.g., service accounts), use randomly generated long and complex passwords (greater than 25 characters) and implement a maximum 90-day rotation policy for these passwords.Remove all inbound trust relationships to the SolarWinds Orion device being rebuilt.Re-building a SolarWinds Orion Platform to at least version 2020.2.1 HF2 and updating the host to the latest supported build, at least Windows 2016.Following the SolarWinds secure configuration (hardening) guidelines provided by the vendor, which can be found at:https://documentation.solarwinds.com/en/Success_Center/orionplatform/content/core-secure-configuration.htm. CISA does not recommend configuring the SolarWinds software to implement SAML-based authentication that relies on Microsoft’s Active Directory Federated Services if it has not already been configured to leverage SAML. This configuration is currently being exploited by the threat actor with this activity.Configuring logging to ensure that all logs on the host operating system and SolarWinds platform are being captured and stored for at least 180 days.Configure logging to ensure that all logs from the host OS, SolarWinds platform, and associated network logs are being captured and stored for at least 180 days in a separate, centralized log aggregation capability.Implementing subsequent SolarWinds Orion Platform updates. CISA recommends installing all updates within 48 hours of release. All account credentials, or other shared secrets (e.g., Simple Network Management Protocol [SNMP] strings) that are or had been utilized by the affected SolarWinds Orion device being rebuilt should be changed.Enable MFA for these credentials, whenever possible.Provide service accounts with the minimum privilege necessary for the role performed, whenever possible.For accounts where MFA is not possible  (e.g., service accounts), use randomly generated long and complex passwords (greater than 25 characters) and implement a maximum 90-day rotation policy for these passwords.Remove all inbound trust relationships to the SolarWinds Orion device being rebuilt. Compromise Mitigations (Updated January 6, 2021): If the adversary has compromised administrative level credentials in an environment—or if organizations identify SAML abuse in the environment, simply mitigating individual issues, systems, servers, or specific user accounts will likely not lead to the adversary’s removal from the network. In such cases, organizations should consider the entire identity trust store as compromised. In the event of a total identity compromise, a full reconstitution of identity and trust services is required to successfully remediate. In this reconstitution, it bears repeating that this threat actor is among the most capable, and in many cases, a full rebuild of the environment is the safest action. A Microsoft blog post,Advice for incident responders on recovery from systemic identity compromisesoutlines processes and procedures needed to remediate this type of activity and retain administrative control of an environment. In addition to the recommendations in this blog post, CISA recommends the following actions: Take actions to remediate kerberoasting, including, as necessary or appropriate, engaging with a 3rd party with experience eradicating APTs from enterprise networks. For Windows environments, refer to the following:See Microsoft’s documentation on kerberoasting:https://techcommunity.microsoft.com/t5/microsoft-security-and/detecting-ldap-based-kerberoasting-with-azure-atp/ba-p/462448.Change all account credentials, or other shared secrets (e.g., SNMP strings) that were potentially exposed:Enable MFA for these credentials, whenever possible;Provide service accounts with the minimum level of privilege necessary for the role performed, whenever possible; andFor accounts where MFA is not possible, require use of randomly generated long and complex passwords (greater than 25 characters) and implement a maximum 90-day rotation policy for these passwords.Replace the user accounts with a Group Managed Service Account (gMSA). Seehttps://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview, and Implement Group Managed Service Accounts:https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview.Set account options for service accounts to support AES256_CTS_HMAC_SHA1_96 and not support DES, RC4, or AES128 bit encryptionDefine the Security Policy setting, for Network Security: Configure Encryption types allowed for Kerberos. Set the allowable encryption types to AES256_HMAC_SHA1 and Future encryption types.https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-configure-encryption-types-allowed-for-kerberosSee Microsoft’s documentation on how to reset the Kerberos Ticket Granting Ticket password, twice:https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password. See Microsoft’s documentation on kerberoasting:https://techcommunity.microsoft.com/t5/microsoft-security-and/detecting-ldap-based-kerberoasting-with-azure-atp/ba-p/462448.Change all account credentials, or other shared secrets (e.g., SNMP strings) that were potentially exposed:Enable MFA for these credentials, whenever possible;Provide service accounts with the minimum level of privilege necessary for the role performed, whenever possible; andFor accounts where MFA is not possible, require use of randomly generated long and complex passwords (greater than 25 characters) and implement a maximum 90-day rotation policy for these passwords.Replace the user accounts with a Group Managed Service Account (gMSA). Seehttps://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview, and Implement Group Managed Service Accounts:https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview.Set account options for service accounts to support AES256_CTS_HMAC_SHA1_96 and not support DES, RC4, or AES128 bit encryptionDefine the Security Policy setting, for Network Security: Configure Encryption types allowed for Kerberos. Set the allowable encryption types to AES256_HMAC_SHA1 and Future encryption types.https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-configure-encryption-types-allowed-for-kerberosSee Microsoft’s documentation on how to reset the Kerberos Ticket Granting Ticket password, twice:https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password. Enable MFA for these credentials, whenever possible;Provide service accounts with the minimum level of privilege necessary for the role performed, whenever possible; andFor accounts where MFA is not possible, require use of randomly generated long and complex passwords (greater than 25 characters) and implement a maximum 90-day rotation policy for these passwords. SOLARWINDS ORION SPECIFIC MITIGATIONS The following mitigations apply to networks using the SolarWinds Orion product. This includes any information system that is used by an entity or operated on its behalf. Organizations that have theexpertiseto take the actions in Step 1 immediately should do so before proceeding to Step 2. Organizations without this capability should proceed to Step 2. Federal civilian executive branch agencies should ignore the below and refer instead toEmergency Directive 21-01(and forthcoming associated guidance) for mitigation steps. Step 1Forensically image system memory and/or host operating systems hosting all instances of affected versions of SolarWinds Orion.Analyze for new user or service accounts, privileged or otherwise.Analyze stored network traffic forindications of compromise, including new external DNS domains to which a small number of agency hosts (e.g., SolarWinds systems) have had connections.Step 2Affected organizations should immediatelydisconnect or power down affected all instances of affected versions of SolarWinds Orion from their network.Additionally:Block all trafficto and from hosts, external to the enterprise, where any version of SolarWinds Orion software has been installed.Identify and removeall threat actor-controlled accounts and identified persistence mechanisms.Step 3Only after all known threat actor-controlled accounts and persistence mechanisms have been removed:Treat all hosts monitored by the SolarWinds Orion monitoring software as compromised by threat actors and assume that the threat actor has deployed further persistence mechanisms.Rebuild hosts monitored by the SolarWinds Orion monitoring software using trusted sources.Reset all credentials used by or stored in SolarWinds software. Such credentials should be considered compromised.(New December 19, 2020) For all network devices (routers, switches, firewalls, etc.) managed by affected SolarWinds servers that also have indications of additional adversary activity, CISA recommends the following steps:Device configurationsAudit all network device configurations, stored or managed on the SolarWinds monitoring server, for signs of unauthorized or malicious configuration changes.Audit the configurations found on network devices for signs of unauthorized or malicious configuration changes. Organizations should ensure they audit the current network device running configuration and any local configurations that could be loaded at boot time.Credential and security information resetChange all credentials being used to manage network devices, to include keys and strings used to secure network device functions (SNMP strings/user credentials, IPsec/IKE preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.).Firmware and software validationValidate all network device firmware/software which was stored or managed on the SolarWinds monitoring server. Cryptographic hash verification should be performed on such firmware/software and matched against known good hash values from the network vendor. CISA recommends that, if possible, organizations download known good versions of firmware.For network devices managed by the SolarWinds monitoring server, the running firmware/software should be checked against known good hash values from the network vendor. CISA recommends that, if possible, organizations re-upload known good firmware/software to managed network devices and perform a reboot. Forensically image system memory and/or host operating systems hosting all instances of affected versions of SolarWinds Orion.Analyze for new user or service accounts, privileged or otherwise.Analyze stored network traffic forindications of compromise, including new external DNS domains to which a small number of agency hosts (e.g., SolarWinds systems) have had connections. Affected organizations should immediatelydisconnect or power down affected all instances of affected versions of SolarWinds Orion from their network.Additionally:Block all trafficto and from hosts, external to the enterprise, where any version of SolarWinds Orion software has been installed.Identify and removeall threat actor-controlled accounts and identified persistence mechanisms. Block all trafficto and from hosts, external to the enterprise, where any version of SolarWinds Orion software has been installed.Identify and removeall threat actor-controlled accounts and identified persistence mechanisms. Only after all known threat actor-controlled accounts and persistence mechanisms have been removed:Treat all hosts monitored by the SolarWinds Orion monitoring software as compromised by threat actors and assume that the threat actor has deployed further persistence mechanisms.Rebuild hosts monitored by the SolarWinds Orion monitoring software using trusted sources.Reset all credentials used by or stored in SolarWinds software. Such credentials should be considered compromised. Treat all hosts monitored by the SolarWinds Orion monitoring software as compromised by threat actors and assume that the threat actor has deployed further persistence mechanisms.Rebuild hosts monitored by the SolarWinds Orion monitoring software using trusted sources.Reset all credentials used by or stored in SolarWinds software. Such credentials should be considered compromised. Device configurationsAudit all network device configurations, stored or managed on the SolarWinds monitoring server, for signs of unauthorized or malicious configuration changes.Audit the configurations found on network devices for signs of unauthorized or malicious configuration changes. Organizations should ensure they audit the current network device running configuration and any local configurations that could be loaded at boot time.Credential and security information resetChange all credentials being used to manage network devices, to include keys and strings used to secure network device functions (SNMP strings/user credentials, IPsec/IKE preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.).Firmware and software validationValidate all network device firmware/software which was stored or managed on the SolarWinds monitoring server. Cryptographic hash verification should be performed on such firmware/software and matched against known good hash values from the network vendor. CISA recommends that, if possible, organizations download known good versions of firmware. Audit all network device configurations, stored or managed on the SolarWinds monitoring server, for signs of unauthorized or malicious configuration changes.Audit the configurations found on network devices for signs of unauthorized or malicious configuration changes. Organizations should ensure they audit the current network device running configuration and any local configurations that could be loaded at boot time. Change all credentials being used to manage network devices, to include keys and strings used to secure network device functions (SNMP strings/user credentials, IPsec/IKE preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.). Validate all network device firmware/software which was stored or managed on the SolarWinds monitoring server. Cryptographic hash verification should be performed on such firmware/software and matched against known good hash values from the network vendor. CISA recommends that, if possible, organizations download known good versions of firmware. See Joint Alert onTechnical Approaches to Uncovering and Remediating Malicious Activityfor more information on incident investigation and mitigation steps based on best practices. CISA will update this Alert, as information becomes available and will continue to provide technical assistance, upon request, to affected entities as they work to identify and mitigate potential compromises."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-345a,"Mitigations PLANS AND POLICIES The FBI and CISA encourage educational providers to maintain business continuity plans—the practice of executing essential functions through emergencies (e.g., cyberattacks)—to minimize service interruptions. Without planning, provision, and implementation of continuity principles, institutions may be unable to continue teaching and administrative operations. Evaluating continuity and capability will help identify potential operational gaps. Through identifying and addressing these gaps, institutions can establish a viable continuity program that will help keep them functioning during cyberattacks or other emergencies. The FBI and CISA suggest K-12 educational institutions review or establish patching plans, security policies, user agreements, and business continuity plans to ensure they address current threats posed by cyber actors. NETWORK BEST PRACTICES Patch operating systems, software, and firmware as soon as manufacturers release updates.Check configurations for every operating system version for educational institution-owned assets to prevent issues from arising that local users are unable to fix due to having local administration disabled.Regularly change passwords to network systems and accounts and avoid reusing passwords for different accounts.Use multi-factor authentication where possible.Disable unused remote access/RDP ports and monitor remote access/RDP logs.Implement application and remote access allow listing to only allow systems to execute programs known and permitted by the established security policy.Audit user accounts with administrative privileges and configure access controls with least privilege in mind.Audit logs to ensure new accounts are legitimate.Scan for open or listening ports and mediate those that are not needed.Identify critical assets such as student database servers and distance learning infrastructure; create backups of these systems and house the backups offline from the network.Implement network segmentation. Sensitive data should not reside on the same server and network segment as the email environment.Set antivirus and anti-malware solutions to automatically update; conduct regular scans. USER AWARENESS BEST PRACTICES Focus on awareness and training. Because end users are targeted, make employees and students aware of the threats—such as ransomware and phishing scams—and how they are delivered. Additionally, provide users training on information security principles and techniques as well as overall emerging cybersecurity risks and vulnerabilities.Ensure employees know who to contact when they see suspicious activity or when they believe they have been a victim of a cyberattack. This will ensure that the proper established mitigation strategy can be employed quickly and efficiently.Monitor privacy settings and information available on social networking sites. RANSOMWARE BEST PRACTICES The FBI and CISA do not recommend paying ransoms. Payment does not guarantee files will be recovered. It may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. However, regardless of whether your organization decided to pay the ransom, the FBI urges you to report ransomware incidents to your local FBI field office. Doing so provides the FBI with the critical information they need to prevent future attacks by identifying and tracking ransomware attackers and holding them accountable under U.S. law. In addition to implementing the above network best practices, the FBI and CISA also recommend the following: Regularly back up data, air gap, and password protect backup copies offline.Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, secure location. DENIAL-OF-SERVICE BEST PRACTICES Consider enrolling in a denial-of-service mitigation service that detects abnormal traffic flows and redirects traffic away from your network.Create a partnership with your local internet service provider (ISP) prior to an event and work with your ISP to control network traffic attacking your network during an event.Configure network firewalls to block unauthorized IP addresses and disable port forwarding. VIDEO-CONFERENCING BEST PRACTICES Ensure participants use the most updated version of remote access/meeting applications.Require passwords for session access.Encourage students to avoid sharing passwords or meeting codes.Establish a vetting process to identify participants as they arrive, such as a waiting room.Establish policies to require participants to sign in using true names rather than aliases.Ensure only the host controls screensharing privileges.Implement a policy to prevent participants from entering rooms prior to host arrival and to prevent the host from exiting prior to the departure of all participants. EDTECH IMPLEMENTATION CONSIDERATIONS When partnering with third-party and edtech services to support distance learning, educational institutions should consider the following:The service provider’s cybersecurity policies and response plan in the event of a breach and their remediation practices:How did the service provider resolve past cyber incidents? How did their cybersecurity practices change after these incidents?The provider’s data security practices for their products and services (e.g., data encryption in transit and at rest, security audits, security training of staff, audit logs);The provider’s data maintenance and storage practices (e.g., use of company servers, cloud storage, or third-party services);Types of student data the provider collects and tracks (e.g., PII, academic, disciplinary, medical, biometric, IP addresses);Entities to whom the provider will grant access to the student data (e.g., vendors);How the provider will use student data (e.g., will they sell it to—or share it with—third parties for service enhancement, new product development, studies, marketing/advertising?);The provider’s de-identification practices for student data; andThe provider’s policies on data retention and deletion. How did the service provider resolve past cyber incidents? How did their cybersecurity practices change after these incidents? MALWARE DEFENSE Table 1 identifies CISA-created Snort signatures, which have been successfully used to detect and defend against related attacks, for the malware variants listed below.Note:the listing is not fully comprehensive and should not be used at the exclusion of other detection methods. Table 1: Malware signatures Cerber alert tcp any any -> any $HTTP_PORTS (msg:""HTTP URI GET contains 'invoice_########.doc' (DRIDEX)""; sid:00000000; rev:1; flow:established,to_server; content:""invoice_""; http_uri; fast_pattern:only; content:"".doc""; nocase; distance:8; within:4; content:""GET""; nocase; http_method; classtype:http-uri; metadata:service http;)alert tcp any any -> any $HTTP_PORTS (msg:""HTTP Client Header contains 'Host|3a 20|tanevengledrep ru' (DRIDEX)""; sid:00000000; rev:1; flow:established,to_server; flowbits:isnotset,<unique_ID>.tagged; content:""Host|3a 20|tanevengledrep|2e|ru|0d 0a|""; http_header; fast_pattern:only; flowbits:set,<unique_ID>.tagged; tag:session,10,packets; classtype:http-header; metadata:service http;)"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-336a,"Mitigations CISA and FBI recommend think tank organizations apply the following critical practices to strengthen their security posture. LEADERS Implement a training program to familiarize users with identifying social engineering techniques and phishing emails. USERS/STAFF Log off remote connections when not in use.Be vigilant against tailored spearphishing attacks targeting corporate and personal accounts (including both email and social media accounts).Use different passwords for corporate and personal accounts.Install antivirus software on personal devices to automatically scan and quarantine suspicious files.Employ strong multi-factor authentication for personal accounts, if available.Exercise caution when:Opening email attachments, even if the attachment is expected and the sender appears to be known. SeeUsing Caution with Email Attachments.Using removable media (e.g., USB thumb drives, external drives, CDs). Opening email attachments, even if the attachment is expected and the sender appears to be known. SeeUsing Caution with Email Attachments.Using removable media (e.g., USB thumb drives, external drives, CDs). IT STAFF/CYBERSECURITY PERSONNEL Segment and segregate networks and functions.Change the default username and password of applications and appliances.Employ strong multi-factor authentication for corporate accounts.Deploy antivirus software on organizational devices to automatically scan and quarantine suspicious files.Apply encryption to data at rest and data in transit.Use email security appliances to scan and remove malicious email attachments or links.Monitor key internal security tools and identify anomalous behavior. Flag any known indicators of compromise or threat actor behaviors for immediate response.Organizations can implement mitigations of varying complexity and restrictiveness to reduce the risk posed by threat actors who use Tor (The Onion Router) to carry out malicious activities. See the CISA-FBI Joint Cybersecurity Advisory onDefending Against Malicious Cyber Activity Originating from Torfor mitigation options and additional information.Prevent exploitation of known software vulnerabilities by routinely applying software patches and upgrades. Foreign cyber threat actors continue to exploit publicly known—and often dated—software vulnerabilities against broad target sets, including public and private sector organizations. If these vulnerabilities are left unpatched, exploitation often requires few resources and provides threat actors with easy access to victim networks. Review CISA and FBI’sTop 10 Routinely Exploited Vulnerabilitiesand other CISA alerts that identify vulnerabilities exploited by foreign attackers.Implement an antivirus program and a formalized patch management process.Block certain websites and email attachments commonly associated with malware (e.g., .scr, .pif, .cpl, .dll, .exe).Block email attachments that cannot be scanned by antivirus software (e.g., .zip files).Implement Group Policy Object and firewall rules.Implement filters at the email gateway and block suspicious IP addresses at the firewall.Routinely audit domain and local accounts as well as their permission levels to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.Follow best practices for design and administration of the network to limit privileged account use across administrative tiers.Implement a Domain-Based Message Authentication, Reporting & Conformance (DMARC) validation system.Disable or block unnecessary remote services.Limit access to remote services through centrally managed concentrators.Deny direct remote access to internal systems or resources by using network proxies, gateways, and firewalls.Limit unnecessary lateral communications.Disable file and printer sharing services. If these services are required, use strong passwords or Active Directory authentication.Ensure applications do not store sensitive data or credentials insecurely.Enable a firewall on agency workstations, configured to deny unsolicited connection requests.Disable unnecessary services on agency workstations and servers.Scan for and remove suspicious email attachments; ensure any scanned attachment is its ""true file type"" (i.e., the extension matches the file header).Monitor users' web browsing habits; restrict access to suspicious or risky sites. Contact law enforcement or CISA immediately regarding any unauthorized network access identified.Visit the MITRE ATT&CK techniques and tactics pages linked in the ATT&CK Profile section above for additional mitigation and detection strategies for this malicious activity targeting think tanks."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-302a,"Mitigations For a downloadable copy of IOCs, seeAA20-302A.stix. For additional IOCs detailing this activity, seehttps://gist.github.com/aaronst/6aa7f61246f53a8dd4befea86e832456. PLANS AND POLICIES CISA, FBI, and HHS encourage HPH Sector organizations to maintain business continuity plans—the practice of executing essential functions through emergencies (e.g., cyberattacks)—to minimize service interruptions. Without planning, provision, and implementation of continuity principles, organizations may be unable to continue operations. Evaluating continuity and capability will help identify continuity gaps. Through identifying and addressing these gaps, organizations can establish a viable continuity program that will help keep them functioning during cyberattacks or other emergencies. CISA, FBI, and HHS suggest HPH Sector organizations review or establish patching plans, security policies, user agreements, and business continuity plans to ensure they address current threats posed by malicious cyber actors. NETWORK BEST PRACTICES Patch operating systems, software, and firmware as soon as manufacturers release updates.Check configurations for every operating system version for HPH organization-owned assets to prevent issues from arising that local users are unable to fix due to having local administration disabled.Regularly change passwords to network systems and accounts and avoid reusing passwords for different accounts.Use multi-factor authentication where possible.Disable unused remote access/Remote Desktop Protocol (RDP) ports and monitor remote access/RDP logs.Implement application and remote access allow listing to only allow systems to execute programs known and permitted by the established security policy.Audit user accounts with administrative privileges and configure access controls with least privilege in mind.Audit logs to ensure new accounts are legitimate.Scan for open or listening ports and mediate those that are not needed.Identify critical assets such as patient database servers, medical records, and teleheatlh and telework infrastructure; create backups of these systems and house the backups offline from the network.Implement network segmentation. Sensitive data should not reside on the same server and network segment as the email environment.Set antivirus and anti-malware solutions to automatically update; conduct regular scans. RANSOMWARE BEST PRACTICES CISA, FBI and HHS do not recommend paying ransoms. Payment does not guarantee files will be recovered. It may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. In addition to implementing the above network best practices, the FBI, CISA and HHS also recommend the following: Regularly back up data, air gap, and password protect backup copies offline.Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, secure location. USER AWARENESS BEST PRACTICES Focus on awareness and training. Because end users are targeted, make employees and stakeholders aware of the threats—such as ransomware and phishing scams—and how they are delivered. Additionally, provide users training on information security principles and techniques as well as overall emerging cybersecurity risks and vulnerabilities.Ensure that employees know who to contact when they see suspicious activity or when they believe they have been a victim of a cyberattack. This will ensure that the proper established mitigation strategy can be employed quickly and efficiently. RECOMMENDED MITIGATION MEASURES System administrators who have indicators of a TrickBot network compromise should immediately take steps to back up and secure sensitive or proprietary data. TrickBot infections may be indicators of an imminent ransomware attack; system administrators should take steps to secure network devices accordingly. Upon evidence of a TrickBot infection, review DNS logs and use theXORkey of0xB9to decodeXORencoded DNS requests to reveal the presence ofAnchor_DNS, and maintain and provide relevant logs."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-296a,"Mitigations INDICATORS OF COMPROMISE The APT actor used the following IP addresses and domains to carry out its objectives: 213.74.101[.]65213.74.139[.]196212.252.30[.]1705.196.167[.]18437.139.7[.]16149.56.20[.]5591.227.68[.]97138.201.186[.]435.45.119[.]124193.37.212[.]43146.0.77[.]6051.159.28[.]101columbusairports.microsoftonline[.]hostmicrosoftonline[.]hostemail.microsoftonline[.]servicesmicrosoftonline[.]servicescityname[.]westus2.cloudapp.azure.com IP address51.159.28[.]101appears to have been configured to receive stolen Windows New Technology Local Area Network Manager (NTLM) credentials. FBI and CISA recommend organizations take defensive actions to mitigate the risk of leaking NTLM credentials; specifically, organizations should disable NTLM or restrict outgoing NTLM. Organizations should consider blocking IP address51.159.28[.]101(although this action alone may not mitigate the threat, as the APT actor has likely established, or will establish, additional infrastructure points). Organizations should check available logs for traffic to/from IP address51.159.28[.]101for indications of credential-harvesting activity. As the APT actors likely have—or will—establish additional infrastructure points, organizations should also monitor for Server Message Block (SMB) or WebDAV activity leaving the network to other IP addresses. Refer toAA20-296A.stixfor a downloadable copy of IOCs. NETWORK DEFENSE-IN-DEPTH Proper network defense-in-depth and adherence to information security best practices can assist in mitigating the threat and reducing the risk to critical infrastructure. The following guidance may assist organizations in developing network defense procedures. Keep all applications updated according to vendor recommendations, and especially prioritize updates for external facing applications and remote access services to address CVE-2019-19781, CVE-2020-0688, CVE 2019-10149, CVE-2018-13379, and CVE-2020-1472. Refer to table 1 for patch information on these CVEs. Table 1: Patch information for CVEs Citrix Application Delivery ControllerCitrix GatewayCitrix SDWAN WANOP  Citrix blog post: firmware updates for Citrix ADC and Citrix Gateway versions 11.1 and 12.0 Citrix blog post: security updates for Citrix SD-WAN WANOP release 10.2.6 and 11.0.3 Citrix blog post: firmware updates for Citrix ADC and Citrix Gateway versions 12.1 and 13.0 Citrix blog post: firmware updates for Citrix ADC and Citrix Gateway version 10.5 Microsoft Exchange Server 2010 Service Pack 3 Update Rollup 30Microsoft Exchange Server 2013 Cumulative Update 23Microsoft Exchange Server 2016 Cumulative Update 14Microsoft Exchange Server 2016 Cumulative Update 15Microsoft Exchange Server 2019 Cumulative Update 3Microsoft Exchange Server 2019 Cumulative Update 4  Exim versions 4.87–4.91 FortiOS 6.0: 6.0.0 to 6.0.4FortiOS 5.6: 5.6.3 to 5.6.7FortiOS 5.4: 5.4.6 to 5.4.12 Windows Server 2008 R2 for x64-based Systems Service Pack 1Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)Windows Server 2012Windows Server 2012 (Server Core installation)Windows Server 2012 R2Windows Server 2016Windows Server 2019Windows Server 2019 (Server Core installation)Windows Server, version 1903  (Server Core installation)Windows Server, version 1909  (Server Core installation)Windows Server, version 2004   (Server Core installation) Microsoft Security Advisory for CVE-2020-1472   Follow Microsoft’sguidanceon monitoring logs for activity related to the Netlogon vulnerability, CVE-2020-1472.If appropriate for your organization’s network, prevent external communication of all versions of SMB and related protocols at the network boundary by blocking Transmission Control Protocol (TCP) ports 139 and 445 and User Datagram Protocol (UDP) port 137. See the CISA publication onSMB Security Best Practicesfor more information.Implement the prevention, detection, and mitigation strategies outlined in:CISA AlertTA15-314A – Compromised Web Servers and Web Shells – Threat Awareness and Guidance.National Security Agency Cybersecurity Information SheetU/OO/134094-20 – Detect and Prevent Web Shells Malware.Isolate external facing services in a network demilitarized zone (DMZ) since they are more exposed to malicious activity; enable robust logging, and monitor the logs for signs of compromise.Establish a training mechanism to inform end users on proper email and web usage, highlighting current information and analysis and including common indicators of phishing. End users should have clear instructions on how to report unusual or suspicious emails.Implement application controls to only allow execution from specified application directories. System administrators may implement this through Microsoft Software Restriction Policy, AppLocker, or similar software. Safe defaults allow applications to run fromPROGRAMFILES,PROGRAMFILES(X86), andWINDOWSfolders. All other locations should be disallowed unless an exception is granted.Block Remote Desktop Protocol (RDP) connections originating from untrusted external addresses unless an exception exists; routinely review exceptions on a regular basis for validity. CISA AlertTA15-314A – Compromised Web Servers and Web Shells – Threat Awareness and Guidance.National Security Agency Cybersecurity Information SheetU/OO/134094-20 – Detect and Prevent Web Shells Malware. COMPREHENSIVE ACCOUNT RESETS For accounts where NTLM password hashes or Kerberos tickets may have been compromised (e.g., through CVE-2020-1472), a double-password-reset may be required in order to prevent continued exploitation of those accounts. For domain-admin-level credentials, a reset of KRB-TGT “Golden Tickets” may be required, and Microsoft has released specializedguidancefor this. Such a reset should be performed very carefully if needed. If there is an observation ofCVE-2020-1472Netlogon activity or other indications of valid credential abuse, it should be assumed the APT actors have compromised AD administrative accounts. In such cases, the AD forest should not be fully trusted, and, therefore, a new forest should be deployed. Existing hosts from the old compromised forest cannot be migrated in without being rebuilt and rejoined to the new domain, but migration may be done through “creative destruction,” wherein, as endpoints in the legacy forest are decommissioned, new ones can be built in the new forest. This will need to be completed in on-premise—as well as in Azure-hosted—AD instances. Note that fully resetting an AD forest is difficult and complex; it is best done with the assistance of personnel who have successfully completed the task previously. It is critical to perform a full password reset on all user and computer accounts in the AD forest. Use the following steps as a guide. Create a temporary administrator account, and use this account only for all administrative actionsReset the Kerberos Ticket Granting Ticket(krbtgt) password;[1] this must be completed before any additional actions (a second reset will take place in step 5)Wait for thekrbtgtreset to propagate to all domain controllers (time may vary)Reset all account passwords (passwords should be 15 characters or more and randomly assigned):User accounts (forced reset with no legacy password reuse)Local accounts on hosts (including local accounts not covered by Local Administrator Password Solution [LAPS])Service accountsDirectory Services Restore Mode (DSRM) accountDomain Controller machine accountApplication passwordsReset thekrbtgtpassword againWait for thekrbtgtreset to propagate to all domain controllers (time may vary)Reboot domain controllersReboot all endpoints User accounts (forced reset with no legacy password reuse)Local accounts on hosts (including local accounts not covered by Local Administrator Password Solution [LAPS])Service accountsDirectory Services Restore Mode (DSRM) accountDomain Controller machine accountApplication passwords The following accounts should be reset: AD Kerberos Authentication Master (2x)All Active Directory AccountsAll Active Directory Admin AccountsAll Active Directory Service AccountsAll Active Directory User AccountsDSRM Account on Domain ControllersNon-AD Privileged Application AccountsNon-AD Unprivileged Application AccountsNon-Windows Privileged AccountsNon-Windows User AccountsWindows Computer AccountsWindows Local Admin VPN VULNERABILITIES Implement the following recommendations to secure your organization’s VPNs: Update VPNs, network infrastructure devices, and devicesbeing used to remote into work environments with the latest software patches and security configurations. See CISA TipsUnderstanding Patches and Software Updatesand Securing Network Infrastructure Devices. Wherever possible, enable automatic updates.Implement MFA on all VPN connections to increase security. Physical security tokens are the most secure form of MFA, followed by authenticator app-based MFA. SMS and email-based MFA should only be used when no other forms are available. If MFA is not implemented, require teleworkers to use strong passwords. See CISA TipsChoosing and Protecting PasswordsandSupplementing Passwordsfor more information. Discontinue unused VPN servers. Reduce your organization’s attack surface by discontinuing unused VPN servers, which may act as a point of entry for attackers. To protect your organization against VPN vulnerabilities: Auditconfiguration and patch management programs.Monitornetwork traffic for unexpected and unapproved protocols, especially outbound to the Internet (e.g., Secure Shell [SSH], SMB, RDP).ImplementMFA, especially for privileged accounts.Useseparate administrative accounts on separate administration workstations.Keepsoftware up to date. Enable automatic updates, if available."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-283a,"Mitigations Organizations with externally facing infrastructure devices that have the vulnerabilities listed in this joint cybersecurity advisory, or other vulnerabilities, should move forward with an “assume breach” mentality. As initial exploitation and escalation may be the only observable exploitation activity, most mitigations will need to focus on more traditional network hygiene and user management activities."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-280a,"Mitigations CISA and MS-ISAC recommend that network defenders—in federal, state, local, tribal, territorial governments, and the private sector—consider applying the following best practices to strengthen the security posture of their organization's systems. System owners and administrators should review any configuration changes prior to implementation to avoid unwanted impacts. Block email attachments commonly associated with malware (e.g.,.dll and .exe).Block email attachments that cannot be scanned by antivirus software (e.g., .zip files).Implement Group Policy Object and firewall rules.Implement an antivirus program and a formalized patch management process.Implement filters at the email gateway, and block suspicious IP addresses at the firewall.Adhere to the principle of least privilege.Implement a Domain-Based Message Authentication, Reporting & Conformance validation system.Segment and segregate networks and functions.Limit unnecessary lateral communications.Disable file and printer sharing services. If these services are required, usestrong passwordsor Active Directory authentication.Enforce multi-factor authentication.Exercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. SeeUsing Caution with Email Attachments.Enable a firewall on agency workstations, configured to deny unsolicited connection requests.Disable unnecessary services on agency workstations and servers.Scan for and remove suspicious email attachments; ensure the scanned attachment is its ""true file type"" (i.e., the extension matches the file header).Monitor users' web browsing habits; restrict access to suspicious or risky sites.Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).Scan all software downloaded from the internet prior to executing.Maintain situational awareness of the latest threats and implement appropriate access control lists.Visit the MITRE ATT&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies.See CISA’s Alert onTechnical Approaches to Uncovering and Remediating Malicious Activityfor more information on addressing potential incidents and applying best practice incident response procedures.See the jointCISA and MS-ISAC Ransomware Guideon how to be proactive and prevent ransomware attacks from happening and for a detailed approach on how to respond to an attack and best resolve the cyber incident. For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800-83,Guide to Malware Incident Prevention and Handling for Desktops and Laptops."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-266a,"Mitigations CISA and MS-ISAC recommend that federal, state, local, tribal, territorial government, private sector users, and network administrators consider applying the following best practices to strengthen the security posture of their organization's systems. System owners and administrators should review any configuration changes prior to implementation to avoid unwanted impacts. Maintain up-to-date antivirus signatures and engines. See Protecting Against Malicious Code.Keep operating system patches up to date. SeeUnderstanding Patches and Software Updates.Disable file and printer sharing services. If these services are required, usestrong passwordsor Active Directory authentication.Enforce multi-factor authentication. SeeSupplementing Passwordsfor more information.Restrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators’ group unless required.Enforce a strong password policy. SeeChoosing and Protecting Passwords.Exercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. See Using Caution with Email Attachments.Enable a personal firewall on agency workstations, configured to deny unsolicited connection requests.Disable unnecessary services on agency workstations and servers.Scan for and remove suspicious email attachments; ensure the scanned attachment is its ""true file type"" (i.e., the extension matches the file header).Monitor users' web browsing habits; restrict access to sites with unfavorable content.Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).Scan all software downloaded from the internet prior to executing.Maintain situational awareness of the latest threats and implement appropriate access control lists.Visit the MITRE ATT&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies. For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800-83,Guide to Malware Incident Prevention and Handling for Desktops and Laptops."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-259a,"Mitigations RECOMMENDATIONS CISA and FBI recommend implementing the following recommendations. If your organization has not patched for the Citrix CVE-2019-19781 vulnerability, and a compromise is suspected, follow the recommendations in CISA AlertAA20-031A.This threat actor has been observed targeting other CVEs mentioned in this report; follow the recommendations in the CISA resources provided below.If using Windows Active Directory and compromise is suspected, conduct remediation of the compromised Windows Active Directory forest.If compromised, rebuild/reimage compromised NetScaler devices.Routinely audit configuration and patch management programs.Monitor network traffic for unexpected and unapproved protocols, especially outbound to the internet (e.g., SSH, SMB, RDP).Implement multi-factor authentication, especially for privileged accounts.Use separate administrative accounts on separate administration workstations.Implement the principle of least privilege on data access.Secure RDP and other remote access solutions using multifactor authentication and “jump boxes” for access.Deploy endpoint defense tools on all endpoints; ensure they work and are up to date.Keep software up to date. If compromised, rebuild/reimage compromised NetScaler devices."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-245a,"Mitigations The following recommendations and best practices may be helpful during the investigation and remediation process.Note:Although this guidance provides best practices to mitigate common attack vectors, organizations should tailor mitigations to their network. GENERAL MITIGATION GUIDANCE The FTP and Telnet protocols transmit credentials in cleartext, which are susceptible to being intercepted. To mitigate this risk, discontinue FTP and Telnet services by moving to more secure file storage/file transfer and remote access services. Evaluate business needs and justifications to host files on alternative Secure File Transfer Protocol (SFTP) or HTTPS-based public sites.Use Secure Shell (SSH) for access to remote devices and servers. Investigate the business needs and justification for allowing traffic from non-approved VPN services.Identify such services across the enterprise and develop measures to add the application and browser plugins that enable non-approved VPN services to the denylist.Enhance endpoint monitoring to obtain visibility on devices with non-approved VPN services running. Enhanced endpoint monitoring and detection capabilities would enable an organization’s IT security personnel to manage approved software as well as identify and remove any instances of unapproved software. Cyber actors regularly identify servers that are out of date or end of life (EOL) to gain access to a network and perform malicious activities. These present easy and safe locations to maintain persistence on a network.Often these services and servers are systems that have begun decommissioning, but the final stage has not been completed by shutting down the system. This means they are still running and vulnerable to compromise.Ensuring that decommissioning of systems has been completed or taking appropriate action to remove them from the network limits their susceptibility and reduces the investigative surface to be analyzed. Note:proceed with caution to avoid the adverse effects detailed in the Common Mistakes in Incident Handling section above. Reimage or remove any compromised systems found on the network.Monitor and educate users to be cautious of any downloads from third-party sites or vendors.Block the known bad domains and add a web content filtering capability to block malicious sites by category to prevent future compromise.Sanitize removable media and investigate network shares accessible by users.Improve existing network-based malware detection tools with sandboxing capabilities. Identify and disable ports, protocols, and services not needed for official business to prevent would-be attackers from moving laterally to exploit vulnerabilities. This includes external communications as well as communications between networks.Document allowed ports and protocols at the enterprise level.Restrict inbound and outbound access to ports and protocols not justified for business use.Restrict allowed access list to assets justified by business use.Enable a firewall log for inbound and outbound network traffic as well as allowed and denied traffic. Service accounts are privileged accounts dedicated to certain services to perform activities related to the service or application without being tied to a single domain user. Given that services tend to be privileged accounts and thereby have administrative privileges, they are often a target for attackers aiming to obtain credentials. Interactive login to a service account not directly tied to an end-user account makes it difficult to identify accountability during cyber incidents. Audit the Active Directory (AD) to identify and document active service accounts.Restrict use of service accounts using AD group policy.Disallow interactive login by adding service account to a group of non-interactive login users.Continuously monitor service account activities by enhancing logging.Rotate service accounts and apply password best practices without service, degradation, or disruption. If an attacker (or malware) gains access to a remote user’s computer, steals authentication data (login/password), hijacks an active remote administration session, or successfully attacks a vulnerability in the remote administration tool’s software, the attacker (or malware) will gain unrestricted control of the enterprise network environment. Attackers can use compromised hosts as a relay server for reverse connections, which could enable them to connect to these remote administration tools from anywhere.Remove all remote administration tools that are not required for day-to-day IT operations. Closely monitor and log events for each remote-control session required by department IT operations. Allowing unrestricted RDP access can increase opportunities for malicious activity such as on path and Pass-the-Hash (PtH) attacks. Implement secure remote desktop gateway solutions.Restrict RDP service trust across multiple network zones.Implement privileged account monitoring and short time password lease for RDP service use.Implement enhanced and continuous monitoring of RDP services by enabling logging and ensure RDP logins are captured in the logs. Credential resets need to be done to strategically ensure that all the compromised accounts and devices are included and to reduce the likelihood that the attacker is able to adapt in response to this. Force password resets; revoke and issue new certificates for affected accounts/devices.If it is suspected that the attacker has gained access to the Domain Controller, then the passwords for all local accounts—such as Guest, HelpAssistant, DefaultAccount, System, Administrator, andkbrtgt—should be reset. It is essential that the password for thekbrtgtaccount is reset as this account is responsible for handling Kerberos ticket requests as well as encrypting and signing them. The account should be reset twice (as the account has a two-password history).The first account reset for thekbrtgtneeds to be allowed to replicate prior to the second reset to avoid any issues.If it is suspected that thentds.ditfile has been exfiltrated, then all domain user passwords will need to be reset.Review access policies to temporarily revoke privileges/access for affected accounts/devices. If it is necessary to not alert the attacker (e.g., for intelligence purposes), then privileges can be reduced for affected accounts/devices to “contain” them. The first account reset for thekbrtgtneeds to be allowed to replicate prior to the second reset to avoid any issues. Attackers frequently exploit software or hardware vulnerabilities to gain access to a targeted system. Known vulnerabilities in external facing devices and servers should be patched immediately, starting with the point of compromise, if known.Ensure external-facing devices have not been previously compromised while going through the patching process.If the point of compromise (i.e., the specific software, device, server) is known, but how the software, device, or server was exploited is unknown, notify the vendor so they can begin analysis and develop a new patch.Follow vendor remediation guidance including the installation of new patches as soon as they become available. Ensure external-facing devices have not been previously compromised while going through the patching process. GENERAL RECOMMENDATIONS AND BEST PRACTICES PRIOR TO AN INCIDENT Properly implemented defensive techniques and programs make it more difficult for a threat actor to gain access to a network and remain persistent yet undetected. When an effective defensive program is in place, attackers should encounter complex defensive barriers. Attacker activity should also trigger detection and prevention mechanisms that enable organizations to identify, contain, and respond to the intrusion quickly. There is no single technique, program, or set of defensive techniques or programs that will completely prevent all attacks. The network administrator should adopt and implement multiple defensive techniques and programs in a layered approach to provide a complex barrier to entry, increase the likelihood of detection, and decrease the likelihood of a successful attack. This layered mitigation approach is known as defense-in-depth. End users are the frontline security of the organizations. Educating them in security principles as well as actions to take and not take during an incident will increase the organization’s resilience and might prevent easily avoidable compromises. Educate users to be cautious of any downloads from third-party sites or vendors.Train users on recognizing phishing emails. There are several systems and services (free and otherwise) that can be deployed or leveraged.Train users on identifying which groups/individuals to contact when they suspect an incident.Train users on the actions they can and cannot take if they suspect an incident and why (some users will attempt to remediate and might make things worst). Enable application directory allowlisting through Microsoft Software Restriction Policy or AppLocker.Use directory allowlisting rather than attempting to list every possible permutation of applications in a network environment. Safe defaults allow applications to run fromPROGRAMFILES,PROGRAMFILES(X86), andSYSTEM32. Disallow all other locations unless an exception is granted.Prevent the execution of unauthorized software by using application allowlisting as part of the OS installation and security hardening process. Decrease a threat actor’s ability to access key network resources by implementing the principle of least privilege.Limit the ability of a local administrator account to log in from a local interactive session (e.g., Deny access to this computer from the network) and prevent access via an RDP session.Remove unnecessary accounts and groups; restrict root access.Control and limit local administration; e.g. implementing Just Enough Administration (JEA), just-in-time (JIT) administration, or enforcing PowerShell Constrained Language mode via a User Mode Code Integrity (UMCI) policy.Make use of the Protected Users Active Directory group in Windows domains to further secure privileged user accounts against pass-the-hash attacks. Identify what data is essential to keeping operations running; make regular backup copies.Test that backups are working to ensure they can restore the data in the event of an incident.Create offline backups to help recover from a ransomware attack or from disasters (fire, flooding, etc.).Securely store offline backups at an offsite location. If feasible, choose an offsite location that is at a distance from the primary location that would be unaffected in the event of a regional natural disaster. Create and deploy a secure system baseline image to all workstations.Mitigate potential exploitation by threat actors by following a normal patching cycle for all OSs, applications, and software, with exceptions for emergency patches.Apply asset and patch management processes.Reduce the number of cached credentials to one (if a laptop) or zero (if a desktop or fixed asset). Configure and monitor workstation system logs through a host-based endpoint detection and response platform and firewall.Deploy an anti-malware solution on workstations to prevent spyware, adware, and malware as part of the OS security baseline.Ensure that your anti-malware solution remains up to date.Monitor antivirus scan results on a regular basis. Ensure that your anti-malware solution remains up to date. Create a secure system baseline image and deploy it to all servers.Upgrade or decommission end-of-life non-Windows servers.Upgrade or decommission servers running Windows Server 2003 or older versions.Implement asset and patch management processes.Audit for and disable unnecessary services. Establish remote server logging and retention.Reduce the number of cached credentials to zero.Configure and monitor system logs via a centralized security information and event management (SIEM) appliance.Add an explicitDENYfor%USERPROFILE%.Restrict egress web traffic from servers.In Windows environments, use Restricted Admin mode or remote credential guard to further secure remote desktop sessions against pass-the-hash attacks.Restrict anonymous shares.Limit remote access by only using jump servers for such access.On Linux, use SELINUX or AppArmor in enforcing mode and/or turn on audit logging.Turn on bash shell logging; ship this and all logs to a remote server.Do not allow users to usesu. UseSudo -linstead.Configure automatic updates in yum or apt.Mount/var/tmpand/tmpasnoexec. Create a change control process for all implemented changes. Implement an intrusion detection system (IDS).Apply continuous monitoring.Send alerts to a SIEM tool.Monitor internal activity (this tool may use the same tap points as the netflow generation tools).Employ netflow capture.Set a minimum retention period of 180 days.Capture netflow on all ingress and egress points of network segments, not just at the Managed Trusted Internet Protocol Services or Trusted Internet Connections locations.Capture all network trafficRetain captured traffic for a minimum of 24 hours.Capture traffic on all ingress and egress points of the network.Use VPNMaintain site-to-site VPN with customers and vendors.Authenticate users utilizing site-to-site VPNs.Use authentication, authorization, and accounting for controlling network access.Require smartcard authentication to an HTTPS page in order to control access. Authentication should also require explicit rostering of permitted smartcard distinguished names to enhance the security posture on both networks participating in the site-to-site VPN.Establish appropriate secure tunneling protocol and encryption.Strengthen router configuration (e.g., avoid enabling remote management over the internet and using default IP ranges, automatically log out after configuring routers, and use encryption.).Turn off Wi-Fi protected setup, enforce the use of strong passwords, and keep router firmware up-to-date.Improve firewall security (e.g., enable automatic updates, revise firewall rules as appropriate, implement allowlists, establish packet filtering, enforce the use of strong passwords, encrypt networks).Whenever possible, ensure access to network devices via external or untrusted networks (specifically the internet) is disabled.Manage access to the internet (e.g., providing internet access from only devices/accounts that need it, proxying all connections, disabling internet access for privileged/administrator accounts, enabling policies that restrict internet access using a blocklist, a resource allowlist, content type, etc.)Conduct regular vulnerability scans of the internal and external networks and hosted content to identify and mitigate vulnerabilities.Define areas within the network that should be segmented to increase the visibility of lateral movement by a threat and increase the defense-in-depth posture.Develop a process to block traffic to IP addresses and domain names that have been identified as being used to aid previous attacks.Evaluate and consider the security configurations of Microsoft Office 365 (O365) and other cloud collaboration service platforms prior to deployment.Use multi-factor authentication. This is the best mitigation technique to protect against credential theft for O365 administrators and users.Protect Global Admins from compromise and use the principle of “Least Privilege.”Enable unified audit logging in the Security and Compliance Center.Enable alerting capabilities.Integrate with organizational SIEM solutions.Disable legacy email protocols, if not required, or limit their use to specific users. Apply continuous monitoring.Send alerts to a SIEM tool.Monitor internal activity (this tool may use the same tap points as the netflow generation tools). Set a minimum retention period of 180 days.Capture netflow on all ingress and egress points of network segments, not just at the Managed Trusted Internet Protocol Services or Trusted Internet Connections locations. Retain captured traffic for a minimum of 24 hours.Capture traffic on all ingress and egress points of the network. Maintain site-to-site VPN with customers and vendors.Authenticate users utilizing site-to-site VPNs.Use authentication, authorization, and accounting for controlling network access.Require smartcard authentication to an HTTPS page in order to control access. Authentication should also require explicit rostering of permitted smartcard distinguished names to enhance the security posture on both networks participating in the site-to-site VPN. Whenever possible, ensure access to network devices via external or untrusted networks (specifically the internet) is disabled. Conduct regular vulnerability scans of the internal and external networks and hosted content to identify and mitigate vulnerabilities.Define areas within the network that should be segmented to increase the visibility of lateral movement by a threat and increase the defense-in-depth posture.Develop a process to block traffic to IP addresses and domain names that have been identified as being used to aid previous attacks. Use multi-factor authentication. This is the best mitigation technique to protect against credential theft for O365 administrators and users.Protect Global Admins from compromise and use the principle of “Least Privilege.”Enable unified audit logging in the Security and Compliance Center.Enable alerting capabilities.Integrate with organizational SIEM solutions.Disable legacy email protocols, if not required, or limit their use to specific users. Create a secure system baseline image and deploy it to all networking equipment (e.g., switches, routers, firewalls).Remove unnecessary OS files from the internetwork operating system (IOS). This will limit the possible targets of persistence (i.e., files to embed malicious code) if the device is compromised and will align with National Security Agency Network Device Integrity best practices.Remove vulnerable IOS OS files (i.e., older iterations) from the device’s boot variable (i.e., show boot or show bootvar).Update to the latest available operating system for IOS devices.On devices with a Secure Sockets Layer VPN enabled, routinely verify customized web objects against the organization’s known good files for such VPNs, to ensure the devices remain free of unauthorized modification.Ensure that any incident response tools that point to external domains are either removed or updated to point to internal security tools. If this is not done and an external domain to which a tool points expires, a malicious threat actor may register it and start collecting telemetry from the infrastructure. Implement policies to block workstation-to-workstation RDP connections through a Group Policy Object on Windows, or by a similar mechanism.Store system logs of mission critical systems for at least one year within a SIEM tool.Review the configuration of application logs to verify that recorded fields will contribute to an incident response investigation. Reduce the number of domain and enterprise administrator accounts.Create non-privileged accounts for privileged users and ensure they use the non- privileged accounts for all non-privileged access (e.g., web browsing, email access).If possible, use technical methods to detect or prevent browsing by privileged accounts (authentication to web proxies would enable blocking of Domain Administrators).Use two-factor authentication (e.g., security tokens for remote access and access to any sensitive data repositories).If soft tokens are used, they should not exist on the same device that is requesting remote access (e.g., a laptop) and instead should be on a smartphone, token, or other out-of-band device.Create privileged role tracking.Create a change control process for all privilege escalations and role changes on user accounts.Enable alerts on privilege escalations and role changes.Log privileged user changes in the network environment and create an alert for unusual events.Establish least privilege controls.Implement a security-awareness training program. Proper network segmentation is a very effective security mechanism to prevent an intruder from propagating exploits or laterally moving around an internal network. On a poorly segmented network, intruders are able to extend their impact to control critical devices or gain access to sensitive data and intellectual property. Security architects must consider the overall infrastructure layout, segmentation, and segregation. Segregation separates network segments based on role and functionality. A securely segregated network can contain malicious occurrences, reducing the impact from intruders, in the event that they have gained a foothold somewhere inside the network. Local Area Network (LAN) segments are separated by traditional network devices such as routers. Routers are placed between networks to create boundaries, increase the number of broadcast domains, and effectively filter users’ broadcast traffic. These boundaries can be used to contain security breaches by restricting traffic to separate segments and can even shut down segments of the network during an intrusion, restricting adversary access. Recommendations: Implement Principles of Least Privilege and need-to-know when designing network segments.Separate sensitive information and security requirements into network segments.Apply security recommendations and secure configurations to all network segments and network layers. As technologies change, new strategies are developed to improve IT efficiencies and network security controls. Virtual separation is the logical isolation of networks on the same physical network. The same physical segmentation design principles apply to virtual segmentation but no additional hardware is required. Existing technologies can be used to prevent an intruder from breaching other internal network segments. Recommendations: Use Private Virtual LANs to isolate a user from the rest of the broadcast domains.Use Virtual Routing and Forwarding (VRF) technology to segment network traffic over multiple routing tables simultaneously on a single router.Use VPNs to securely extend a host/network by tunneling through public or private networks. ADDITIONAL BEST PRACTICES Implement a vulnerability assessment and remediation program.Encrypt all sensitive data in transit and at rest.Create an insider threat program.Assign additional personnel to review logging and alerting data.Complete independent security (not compliance) audits.Create an information sharing program.Complete and maintain network and system documentation to aid in timely incident response, including:Network diagrams,Asset owners,Type of asset, andAn up-to-date incident response plan. Network diagrams,Asset owners,Type of asset, andAn up-to-date incident response plan."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-239a,"Mitigations Contact law enforcement, CISA, or Treasury immediately regarding any identified activity related to BeagleBoyz. (Refer to the Contact Information section.)Incorporate IOCs identified in CISA’s Malware Analysis Reports onhttps://us-cert.cisa.gov/northkoreainto intrusion detection systems and security alert systems to enable active blocking or reporting of suspected malicious activity."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-227a,"Mitigations CISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts. Maintain up-to-date antivirus signatures and engines. SeeProtecting Against Malicious Code.Keep operating system patches up to date. SeeUnderstanding Patches and Software Updates.Disable file and printer sharing services. If these services are required, usestrong passwordsor Active Directory authentication.Restrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators’ group unless required.Enforce a strong password policy. SeeChoosing and Protecting Passwords.Exercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. SeeUsing Caution with Email Attachments.Enable a personal firewall on agency workstations, configured to deny unsolicited connection requests.Disable unnecessary services on agency workstations and servers.Scan for and remove suspicious email attachments; ensure the scanned attachment is its ""true file type"" (i.e., the extension matches the file header).Monitor users' web browsing habits; restrict access to sites with unfavorable content.Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).Scan all software downloaded from the internet prior to executing.Maintain situational awareness of the latest threats and implement appropriate access control lists.Visit the MITRE ATT&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies. For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800-83, ""Guide to Malware Incident Prevention and Handling for Desktops and Laptops."""
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-225a,"Mitigations CISA recommends using the following best practices to strengthen the security posture of an organization's systems. System owners and administrators should review any configuration change prior to implementation to avoid unwanted impacts. Include warning banners for all emails external to the organization.Maintain up-to-date antivirus signatures and engines. SeeProtecting Against Malicious Code.Ensure systems have the latest security updates. SeeUnderstanding Patches and Software Updates.Disable file and printer sharing services. If these services are required, use strong passwords or Active Directory authentication.Restrict users' permissions to install and run unwanted software applications. Do not add users to the local administrators’ group unless required.Enforce a strong password policy. SeeChoosing and Protecting Passwords.Exercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. SeeUsing Caution with Email Attachments.Enable a personal firewall on agency workstations that is configured to deny unsolicited connection requests.Disable unnecessary services on agency workstations and servers.Scan for and remove suspicious email attachments; ensure the scanned attachment is its ""true file type"" (i.e., the extension matches the file header).Monitor users' web browsing habits; restrict access to sites with unfavorable content.Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).Scan all software downloaded from the internet prior to executing.Maintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs). Sign up to receive CISA’s alerts on security topics and threats.Sign upfor CISA’s free vulnerability scanning and testing services to help organizations secure internet-facing systems from weak configuration and known vulnerabilities. Emailvulnerability@cisa.dhs.govto sign up. Seehttps://www.cisa.gov/cyber-resource-hubfor more information about vulnerability scanning and other CISA cybersecurity assessment services."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-209a,"Mitigations As stated above, once a device has been infected, attackers have been known to make it impossible for administrators to successfully run the needed firmware updates. This makes it extremely important for organizations to ensure their devices have not been previously compromised.Organizations that are still running a vulnerable version should take the following steps to ensure the device is not left vulnerable: Scan the device with the latest version of Malware Remover,available inQNAP App Center, to detect and remove QSnatch or other malware.If the installation via App Center fails, manually install Malware Remover followingthis QNAP tutorial, or contactQNAP Technical Supportfor further assistance.Run a full factory reset on the device.Update the firmware to the latest version. If the installation via App Center fails, manually install Malware Remover followingthis QNAP tutorial, or contactQNAP Technical Supportfor further assistance. The usual checks to ensure that the latest updates are installed still apply.To prevent reinfection, this recommendation also applies to devices previously infected with QSnatch but from which the malware has been removed. To prevent QSnatch malware infections, CISA and NCSC strongly recommend that organizations take the recommended measures in QNAP’s November 2019 advisory.[2] CISA and NCSC also recommend organizations consider the following mitigations: Verify that you purchased QNAP devices from reputable sources.If sources are in question then, in accordance with the instructions above,scan the device with the latest version of the Malware Remover and run a full factory reset on the device prior to completing the firmware upgrade.For additional supply chain recommendations, see CISA’s tip onSecuring Network Infrastructure Devices.Block external connections when the device is intended to be used strictly for internal storage. If sources are in question then, in accordance with the instructions above,scan the device with the latest version of the Malware Remover and run a full factory reset on the device prior to completing the firmware upgrade.For additional supply chain recommendations, see CISA’s tip onSecuring Network Infrastructure Devices."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-206a,"Mitigations CISA strongly urges organizations that have not yet done so to upgrade their BIG-IP software to the corresponding patches for CVE-2020-5902. If organizations detect evidence of CVE-2020-5902 exploitation after patching and applying the detection measures in this alert, CISA recommends taking immediate action to reconstitute affected systems. Should an organization’s IT security personnel discover system compromise, CISA recommends they: Reimage compromised hostsProvision new account credentialsLimit access to the management interface to the fullest extent possibleImplement network segmentationNote:network segmentation is a very effective security mechanism to help prevent an intruder from propagating exploits or laterally moving within an internal network. Segregation separates network segments based on role and functionality. A securely segregated network can limit the spread of malicious occurrences, reducing the impact from intruders that gain a foothold somewhere inside the network. Note:network segmentation is a very effective security mechanism to help prevent an intruder from propagating exploits or laterally moving within an internal network. Segregation separates network segments based on role and functionality. A securely segregated network can limit the spread of malicious occurrences, reducing the impact from intruders that gain a foothold somewhere inside the network."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-198a,"Mitigations In addition to being knowledgeable about threat actor obfuscation techniques, CISA encourages incident responders to review the following best practices to strengthen the security posture of their systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts. Maintain up-to-date antivirus signatures and engines. SeeProtecting Against Malicious Code.Ensure systems have the latest security updates. SeeUnderstanding Patches and Software Updates.Disable file and printer sharing services. If these services are required, use strong passwords or Active Directory authentication.Restrict users' permissions to install and run unwanted software applications. Do not add users to the local administrators’ group unless required.Enforce a strong password policy. SeeChoosing and Protecting Passwords.Exercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. SeeUsing Caution with Email Attachments.Enable a personal firewall on agency workstations that is configured to deny unsolicited connection requests.Disable unnecessary services on agency workstations and servers.Scan for and remove suspicious email attachments; ensure the scanned attachment is its ""true file type"" (i.e., the extension matches the file header).Monitor users' web browsing habits; restrict access to sites with unfavorable content.Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).Scan all software downloaded from the internet prior to executing.Maintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs). Sign upto receive CISA’s alerts on security topics and threats. Sign up for CISA’s free vulnerability scanning and testing services to help organizations secure internet-facing systems from weak configuration and known vulnerabilities. Emailvulnerability_info@cisa.dhs.govto sign up. Seehttps://www.cisa.gov/cyber-resource-hubfor more information about vulnerability scanning and other CISA cybersecurity assessment services. Palo Alto Networks and IBM contributed to this Alert."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-195a,"Mitigations CISA strongly recommends organizations review SAP Security Note#2934135for more information and apply critical patches as soon as possible. CISA recommends prioritizing patching over application of individual mitigations. When patching, external facing systems should be urgently addressed, followed by internal systems. Patched versions of the affected components are available at theSAP One Support Launchpad. ADDITIONAL RECOMMENDATIONS CISA encourages users and administrators of SAP products to: Scan SAP systems for all known vulnerabilities, such as missing security patches, dangerous system configurations, and vulnerabilities in SAP custom code.Apply missing security patches immediately and institutionalize security patching as part of a periodic processEnsure secure configuration of your SAP landscapeIdentify and analyze the security settings of SAP interfaces between systems and applications to understand risks posed by these trust relationships.Analyze systems for malicious or excessive user authorizations.Monitor systems for indicators of compromise resulting from the exploitation of vulnerabilities.Monitor systems for suspicious user behavior, including both privileged and non-privileged users.Apply threat intelligence on new vulnerabilities to improve the security posture against advanced targeted attacks.Define comprehensive security baselines for systems and continuously monitor for compliance violations and remediate detected deviations. These recommendations apply to SAP systems in public, private, and hybrid cloud environments. See the Onapsis report on the“RECON” SAP Vulnerabilityfor more information. ACKNOWLEDGEMENTS SAP and Onapsis contributed to this Alert."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-183a,"Mitigations Organizations can implement mitigations of varying complexity and restrictiveness to reduce the risk posed by threat actors who use Tor to carry out malicious activities. However, mitigation actions can also impact the access of legitimate users who leverage Tor to protect their privacy when visiting an organization’s internet-facing assets. Organizations should evaluate their probable risk, available resources, and impact to legitimate, non-malicious, Tor users before applying mitigation actions. Most restrictive approach: Block all web traffic to and from public Tor entry and exit nodes.Organizations that wish to take a conservative or less resource-intensive approach to reduce the risk posed by threat actors’ use of Tor should implement tools that restrict all traffic—malicious and legitimate—to and from Tor entry and exit nodes. Of note, blocking known Tor nodes does not completely eliminate the threat of malicious actors using Tor for anonymity, as additional Tor network access points, or bridges, are not all listed publicly. See table 1 for the most restrictive mitigation practices. Require organization to maintain up-to-date lists of known Tor exit and entry node IP addresses. Public lists are available on the internet, but frequency of updates and accuracy varies depending on the source. The Tor Project maintains an authoritativelist. Set external policies to block incoming traffic from known Tor exit nodes to prevent malicious reconnaissance and exploit attempts. Network security tools (e.g., next-generation firewalls, proxies) may have configuration settings to apply these policies. Set internal policies to block outgoing traffic to Tor entry nodes to prevent data exfiltration and C2 traffic. Network security tools (e.g., next-generation firewalls, proxies) may have configuration settings to apply these policies.  Less restrictive approach: Tailor monitoring, analysis, and blocking of web traffic to and from public Tor entry and exit nodes.There are instances in which legitimate users may leverage Tor for internet browsing and other non-malicious purposes. For example, deployed military or other overseas voters may use Tor as part of the voting process to escape monitoring by foreign governments. Such users may use Tor when visiting elections-related websites, to check voter registration status, or to mark and then cast absentee ballots via email or web portal. Similarly, some users may use Tor to avoid tracking by advertisers when browsing the internet. Organizations that do not wish to block legitimate traffic to/from Tor entry/exit nodes should consider adopting practices that allow for network monitoring and traffic analysis for traffic from those nodes, and then consider appropriate blocking. This approach can be resource intensive but will allow greater flexibility and adaptation of defensive. Require the organization to maintain up-to-date lists of known Tor exit and entry node IP addresses. The Tor Project maintains an authoritativelist. Analyze traffic to determine normal patterns of behavior; legitimate vs. anomalous uses of Tor. Baseline existing Tor traffic to/from known entry/exit nodes over a period of months. Inspect traffic to understand legitimate traffic; level-set the organization’s risk tolerance for blocking or allowing Tor traffic to/from specific services. Institute behavioral signatures/rules to block unexpected/potentially malicious activity and allow legitimate activity. Examine activity between any ephemeral port and Tor IP—this could be malicious data exfiltration or C2 traffic (except where use of outbound Tor entry nodes is expected). Monitor for use of TCP/UDP ports 9001, 9030, 9040, 9050, 9051, 9150, and TCP ports 443* and 8443. Monitor and/or block inbound connections from Tor exit nodes to IP addresses and ports for which external connections are not expected (i.e., other than VPN gateways, mail ports, web ports). Associated ports are applicable for client -> guard/relay traffic monitoring and analysis but not monitoring for exit node -> a network destination. Monitor and examine any large dataflows between networks and Tor IP addresses, regardless of port, as this could be unauthorized data exfiltration. *Since port 443 is the most common port for secure web traffic, generically monitoring 443 may produce a high volume of false positives; network traffic tools can be used to assist in this analysis.  Blended approach: Block all Tor traffic to some resources, allow and monitor for others.Given the various licit and illicit uses of Tor, a blended approach may be an appropriate risk mitigation strategy for some organizations (i.e., intentionally allowing traffic to/from Tor only for specific websites and services where legitimate use may be expected and blocking all Tor traffic to/from non-excepted processes/services). This may require continuous re-evaluation as an entity considers its own risk tolerance associated with different applications. The level of effort to implement this approach is high."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-133a,"Mitigations This Alert provides mitigations for each of the top vulnerabilities identified above. In addition to the mitigations listed below, CISA, FBI, and the broader U.S. Government recommend that organizations transition away from any end-of-life software. Note:The lists of associated malware corresponding to each CVE below is not meant to be exhaustive but instead is intended to identify a malware family commonly associated with exploiting the CVE. CVE-2017-11882 Vulnerable Products: Microsoft Office 2007 SP3/2010 SP2/2013 SP1/2016 ProductsAssociated Malware: Loki, FormBook, Pony/FAREITMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2017-11882IOCs:https://www.us-cert.gov/ncas/analysis-reports/ar20-133e CVE-2017-0199 Vulnerable Products: Microsoft Office 2007 SP3/2010 SP2/2013 SP1/2016, Vista SP2, Server 2008 SP2, Windows 7 SP1, Windows 8.1Associated Malware: FINSPY, LATENTBOT, DridexMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2017-0199IOCs:https://www.us-cert.gov/ncas/analysis-reports/ar20-133g,https://www.us-cert.gov/ncas/analysis-reports/ar20-133h,https://www.us-cert.gov/ncas/analysis-reports/ar20-133p CVE-2017-5638 Vulnerable Products: Apache Struts 2 2.3.x before 2.3.32 and 2.5.x before 2.5.10.1Associated Malware: JexBossMitigation: Upgrade to Struts 2.3.32 or Struts 2.5.10.1More Detail:https://www.us-cert.gov/ncas/analysis-reports/AR18-312Ahttps://nvd.nist.gov/vuln/detail/CVE-2017-5638 https://www.us-cert.gov/ncas/analysis-reports/AR18-312Ahttps://nvd.nist.gov/vuln/detail/CVE-2017-5638 CVE-2012-0158 Vulnerable Products: Microsoft Office 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1; Office 2003 Web Components SP3; SQL Server 2000 SP4, 2005 SP4, and 2008 SP2, SP3, and R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2, and 2009 Gold and R2; Visual FoxPro 8.0 SP1 and 9.0 SP2; and Visual Basic 6.0Associated Malware: DridexMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://www.us-cert.gov/ncas/alerts/aa19-339ahttps://nvd.nist.gov/vuln/detail/CVE-2012-0158IOCs:https://www.us-cert.gov/ncas/analysis-reports/ar20-133i,https://www.us-cert.gov/ncas/analysis-reports/ar20-133j,https://www.us-cert.gov/ncas/analysis-reports/ar20-133k,https://www.us-cert.gov/ncas/analysis-reports/ar20-133l,https://www.us-cert.gov/ncas/analysis-reports/ar20-133n,https://www.us-cert.gov/ncas/analysis-reports/ar20-133o https://www.us-cert.gov/ncas/alerts/aa19-339ahttps://nvd.nist.gov/vuln/detail/CVE-2012-0158 CVE-2019-0604 Vulnerable Products: Microsoft SharePointAssociated Malware: China ChopperMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2019-0604 CVE-2017-0143 Vulnerable Products: Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016Associated Malware: Multiple using the EternalSynergy and EternalBlue Exploit KitMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2017-0143 CVE-2018-4878 Vulnerable Products: Adobe Flash Player before 28.0.0.161Associated Malware: DOGCALLMitigation: Update Adobe Flash Player installation to the latest versionMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2018-4878IOCs:https://www.us-cert.gov/ncas/analysis-reports/ar20-133d CVE-2017-8759 Vulnerable Products: Microsoft .NET Framework 2.0, 3.5, 3.5.1, 4.5.2, 4.6, 4.6.1, 4.6.2 and 4.7Associated Malware: FINSPY, FinFisher, WingBirdMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2017-8759IOCs:https://www.us-cert.gov/ncas/analysis-reports/ar20-133f CVE-2015-1641 Vulnerable Products: Microsoft Word 2007 SP3, Office 2010 SP2, Word 2010 SP2, Word 2013 SP1, Word 2013 RT SP1, Word for Mac 2011, Office Compatibility Pack SP3, Word Automation Services on SharePoint Server 2010 SP2 and 2013 SP1, and Office Web Apps Server 2010 SP2 and 2013 SP1Associated Malware: Toshliph, UWarriorMitigation: Update affected Microsoft products with the latest security patchesMore Detail:https://nvd.nist.gov/vuln/detail/CVE-2015-1641IOCs:https://www.us-cert.gov/ncas/analysis-reports/ar20-133m CVE-2018-7600 Vulnerable Products: Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1Associated Malware: KittyMitigation: Upgrade to the most recent version of Drupal 7 or 8 core.More Detail:https://nvd.nist.gov/vuln/detail/CVE-2018-7600 CVE-2019-11510 Vulnerable Products: Pulse Connect Secure 9.0R1 - 9.0R3.3, 8.3R1 - 8.3R7, 8.2R1 - 8.2R12, 8.1R1 - 8.1R15 and Pulse Policy Secure 9.0R1 - 9.0R3.1, 5.4R1 - 5.4R7, 5.3R1 - 5.3R12, 5.2R1 - 5.2R12, 5.1R1 - 5.1R15Mitigation: Update affected Pulse Secure devices with the latest security patches.More Detail:https://www.us-cert.gov/ncas/alerts/aa20-107ahttps://nvd.nist.gov/vuln/detail/CVE-2019-11510https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/ https://www.us-cert.gov/ncas/alerts/aa20-107ahttps://nvd.nist.gov/vuln/detail/CVE-2019-11510https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/ CVE-2019-19781 Vulnerable Products: Citrix Application Delivery Controller, Citrix Gateway, and Citrix SDWAN WANOPMitigation: Update affected Citrix devices with the latest security patchesMore Detail:https://www.us-cert.gov/ncas/alerts/aa20-020ahttps://www.us-cert.gov/ncas/alerts/aa20-031ahttps://www.fireeye.com/blog/products-and-services/2020/01/fireeye-and-citrix-tool-scans-for-iocs-related-to-vulnerability.htmlhttps://nvd.nist.gov/vuln/detail/CVE-2019-19781https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/ https://www.us-cert.gov/ncas/alerts/aa20-020ahttps://www.us-cert.gov/ncas/alerts/aa20-031ahttps://www.fireeye.com/blog/products-and-services/2020/01/fireeye-and-citrix-tool-scans-for-iocs-related-to-vulnerability.htmlhttps://nvd.nist.gov/vuln/detail/CVE-2019-19781https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/ Oversights in Microsoft O365 Security Configurations Vulnerable Products: Microsoft O365Mitigation: Follow Microsoft O365 security recommendationsMore Detail:https://www.us-cert.gov/ncas/alerts/aa20-120a Organizational Cybersecurity Weaknesses Vulnerable Products: Systems, networks, and dataMitigation: Follow cybersecurity best practicesMore Detail:https://www.cisa.gov/cyber-essentials Adversaries use known vulnerabilities and phishing attacks to compromise the security of organizations. CISA offers several free scanning and testing services to help organizations reduce their exposure to threats by taking a proactive approach to mitigating attack vectors. Cyber Hygiene: Vulnerability Scanninghelps secure your internet-facing systems from weak configuration and known vulnerabilities. It also encourages organizations to adopt modern security best practices. CISA performs regular network and vulnerability scans and delivers a weekly report for your action. Once initiated, this service is mostly automated and requires little direct interaction. After CISA receives the required paperwork for Cyber Hygiene, our scans will start within 72 hours and you’ll begin receiving reports within two weeks. Web Application Servicechecks your publicly accessible web sites for potential bugs and weak configurations. It provides a “snapshot” of your publicly accessible web applications and also checks functionality and performance in your application.If your organization would like these services or want more information about other useful services, please emailvulnerability_info@cisa.dhs.gov. The Patch Factory: CISA infographic depicting the global infrastructure for managing vulnerabilities. CISA Alert: (AA20-120A) Microsoft Office 365 Security Recommendations: recommendations for organizations to review and ensure their O365 environment is configured to protect, detect, and respond against would-be attackers. CISA’s Cyber Essentials: a guide for leaders of small businesses as well as leaders of small and local government agencies to develop an actionable understanding of where to start implementing organizational cybersecurity practices."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-126a,"Mitigations CISA and NCSC have previously published information for organizations on password spraying and improving password policy. Putting this into practice will significantly reduce the chance of compromise from this kind of attack. CISA alert on password spraying attacksCISA guidance on choosing and protecting passwordsCISA guidance on supplementing passwordsNCSC guidance on password spraying attacksNCSC guidance on password administration for system ownersNCSC guidance on password deny lists CISA’sCyber Essentialsfor small organizations provides guiding principles for leaders to develop a culture of security and specific actions for IT professionals to put that culture into action. Additionally, the UK government’sCyber Awarecampaign provides useful advice for individuals on how to stay secure online during the coronavirus pandemic. This includes advice on protecting passwords, accounts, and devices. A number of other mitigations will be of use in defending against the campaigns detailed in this report: Update VPNs, network infrastructure devices, and devices being used to remote into work environments with the latest software patches and configurations.See CISA’sguidance on enterprise VPN securityand NCSCguidance on virtual private networksfor more information.Use multi-factor authentication to reduce the impact of password compromises.See the U.S. National Cybersecurity Awareness Month’show-to guide for multi-factor authentication. Also see NCSC guidance onmulti-factor authentication servicesandsetting up two factor authentication.Protect the management interfaces of your critical operational systems.In particular, use browse-down architecture to prevent attackers easily gaining privileged access to your most vital assets. Seethe NCSC blog on protecting management interfaces.Set up a security monitoring capabilityso you are collecting the data that will be needed to analyze network intrusions. See theNCSC introduction to logging security purposes.Review and refresh your incident management processes.Seethe NCSC guidance on incident management.Use modern systems and software.These have better security built in. If you cannot move off out-of-date platforms and applications straight away, there are short-term steps you can take to improve your position. Seethe NCSC guidance on obsolete platform security.Further information:Invest in preventing malware-based attacks across various scenarios. See CISA’s guidance onransomwareandprotecting against malicious code. Also seethe NCSC guidance on mitigating malware and ransomware attacks."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-120a,"Mitigations The following list contains recommended configurations when deploying O365: Enable multi-factor authentication for administrator accounts:Azure Active Directory (AD) Global Administrators in an O365 environment have the highest level of administrator privileges at the tenant level. This is equivalent to the Domain Administrator in an on-premises AD environment. The Azure AD Global Administrators are the first accounts created so that administrators can begin configuring their tenant and eventually migrate their users. Multi-factor authentication (MFA) is not enabled by default for these accounts. Microsoft has moved towards a “Secure by default” model, but even this must be enabled by the customer. The new feature, called “Security Defaults,”[1]assists with enforcing administrators’ usage of MFA. These accounts are internet accessible because they are hosted in the cloud. If not immediately secured, an attacker can compromise these cloud-based accounts and maintain persistence as a customer migrates users to O365. Assign Administrator roles using Role-based Access Control (RBAC):Given its high level of default privilege, you should only use the Global Administrator account when absolutely necessary. Instead, using Azure AD’s numerous other built-in administrator roles instead of the Global Administrator account can limit assigning of overly permissive privileges to legitimate administrators.[2]Practicing the principle of “Least Privilege” can greatly reduce the impact if an administrator account is compromised.[3]Always assign administrators only the minimum permissions they need to do conduct their tasks. Enable Unified Audit Log (UAL):O365 has a logging capability called the Unified Audit Log that contains events from Exchange Online, SharePoint Online, OneDrive, Azure AD, Microsoft Teams, PowerBI, and other O365 services.[4]An administrator must enable the Unified Audit Log in the Security and Compliance Center before queries can be run. Enabling UAL allows administrators the ability to investigate and search for actions within O365 that could be potentially malicious or not within organizational policy. Enable multi-factor authentication for all users:Though normal users in an O365 environment do not have elevated permissions, they still have access to data that could be harmful to an organization if accessed by an unauthorized entity. Also, threat actors compromise normal user accounts in order to send phishing emails and attack other organizations using the apps and services the compromised user has access to. Disable legacy protocol authentication when appropriate:Azure AD is the authentication method that O365 uses to authenticate with Exchange Online, which provides email services. There are a number of legacy protocols associated with Exchange Online that do not support MFA features. These protocols include Post Office Protocol (POP3), Internet Message Access Protocol (IMAP), and Simple Mail Transport Protocol (SMTP). Legacy protocols are often used with older email clients, which do not support modern authentication. Legacy protocols can be disabled at the tenant level or at the user level. However, should an organization require older email clients as a business necessity, these protocols will presumably not be disabled. This leaves email accounts accessible through the internet with only the username and password as the primary authentication method. One approach to mitigate this issue is to inventory users who still require the use of a legacy email client and legacy email protocols and only grant access to those protocols for those select users. Using Azure AD Conditional Access policies can help limit the number of users who have the ability to use legacy protocol authentication methods. Taking this step will greatly reduce an organization’s attack surface.[5] Enable alerts for suspicious activity:Enabling logging of activity within an Azure/0365 environment can greatly increase the owner’s effectiveness of identifying malicious activity occurring within their environment and enabling alerts will serve to enhance that. Creating and enabling alerts within the Security and Compliance Center to notify administrators of abnormal events will reduce the time needed to effectively identify and mitigate malicious activity.[6]At a minimum, CISA recommends enabling alerts for logins from suspicious locations and for accounts exceeding sent email thresholds. Incorporate Microsoft Secure Score:Microsoft provides a built-in tool to measure an organization’s security posture with respect to its O365 services and offer enhancement recommendations.[7]These recommendations provided by Microsoft Secure Score do NOT encompass all possible security configurations, but organizations should still consider using Microsoft Secure Score because O365 service offerings frequently change. Using Microsoft Secure Score will help provide organizations a centralized dashboard for tracking and prioritizing security and compliance changes within O365. Integrate Logs with your existing SIEM tool:Even with robust logging enabled via the UAL, it is critical to integrate and correlate your O365 logs with your other log management and monitoring solutions. This will ensure that you can detect anomalous activity in your environment and correlate it with any potential anomalous activity in O365.[8]"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-107a,"Mitigations CISA strongly urges organizations that have not yet done so to upgrade their Pulse Secure VPN to the corresponding patches for CVE-2019-11510. If—after applying the detection measures in this alert—organizations detect evidence of CVE-2019-11510 exploitation, CISA recommends changing passwords for all Active Directory accounts, including administrators and services accounts. CISA also recommends organizations to: Look for unauthorized applications and scheduled tasks in their environment.Remove any remote access programs not approved by the organization.Remove any remote access trojans.Carefully inspect scheduled tasks for scripts or executables that may allow an attacker to connect to an environment. If organizations find evidence of malicious, suspicious, or anomalous activity or files, they should consider reimaging the workstation or server and redeploying back into the environment. CISA recommends performing checks to ensure the infection is gone even if the workstation or host has been reimaged."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-099a,"Mitigations Malicious cyber actors are continually adjusting their tactics to take advantage of new situations, and the COVID-19 pandemic is no exception. Malicious cyber actors are using the high appetite for COVID-19-related information as an opportunity to deliver malware and ransomware, and to steal user credentials. Individuals and organizations should remain vigilant. For information regarding the COVID-19 pandemic, use trusted resources, such as the Centers for Disease Control and Prevention (CDC)’sCOVID-19 Situation Summary. Following the CISA and NCSC advice set out below will help mitigate the risk to individuals and organizations from malicious cyber activity related to both COVID-19 and other themes: CISA guidance for defending against COVID-19 cyber scamsCISA Insights: Risk Management for Novel Coronavirus (COVID-19), which provides guidance for executives regarding physical, supply chain, and cybersecurity issues related to COVID-19CISA Alert: Enterprise VPN SecurityCISA webpage providing a repository of the agency’s COVID-19 guidanceNCSC guidance to help spot, understand, and deal with suspicious messages and emailsNCSC phishing guidance for organizations and cyber security professionalsNCSC guidance on mitigating malware and ransomware attacksNCSC guidance on home workingNCSC guidance on end user device security The NCSC’ssuspicious email guidanceexplains what to do if you've already clicked on a potentially malicious email, attachment, or link. It provides advice on who to contact if your account or device has been compromised and some of the mitigation steps you can take, such as changing your passwords. It also offers NCSC's top tips for spotting a phishing email: Authority– Is the sender claiming to be from someone official (e.g., your bank or doctor, a lawyer, a government agency)? Criminals often pretend to be important people or organizations to trick you into doing what they want.Urgency– Are you told you have a limited time to respond (e.g., in 24 hours or immediately)? Criminals often threaten you with fines or other negative consequences.Emotion– Does the message make you panic, fearful, hopeful, or curious? Criminals often use threatening language, make false claims of support, or attempt to tease you into wanting to find out more.Scarcity– Is the message offering something in short supply (e.g., concert tickets, money, or a cure for medical conditions)? Fear of missing out on a good deal or opportunity can make you respond quickly. Organizational defenses against phishing often rely exclusively on users being able to spot phishing emails. However, organizations that widen their defenses to include more technical measures can improve resilience against phishing attacks. In addition to educating users on defending against these attacks, organizations should consider NCSC’s guidance that splits mitigations into four layers, on which to build defenses: Make it difficult for attackers to reach your users.Help users identify and report suspected phishing emails (see CISA Tips,Using Caution with Email AttachmentsandAvoiding Social Engineering and Phishing Scams).Protect your organization from the effects of undetected phishing emails.Respond quickly to incidents. CISA and NCSC also recommend organizations plan for a percentage of phishing attacks to be successful. Planning for these incidents will help minimize the damage caused. Due to COVID-19, an increasing number of individuals and organizations are turning to communications platforms—such as Zoom and Microsoft Teams— for online meetings. In turn, malicious cyber actors are hijacking online meetings that are not secured with passwords or that use unpatched software. Tips for defending against online meeting hijacking(Source:FBI Warns of Teleconferencing and Online Classroom Hijacking During COVID-19 Pandemic, FBI press release, March 30, 2020): Do not make meetings public. Instead, require a meeting password or use the waiting room feature and control the admittance of guests.Do not share a link to a meeting on an unrestricted publicly available social media post. Provide the link directly to specific people.Manage screensharing options. Change screensharing to “Host Only.”Ensure users are using the updated version of remote access/meeting applications.Ensure telework policies address requirements for physical and information security. This report draws on information derived from CISA, NCSC, and industry sources. Any findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times. CISA does not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by CISA."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-073a,"Mitigations CISA encourages organizations to review the following recommendations when considering alternate workplace options. Update VPNs, network infrastructure devices, and devices being used to remote into work environments with the latest software patches and security configurations. See CISA TipsUnderstanding PatchesandSecuring Network Infrastructure Devices.Alert employees to an expected increase in phishing attempts. See CISA TipAvoiding Social Engineering and Phishing Attacks.Ensure IT security personnel are prepared to ramp up the following remote access cybersecurity tasks: log review, attack detection, and incident response and recovery. Per the National Institute of Standards and Technology (NIST) Special Publication 800-46 v.2,Guide to Enterprise Telework, Remote Access, and Bring Your Own Device (BYOD) Security, these tasks should be documented in the configuration management policy.Implement MFA on all VPN connections to increase security. If MFA is not implemented, require teleworkers to use strong passwords. (See CISA TipsChoosing and Protecting PasswordsandSupplementing Passwordsfor more information.)Ensure IT security personnel test VPN limitations to prepare for mass usage and, if possible, implement modifications—such as rate limiting—to prioritize users that will require higher bandwidths.Contact CISAto report incidents, phishing, malware, and other cybersecurity concerns."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-049a,Mitigations Asset owner operators across all sectors are encouraged to consider the following mitigations using a risk-based assessment strategy.
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-031a,"Mitigations The resources provided include steps for standalone, HA pairs, and clustered Citrix instances. Use Citrix's tool to check for the vulnerability.https://support.citrix.com/article/CTX269180Use an open-source utility to check for the vulnerability or previous device compromise.https://github.com/cisagov/check-cve-2019-19781https://github.com/x1sec/citrixmash_scannerhttps://github.com/fireeye/ioc-scanner-CVE-2019-19781/releases/tag/v1.2Follow instructions from Citrix to mitigate the vulnerability.https://support.citrix.com/article/CTX267679https://support.citrix.com/article/CTX267027Upgrade firmware to a patched version.Subscribe to Citrix Alerts for firmware updates.https://support.citrix.com/user/alertsPatch devices to the most current version.https://www.citrix.com/downloads/citrix-gateway/https://www.citrix.com/downloads/citrix-adc/https://www.citrix.com/downloads/citrix-sd-wan/ https://support.citrix.com/article/CTX269180 https://github.com/cisagov/check-cve-2019-19781https://github.com/x1sec/citrixmash_scannerhttps://github.com/fireeye/ioc-scanner-CVE-2019-19781/releases/tag/v1.2 https://support.citrix.com/article/CTX267679https://support.citrix.com/article/CTX267027 Subscribe to Citrix Alerts for firmware updates.https://support.citrix.com/user/alertsPatch devices to the most current version.https://www.citrix.com/downloads/citrix-gateway/https://www.citrix.com/downloads/citrix-adc/https://www.citrix.com/downloads/citrix-sd-wan/ https://support.citrix.com/user/alerts https://www.citrix.com/downloads/citrix-gateway/https://www.citrix.com/downloads/citrix-adc/https://www.citrix.com/downloads/citrix-sd-wan/ Consider deploying a VPN capability using standardized protocols, preferably ones listed on the National Information Assurance Partnership (NIAP) Product Compliant List (PCL), in front of publicly accessible gateway appliances to require user authentication for the VPN before being able to reach these appliances. CISA's TipHandling Destructive Malwareprovides additional information, including best practices and incident response strategies."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-020a,"Mitigations CISA strongly recommends users and administrators update Citrix ADC, Citrix Gateway, and Citrix SD-WAN WANOP as soon as possible. The fixed builds can be downloaded from Citrix Downloads pages forCitrix ADC,Citrix Gateway, andCitrix SD-WAN. Until the appropriate update is implemented, users and administrators should apply Citrix’s interim mitigation steps for CVE-2019-19781.[16]Verify the successful application of the above mitigations by using the tool inCTX269180 – CVE-2019-19781 – Verification ToolTest.Note:these mitigation steps apply to Citrix ADC and SD-WAN WANOP deployments.[17] Refer to table 1 for Citrix’s fix schedule.[18] Table 1. Fix schedule for Citrix appliances vulnerable to CVE-2019-19781  Administrators should review NSA’sCitrix Advisoryfor other mitigations, such as applying the following defense-in-depth strategy: “Consider deploying a VPN capability using standardized protocols, preferably ones listed on the National Information Assurance Partnership (NIAP) Product Compliant List (PCL), in front of publicly accessible Citrix ADC and Citrix Gateway appliances to require user authentication for the VPN before being able to reach these appliances. Use of a proprietary SSLVPN/TLSVPN is discouraged.”"
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-014a,"Mitigations CISA strongly recommends organizations read theMicrosoft January 2020 Release Notes pagefor more information and apply critical patches as soon as possible—prioritize patching by starting with mission critical systems, internet-facing systems, and networked servers. Organizations should then prioritize patching other affected IT/OT assets. General Guidance Review Guide to Enterprise Patch Management Technologies,NIST Special Publication 800-40 Revision 3. Patch management is the process for identifying, acquiring, installing, and verifying patches for products and systems. This publication is designed to assist organizations in understanding the basics of enterprise patch management technologies. It explains the importance of patch management and examines the challenges inherent in performing patch management. It provides an overview of enterprise patch management technologies, and also briefly discusses metrics for measuring the technologies’ effectiveness.ReviewCISA Insights publications. Informed by U.S. cyber intelligence and real-world events, each CISA Insight provides background information on particular cyber threats and the vulnerabilities they exploit, as well as a ready-made set of mitigation activities that non-federal partners can implement. Printable materials can be found by visiting:https://www.cisa.gov/publication/cisa-insights-publications.ReviewCISA’s Cyber Essentials. CISA’s Cyber Essentials is a guide for leaders of small businesses as well as leaders of small and local government agencies to develop an actionable understanding of where to start implementing organizational cybersecurity practices. Essentials are the starting point to cyber readiness. To download the guide, visit:https://www.cisa.gov/publication/cisa-cyber-essentials."
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-010a,Mitigations This vulnerability has no viable workarounds except for applying the patches provided by the vendor and performing required system updates. CISA strongly urges users and administrators to upgrade to the corresponding fixes.[7]
https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-006a,"Mitigations The following is a composite of actionable technical recommendations for IT professionals and providers to reduce their overall vulnerability. These recommendations are not exhaustive; rather they focus on the actions that will likely have the highest return on investment. In general, CISA recommends two courses of action in the face of potential threat from Iranian actors: 1) vulnerability mitigation and 2) incident preparation. Disable all unnecessary ports and protocols.Review network security device logs and determine whether to shut off unnecessary ports and protocols. Monitor common ports and protocols for command and control activity.Enhance monitoring of network and email traffic.Review network signatures and indicators for focused operations activities, monitor for new phishing themes and adjust email rules accordingly, and follow best practices of restricting attachments via email or other mechanisms.Patch externally facing equipment.Focus on patching critical and high vulnerabilities that allow for remote code execution or denial of service on externally facing equipment.Log and limit usage of PowerShell.Limit the usage of PowerShell to only users and accounts that need it, enable code signing of PowerShell scripts, and enable logging of all PowerShell commands.Ensure backups are up to dateand stored in an easily retrievable location that is air-gapped from the organizational network. The following mitigations and detection recommendations regarding publicly known Iranian advanced persistent threat (APT) techniques are based on theMITRE ATT&CK Framework.[5] Mitigation Manage the access control list for ""Replicating Directory Changes"" and other permissions associated with domain controller replication.Consider disabling or restricting NTLM.Ensure that local administrator accounts have complex, unique passwords across all systems on the network.Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts. Manage the access control list for ""Replicating Directory Changes"" and other permissions associated with domain controller replication. Consider disabling or restricting NTLM. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts. Detection Windows: Monitor for unexpected processes interacting with Isass.exe.Linux: The AuditD monitoring tool can be used to watch for hostile processes opening a maps file in the proc file system, alerting on the pid, process name, and arguments for such programs. Mitigation Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted. Detection Windows: Monitor for unexpected processes interacting with Isass.exe.Linux: The AuditD monitoring tool can be used to watch for hostile processes opening a maps file in the proc file system, alerting on the pid, process name, and arguments for such programs. Mitigation Network intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. Detection Process monitoring and monitoring for command-line arguments for known compression utilities.If the communications channel is unencrypted, compressed files can be detected in transit during exfiltration with a network intrusion detection or data loss prevention system analyzing file headers. Mitigation Set PowerShell execution policy to execute only signed scripts.Remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.Restrict PowerShell execution policy to administrators. Detection If PowerShell is not used in an environment, looking for PowerShell execution may detect malicious activity.Monitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System. Management.Automation.dll (especially to unusual process names/locations).Turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). User Execution Mitigation Application allow listing may be able to prevent the running of executables masquerading as other files.If a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.Block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr., .exe, .pif, .cpl, etc.Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Detection Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain Initial Access that require user interaction. This includes compression applications, such as those for zip files that can be used to Deobfuscate/Decode Files or Information in payloads.Anti-virus can potentially detect malicious documents and files that are downloaded and executed on the user's computer.Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as Exploitation for Client Execution and Scripting. Mitigation Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. Other types of virtualization and application microsegmentation may also mitigate the impact of compromise.Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell. Detection Examine scripting user restrictions. Evaluate any attempts to enable scripts running on a system that would be considered suspicious.Scripts should be captured from the file system when possible to determine their actions and intent.Monitor processes and command-line arguments for script execution and subsequent behavior.Analyze Office file attachments for potentially malicious macros.Office processes, such as winword.exe, spawning instances of cmd.exe, script application like wscript.exe or powershell.exe, or other suspicious processes may indicate malicious activity. Mitigation This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of system features. Detection Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc.Monitor the start folder for additions or changes.Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations and startup folders.To increase confidence of malicious activity, data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement. Mitigation Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Detection Monitor for file creation and files transferred within a network over SMB.Monitor use of utilities, such as FTP, that does not normally occur.Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server).Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. Spearphishing Link Mitigation Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. Detection URL inspection within email (including expanding shortened links) can help detect links leading to known malicious sites.Detonation chambers can be used to detect these links and either automatically go to these sites to determine if they're potentially malicious, or wait and capture the content if a user visits the link. Mitigation Anti-virus can automatically quarantine suspicious files.Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity.Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc.Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in Obfuscated Files or Information.Users can be trained to identify social engineering techniques and spearphishing emails. Detection Network intrusion detection systems and email gateways can be used to detect spearphishing with malicious attachments in transit.Detonation chambers may also be used to identify malicious attachments.Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.Anti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer."
