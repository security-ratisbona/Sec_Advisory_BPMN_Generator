{
    "extracted_playbook": [
        {
            "step_number": 1,
            "type": "CONDITION",
            "condition": "Is it possible to update the OPC UA server?",
            "next_step": 2,
            "else_step": 5
        },
        {
            "step_number": 2,
            "type": "SWITCH_CONDITION",
            "condition": "Which operating system is the device running?",
            "cases": {
                "Windows (not CE or TwinCAT/BSD)": 3,
                "Windows CE": 4
            },
            "default": null
        },
        {
            "step_number": 3,
            "type": "ACTION",
            "title": "Update OPC UA Server on Windows",
            "description": "Get a recent version of the OPC UA servers through the conventional ways and update your system.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 4,
            "type": "ACTION",
            "title": "Update OPC UA Server on Windows CE",
            "description": "Request a recent image via Beckhoffâ€™s support and apply it to your device.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 5,
            "type": "PARALLEL",
            "parallel_steps": [
                6,
                7
            ],
            "next_step": null
        },
        {
            "step_number": 6,
            "type": "ACTION",
            "title": "Disable IPC Diagnostics Server",
            "description": "Stop and disable the IPC Diagnostics Server by stopping and disabling the corresponding Windows service.",
            "commands": [
                "Stop-Service -Force -Name DevMgrSvr-UA",
                "Set-Service -Name DevMgrSvr-UA -StartupType Disabled"
            ],
            "next_step": null
        },
        {
            "step_number": 7,
            "type": "SWITCH_CONDITION",
            "condition": "Where to limit access to the TCP port?",
            "cases": {
                "Dedicated firewall appliance": 8,
                "Windows firewall": 9
            },
            "default": null
        },
        {
            "step_number": 8,
            "type": "ACTION",
            "title": "Limit Access via Dedicated Firewall Appliance",
            "description": "Use a dedicated firewall appliance to limit access to the TCP port the OPC UA server is listening on.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 9,
            "type": "ACTION",
            "title": "Limit Access via Windows Firewall",
            "description": "Configure the Windows firewall to limit access to the TCP port the OPC UA server is listening on.",
            "commands": null,
            "next_step": null
        }
    ],
    "start_step_number": 1,
    "cve_id": "IPC Diagnostics UA Server, <= 3.1.0.1 | TwinCAT OPC UA Server, <= 2.3.0.12",
    "affected_products": [
        "IPC Diagnostics UA Server, <= 3.1.0.1",
        "TwinCAT OPC UA Server, <= 2.3.0.12"
    ]
}