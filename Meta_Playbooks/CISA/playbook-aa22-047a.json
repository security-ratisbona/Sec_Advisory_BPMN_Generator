{
    "extracted_playbook": [
        {
            "step_number": 1,
            "type": "CONDITION",
            "condition": "Is credential hardening needed?",
            "next_step": 2,
            "else_step": 10
        },
        {
            "step_number": 2,
            "type": "PARALLEL",
            "parallel_steps": [
                3,
                4,
                5,
                6,
                7,
                8,
                9
            ],
            "next_step": 10
        },
        {
            "step_number": 3,
            "type": "ACTION",
            "title": "Enable Multifactor Authentication (MFA)",
            "description": "Enable MFA for all users without exception to enhance security.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 4,
            "type": "ACTION",
            "title": "Reduce Lifetime of Authentication Assertions",
            "description": "Reduce the lifetime of authentication assertions to enforce MFA re-validation.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 5,
            "type": "ACTION",
            "title": "Implement Group Managed Service Accounts (gMSA)",
            "description": "Use gMSA for service accounts to automate complex password management.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 6,
            "type": "ACTION",
            "title": "Enforce Strong, Unique Passwords",
            "description": "Require accounts to have strong, unique passwords and avoid reuse across multiple accounts.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 7,
            "type": "ACTION",
            "title": "Enable Password Management Functions",
            "description": "Enable functions like Local Administrator Password Solution (LAPS) for local administrative accounts.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 8,
            "type": "ACTION",
            "title": "Implement Time-out and Lock-out Features",
            "description": "Configure time-out and lock-out features for repeated failed login attempts.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 9,
            "type": "ACTION",
            "title": "Configure Time-based Access for Admin Accounts",
            "description": "Use Just-In-Time (JIT) access method for privileged accounts to enforce least privilege.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 10,
            "type": "CONDITION",
            "condition": "Is centralized log management needed?",
            "next_step": 11,
            "else_step": 20
        },
        {
            "step_number": 11,
            "type": "PARALLEL",
            "parallel_steps": [
                12,
                13,
                14,
                15,
                16,
                17,
                18
            ],
            "next_step": 20
        },
        {
            "step_number": 12,
            "type": "ACTION",
            "title": "Create Centralized Log Management System",
            "description": "Establish a centralized log management system to monitor network activity.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 13,
            "type": "ACTION",
            "title": "Forward Logs to SIEM Tool",
            "description": "Forward all logs to a SIEM tool and ensure they are searchable.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 14,
            "type": "ACTION",
            "title": "Retain Network Activity Logs",
            "description": "Retain critical and historic network activity logs for a minimum of 180 days.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 15,
            "type": "ACTION",
            "title": "Enable Unified Audit Log (UAL) in M365",
            "description": "Enable UAL in M365 to log events from various services.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 16,
            "type": "ACTION",
            "title": "Ensure PowerShell Logging is Enabled",
            "description": "Turn on PowerShell logging and update to version 5.0 or later.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 17,
            "type": "ACTION",
            "title": "Monitor Remote Access/RDP Logs",
            "description": "Monitor remote access/RDP logs and disable unused ports.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 18,
            "type": "ACTION",
            "title": "Correlate Logs from Network and Host Security Devices",
            "description": "Correlate logs from network and host security devices to detect anomalies.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 20,
            "type": "CONDITION",
            "condition": "Is a software and patch management program needed?",
            "next_step": 21,
            "else_step": 28
        },
        {
            "step_number": 21,
            "type": "PARALLEL",
            "parallel_steps": [
                22,
                23,
                24,
                25,
                26,
                27
            ],
            "next_step": 28
        },
        {
            "step_number": 22,
            "type": "ACTION",
            "title": "Implement Centralized Patch Management System",
            "description": "Consider using a centralized patch management system for timely software updates.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 23,
            "type": "ACTION",
            "title": "Prioritize Patches for Known Exploited CVEs",
            "description": "Prioritize patches for CVEs known to be exploited or accessible to many adversaries.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 24,
            "type": "ACTION",
            "title": "Subscribe to CISA Cybersecurity Notifications",
            "description": "Subscribe to CISA notifications to stay informed about vulnerabilities and threats.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 25,
            "type": "ACTION",
            "title": "Sign Up for CISA Cyber Hygiene Services",
            "description": "Use CISA's vulnerability scanning service to reduce exposure to threats.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 26,
            "type": "ACTION",
            "title": "Regularly Update VPNs and Network Devices",
            "description": "Update VPNs and network devices with the latest patches and configurations.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 27,
            "type": "ACTION",
            "title": "Monitor Network Traffic for Unapproved Protocols",
            "description": "Monitor network traffic for unapproved and unexpected protocols.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 28,
            "type": "CONDITION",
            "condition": "Is antivirus program implementation needed?",
            "next_step": 29,
            "else_step": 32
        },
        {
            "step_number": 29,
            "type": "PARALLEL",
            "parallel_steps": [
                30,
                31
            ],
            "next_step": 32
        },
        {
            "step_number": 30,
            "type": "ACTION",
            "title": "Install Antivirus Applications",
            "description": "Ensure antivirus applications are installed on all computers and configured to prevent malware.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 31,
            "type": "ACTION",
            "title": "Keep Virus Definitions Up to Date",
            "description": "Regularly update virus definitions and monitor antivirus scans.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 32,
            "type": "CONDITION",
            "condition": "Is endpoint detection and response needed?",
            "next_step": 33,
            "else_step": 35
        },
        {
            "step_number": 33,
            "type": "ACTION",
            "title": "Utilize Endpoint Detection and Response (EDR) Tools",
            "description": "Use EDR tools for visibility into endpoint security and to detect lateral movement.",
            "commands": null,
            "next_step": 34
        },
        {
            "step_number": 34,
            "type": "ACTION",
            "title": "Audit Configuration Management Programs",
            "description": "Audit configuration management programs to track and mitigate emerging threats.",
            "commands": null,
            "next_step": 35
        },
        {
            "step_number": 35,
            "type": "CONDITION",
            "condition": "Is enforcing the principle of least privilege needed?",
            "next_step": 36,
            "else_step": 42
        },
        {
            "step_number": 36,
            "type": "PARALLEL",
            "parallel_steps": [
                37,
                38,
                39,
                40,
                41
            ],
            "next_step": 42
        },
        {
            "step_number": 37,
            "type": "ACTION",
            "title": "Apply Principle of Least Privilege",
            "description": "Ensure administrator accounts have minimum permissions needed for tasks.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 38,
            "type": "ACTION",
            "title": "Assign Administrator Roles to RBAC in M365",
            "description": "Use RBAC to implement least privilege in M365 and limit Global Administrator use.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 39,
            "type": "ACTION",
            "title": "Remove Unnecessary Privileges",
            "description": "Remove privileges not required by an account’s function or role.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 40,
            "type": "ACTION",
            "title": "Create Non-Privileged Accounts for Privileged Users",
            "description": "Ensure privileged users have non-privileged accounts for non-privileged access.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 41,
            "type": "ACTION",
            "title": "Regularly Audit Administrative User Accounts",
            "description": "Audit administrative user accounts and logs to ensure legitimacy and detect anomalies.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 42,
            "type": "CONDITION",
            "condition": "Is reviewing trust relationships needed?",
            "next_step": 43,
            "else_step": 46
        },
        {
            "step_number": 43,
            "type": "ACTION",
            "title": "Review Trust Relationships with IT Service Providers",
            "description": "Review and remove unnecessary trust relationships with MSPs and CSPs.",
            "commands": null,
            "next_step": 44
        },
        {
            "step_number": 44,
            "type": "ACTION",
            "title": "Review Contractual Relationships with Service Providers",
            "description": "Ensure contracts include appropriate security controls and monitoring requirements.",
            "commands": null,
            "next_step": 45
        },
        {
            "step_number": 45,
            "type": "ACTION",
            "title": "Monitor Service Provider Activities",
            "description": "Monitor service provider activities and connections to the customer network.",
            "commands": null,
            "next_step": 46
        },
        {
            "step_number": 46,
            "type": "CONDITION",
            "condition": "Are remote work environment best practices needed?",
            "next_step": 47,
            "else_step": 51
        },
        {
            "step_number": 47,
            "type": "PARALLEL",
            "parallel_steps": [
                48,
                49,
                50
            ],
            "next_step": 51
        },
        {
            "step_number": 48,
            "type": "ACTION",
            "title": "Update Remote Work Environment Devices",
            "description": "Regularly update VPNs and devices used for remote work with the latest patches.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 49,
            "type": "ACTION",
            "title": "Require MFA on VPN Connections",
            "description": "Require MFA on all VPN connections to enhance security.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 50,
            "type": "ACTION",
            "title": "Monitor Remote Network Traffic",
            "description": "Monitor remote network traffic for unapproved protocols and reduce attack surfaces.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 51,
            "type": "CONDITION",
            "condition": "Is user awareness training needed?",
            "next_step": 52,
            "else_step": 55
        },
        {
            "step_number": 52,
            "type": "ACTION",
            "title": "Provide End User Awareness and Training",
            "description": "Train employees on cyber threats, social engineering, and information security principles.",
            "commands": null,
            "next_step": 53
        },
        {
            "step_number": 53,
            "type": "ACTION",
            "title": "Inform Employees of Social Engineering Risks",
            "description": "Educate employees about the risks of social engineering and how to respond to suspicious activity.",
            "commands": null,
            "next_step": 54
        },
        {
            "step_number": 54,
            "type": "ACTION",
            "title": "Establish Reporting Protocols for Suspicious Activity",
            "description": "Ensure employees know whom to contact when they suspect a cyber intrusion.",
            "commands": null,
            "next_step": 55
        },
        {
            "step_number": 55,
            "type": "CONDITION",
            "condition": "Are additional best practice mitigations needed?",
            "next_step": 56,
            "else_step": null
        },
        {
            "step_number": 56,
            "type": "PARALLEL",
            "parallel_steps": [
                57,
                58,
                59,
                60,
                61
            ],
            "next_step": null
        },
        {
            "step_number": 57,
            "type": "ACTION",
            "title": "Deny Atypical Inbound Activity from Anonymization Services",
            "description": "Block inbound activity from known anonymization services like VPNs and TOR.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 58,
            "type": "ACTION",
            "title": "Impose Application Whitelisting Policies",
            "description": "Allow only known and permitted programs to execute under an established security policy.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 59,
            "type": "ACTION",
            "title": "Create Offline Backups for Critical Assets",
            "description": "Identify and create offline backups for critical assets to ensure data recovery.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 60,
            "type": "ACTION",
            "title": "Implement Network Segmentation",
            "description": "Segment the network to limit the spread of potential threats.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 61,
            "type": "ACTION",
            "title": "Review Microsoft Office 365 Security Recommendations",
            "description": "Review CISA Alert AA20-120A for additional recommendations on hardening M365 environments.",
            "commands": null,
            "next_step": null
        }
    ],
    "start_step_number": 1,
    "cve_id": "Mitigations for CDCs",
    "affected_products": null
}