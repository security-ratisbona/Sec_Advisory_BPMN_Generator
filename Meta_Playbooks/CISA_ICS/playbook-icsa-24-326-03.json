{
    "extracted_playbook": [
        {
            "step_number": 1,
            "type": "SWITCH_CONDITION",
            "condition": "Which product is in use?",
            "cases": {
                "Modicon M340": 2,
                "Modicon MC80": 3,
                "Modicon Momentum": 4
            },
            "default": null
        },
        {
            "step_number": 2,
            "type": "PARALLEL",
            "parallel_steps": [
                5,
                6,
                7,
                8
            ],
            "next_step": null
        },
        {
            "step_number": 3,
            "type": "PARALLEL",
            "parallel_steps": [
                9,
                10,
                11,
                12
            ],
            "next_step": null
        },
        {
            "step_number": 4,
            "type": "PARALLEL",
            "parallel_steps": [
                13,
                14,
                15,
                16
            ],
            "next_step": null
        },
        {
            "step_number": 5,
            "type": "ACTION",
            "title": "Setup Network Segmentation for Modicon M340",
            "description": "Implement network segmentation and a firewall to block unauthorized access to port 502/TCP for Modicon M340.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 6,
            "type": "ACTION",
            "title": "Configure Access Control List for Modicon M340",
            "description": "Follow the recommendations in the 'Modicon M340 for Ethernet Communications Modules and Processors User Manual' in the chapter 'Messaging Configuration Parameters'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 7,
            "type": "ACTION",
            "title": "Use External Firewall Devices for Modicon M340",
            "description": "Consider using external firewall devices such as EAGLE40-07 from Belden to establish VPN connections. Refer to 'Modicon Controller Systems Cybersecurity, User Guide'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 8,
            "type": "ACTION",
            "title": "Activate Memory Protection for Modicon M340",
            "description": "Ensure the M340 CPU is running with memory protection activated by configuring the input bit to a physical input. Refer to 'Modicon Controller Systems Cybersecurity, User Guide' chapter 'Controller Memory Protection'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 9,
            "type": "ACTION",
            "title": "Setup Network Segmentation for Modicon MC80",
            "description": "Implement network segmentation and a firewall to block unauthorized access to port 502/TCP for Modicon MC80.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 10,
            "type": "ACTION",
            "title": "Configure Access Control List for Modicon MC80",
            "description": "Follow the recommendations in the 'MC80 Programmable Logic Controller(PLC), User Manual' in the section 'Access Control List (ACL)'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 11,
            "type": "ACTION",
            "title": "Use External Firewall Devices for Modicon MC80",
            "description": "Consider using external firewall devices such as EAGLE40-07 from Belden to establish VPN connections. Refer to 'Modicon Controller Systems Cybersecurity, User Guide'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 12,
            "type": "ACTION",
            "title": "General Security Recommendations for Modicon MC80",
            "description": "Follow general security recommendations such as placing controllers in locked cabinets and minimizing network exposure.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 13,
            "type": "ACTION",
            "title": "Setup Network Segmentation for Modicon Momentum",
            "description": "Implement network segmentation and a firewall to block unauthorized access to port 502/TCP for Modicon Momentum.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 14,
            "type": "ACTION",
            "title": "Configure Access Control List for Modicon Momentum",
            "description": "Follow the recommendations in the 'Momentum for EcoStruxureâ„¢ Control Expert -171CBU78090, 171CBU98090, 171CBU98091 Processors, User Guide' in the section 'Controlling Access'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 15,
            "type": "ACTION",
            "title": "Use External Firewall Devices for Modicon Momentum",
            "description": "Consider using external firewall devices such as EAGLE40-07 from Belden to establish VPN connections. Refer to 'Modicon Controller Systems Cybersecurity, User Guide'.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 16,
            "type": "ACTION",
            "title": "General Security Recommendations for Modicon Momentum",
            "description": "Follow general security recommendations such as placing controllers in locked cabinets and minimizing network exposure.",
            "commands": null,
            "next_step": null
        }
    ],
    "start_step_number": 1,
    "cve_id": "CVE-2024-8933 and CVE-2024-8935",
    "affected_products": [
        "Modicon M340",
        "Modicon MC80",
        "Modicon Momentum"
    ]
}