{
    "extracted_playbook": [
        {
            "step_number": 1,
            "type": "SWITCH_CONDITION",
            "condition": "Which COMOS version is in use?",
            "cases": {
                "COMOS V10.3": 2,
                "COMOS V10.4.3": 3,
                "COMOS V10.4.4": 4,
                "COMOS V10.4.4.1": 5
            },
            "default": null
        },
        {
            "step_number": 2,
            "type": "ACTION",
            "title": "Update COMOS V10.3",
            "description": "Update COMOS V10.3 to V10.3.3.5.8 or later version. The patch is available upon request from customer support.",
            "commands": null,
            "next_step": 6
        },
        {
            "step_number": 3,
            "type": "ACTION",
            "title": "Update COMOS V10.4.3",
            "description": "Update COMOS V10.4.3 to V10.4.3.0.47 or later version. The patch is available upon request from customer support.",
            "commands": null,
            "next_step": 6
        },
        {
            "step_number": 4,
            "type": "ACTION",
            "title": "Update COMOS V10.4.4",
            "description": "Update COMOS V10.4.4 to V10.4.4.2 or later version.",
            "commands": null,
            "next_step": 6
        },
        {
            "step_number": 5,
            "type": "ACTION",
            "title": "Update COMOS V10.4.4.1",
            "description": "Update COMOS V10.4.4.1 to V10.4.4.1.21 or later version.",
            "commands": null,
            "next_step": 6
        },
        {
            "step_number": 6,
            "type": "PARALLEL",
            "parallel_steps": [
                7,
                8,
                9
            ],
            "next_step": 10
        },
        {
            "step_number": 7,
            "type": "ACTION",
            "title": "Restrict Access to Configuration Files for CVE-2024-49704",
            "description": "Ensure that only authorized users can modify configuration and mapping files by implementing appropriate security settings. Do not use untrusted files.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 8,
            "type": "ACTION",
            "title": "Restrict Write-Access for CVE-2024-54005",
            "description": "Ensure that only administrators have write-access to the configuration files, especially the network configuration.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 9,
            "type": "ACTION",
            "title": "Protect Network Access",
            "description": "Protect network access to devices with appropriate mechanisms and configure the environment according to Siemens' operational guidelines for industrial security.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 10,
            "type": "PARALLEL",
            "parallel_steps": [
                11,
                12,
                13
            ],
            "next_step": 14
        },
        {
            "step_number": 11,
            "type": "ACTION",
            "title": "Minimize Network Exposure",
            "description": "Minimize network exposure for all control system devices and/or systems, ensuring they are not accessible from the internet.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 12,
            "type": "ACTION",
            "title": "Isolate Control System Networks",
            "description": "Locate control system networks and remote devices behind firewalls and isolate them from business networks.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 13,
            "type": "ACTION",
            "title": "Secure Remote Access",
            "description": "When remote access is required, use secure methods such as Virtual Private Networks (VPNs). Ensure VPNs are updated to the most recent version available.",
            "commands": null,
            "next_step": null
        },
        {
            "step_number": 14,
            "type": "ACTION",
            "title": "Perform Risk Assessment",
            "description": "Perform proper impact analysis and risk assessment prior to deploying defensive measures.",
            "commands": null,
            "next_step": 15
        },
        {
            "step_number": 15,
            "type": "ACTION",
            "title": "Report Malicious Activity",
            "description": "Follow established internal procedures and report suspected malicious activity to CISA for tracking and correlation against other incidents.",
            "commands": null,
            "next_step": 16
        },
        {
            "step_number": 16,
            "type": "ACTION",
            "title": "Protect Against Social Engineering",
            "description": "Do not click web links or open attachments in unsolicited email messages. Refer to resources on avoiding email scams and social engineering attacks.",
            "commands": null,
            "next_step": null
        }
    ],
    "start_step_number": 1,
    "cve_id": "CVE-2024-49704, CVE-2024-54005",
    "affected_products": [
        "COMOS V10.3",
        "COMOS V10.4.0",
        "COMOS V10.4.1",
        "COMOS V10.4.2",
        "COMOS V10.4.3",
        "COMOS V10.4.4",
        "COMOS V10.4.4.1"
    ]
}